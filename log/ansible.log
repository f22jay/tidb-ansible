
2018-02-27 14:39:16,474 p=166505 u=qupeng |   [WARNING]:  * Failed to parse /home/qupeng/ansible/tidb-ansible/inventory.ini with ini plugin: /home/qupeng/ansible/tidb-ansible/inventory.ini:23: Expected key=value host
variable assignment, got: pingcap

2018-02-27 14:39:16,474 p=166505 u=qupeng |   [WARNING]: Unable to parse /home/qupeng/ansible/tidb-ansible/inventory.ini as an inventory source

2018-02-27 14:39:16,474 p=166505 u=qupeng |   [WARNING]: No inventory was parsed, only implicit localhost is available

2018-02-27 14:39:16,475 p=166505 u=qupeng |   [WARNING]: Could not match supplied host pattern, ignoring: all

2018-02-27 14:39:16,476 p=166505 u=qupeng |   [WARNING]: provided hosts list is empty, only localhost is available

2018-02-27 14:39:16,720 p=166505 u=qupeng |  PLAY [do local preparation] ************************************************************************************************************************************************
2018-02-27 14:39:16,735 p=166505 u=qupeng |  TASK [local : create downloads and resources directories] ******************************************************************************************************************
2018-02-27 14:39:17,068 p=166505 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/downloads)
2018-02-27 14:39:17,189 p=166505 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources)
2018-02-27 14:39:17,315 p=166505 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources/bin)
2018-02-27 14:39:17,324 p=166505 u=qupeng |  TASK [local : create packages.yml] *****************************************************************************************************************************************
2018-02-27 14:39:17,348 p=166505 u=qupeng |  fatal: [localhost]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}
2018-02-27 14:39:17,349 fail [localhost]: Ansible FAILED! => playbook: local_prepare.yml; TASK: local : create packages.yml; message: {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}
2018-02-27 14:39:17,351 p=166505 u=qupeng |  	to retry, use: --limit @/home/qupeng/ansible/tidb-ansible/retry_files/local_prepare.retry

2018-02-27 14:39:17,351 p=166505 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 14:39:17,352 p=166505 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=1   
2018-02-27 14:39:17,352 p=166505 u=qupeng |  ERROR MESSAGE SUMMARY ******************************************************************************************************************************************************
2018-02-27 14:39:17,352 p=166505 u=qupeng |  [localhost]: Ansible FAILED! => playbook: local_prepare.yml; TASK: local : create packages.yml; message: {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}

2018-02-27 14:39:17,352 p=166505 u=qupeng |  Ask for help:
2018-02-27 14:39:17,353 p=166505 u=qupeng |  Contact us: sre@pingcap.com
2018-02-27 14:39:17,353 p=166505 u=qupeng |  It seems that you encounter some problems. You can send an email to the above email address, attached with the tidb-ansible/inventory.ini and tidb-ansible/log/ansible.log files and the error message, or new issue on https://github.com/pingcap/tidb-ansible/issues. We'll try our best to help you deploy a TiDB cluster. Thanks. :-)
2018-02-27 14:39:51,353 p=166590 u=qupeng |   [WARNING]:  * Failed to parse /home/qupeng/ansible/tidb-ansible/inventory.ini with ini plugin: /home/qupeng/ansible/tidb-ansible/inventory.ini:23: Expected key=value host
variable assignment, got: pingcap

2018-02-27 14:39:51,353 p=166590 u=qupeng |   [WARNING]: Unable to parse /home/qupeng/ansible/tidb-ansible/inventory.ini as an inventory source

2018-02-27 14:39:51,353 p=166590 u=qupeng |   [WARNING]: No inventory was parsed, only implicit localhost is available

2018-02-27 14:39:51,354 p=166590 u=qupeng |   [WARNING]: Could not match supplied host pattern, ignoring: all

2018-02-27 14:39:51,355 p=166590 u=qupeng |   [WARNING]: provided hosts list is empty, only localhost is available

2018-02-27 14:39:51,618 p=166590 u=qupeng |  PLAY [do local preparation] ************************************************************************************************************************************************
2018-02-27 14:39:51,638 p=166590 u=qupeng |  TASK [local : create downloads and resources directories] ******************************************************************************************************************
2018-02-27 14:39:51,939 p=166590 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/downloads)
2018-02-27 14:39:52,127 p=166590 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources)
2018-02-27 14:39:52,313 p=166590 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources/bin)
2018-02-27 14:39:52,322 p=166590 u=qupeng |  TASK [local : create packages.yml] *****************************************************************************************************************************************
2018-02-27 14:39:52,354 p=166590 u=qupeng |  fatal: [localhost]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}
2018-02-27 14:39:52,354 fail [localhost]: Ansible FAILED! => playbook: local_prepare.yml; TASK: local : create packages.yml; message: {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}
2018-02-27 14:39:52,356 p=166590 u=qupeng |  	to retry, use: --limit @/home/qupeng/ansible/tidb-ansible/retry_files/local_prepare.retry

2018-02-27 14:39:52,356 p=166590 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 14:39:52,357 p=166590 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=1   
2018-02-27 14:39:52,357 p=166590 u=qupeng |  ERROR MESSAGE SUMMARY ******************************************************************************************************************************************************
2018-02-27 14:39:52,357 p=166590 u=qupeng |  [localhost]: Ansible FAILED! => playbook: local_prepare.yml; TASK: local : create packages.yml; message: {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}

2018-02-27 14:39:52,357 p=166590 u=qupeng |  Ask for help:
2018-02-27 14:39:52,358 p=166590 u=qupeng |  Contact us: sre@pingcap.com
2018-02-27 14:39:52,358 p=166590 u=qupeng |  It seems that you encounter some problems. You can send an email to the above email address, attached with the tidb-ansible/inventory.ini and tidb-ansible/log/ansible.log files and the error message, or new issue on https://github.com/pingcap/tidb-ansible/issues. We'll try our best to help you deploy a TiDB cluster. Thanks. :-)
2018-02-27 14:40:03,598 p=166680 u=qupeng |   [WARNING]:  * Failed to parse /home/qupeng/ansible/tidb-ansible/inventory.ini with ini plugin: /home/qupeng/ansible/tidb-ansible/inventory.ini:23: Expected key=value host
variable assignment, got: pingcap

2018-02-27 14:40:03,599 p=166680 u=qupeng |   [WARNING]: Unable to parse /home/qupeng/ansible/tidb-ansible/inventory.ini as an inventory source

2018-02-27 14:40:03,599 p=166680 u=qupeng |   [WARNING]: No inventory was parsed, only implicit localhost is available

2018-02-27 14:40:03,600 p=166680 u=qupeng |   [WARNING]: Could not match supplied host pattern, ignoring: all

2018-02-27 14:40:03,600 p=166680 u=qupeng |   [WARNING]: provided hosts list is empty, only localhost is available

2018-02-27 14:40:03,863 p=166680 u=qupeng |  PLAY [do local preparation] ************************************************************************************************************************************************
2018-02-27 14:40:03,882 p=166680 u=qupeng |  TASK [local : create downloads and resources directories] ******************************************************************************************************************
2018-02-27 14:40:04,249 p=166680 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/downloads)
2018-02-27 14:40:04,439 p=166680 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources)
2018-02-27 14:40:04,628 p=166680 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources/bin)
2018-02-27 14:40:04,637 p=166680 u=qupeng |  TASK [local : create packages.yml] *****************************************************************************************************************************************
2018-02-27 14:40:04,672 p=166680 u=qupeng |  fatal: [localhost]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}
2018-02-27 14:40:04,672 fail [localhost]: Ansible FAILED! => playbook: local_prepare.yml; TASK: local : create packages.yml; message: {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}
2018-02-27 14:40:04,674 p=166680 u=qupeng |  	to retry, use: --limit @/home/qupeng/ansible/tidb-ansible/retry_files/local_prepare.retry

2018-02-27 14:40:04,674 p=166680 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 14:40:04,675 p=166680 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=1   
2018-02-27 14:40:04,675 p=166680 u=qupeng |  ERROR MESSAGE SUMMARY ******************************************************************************************************************************************************
2018-02-27 14:40:04,675 p=166680 u=qupeng |  [localhost]: Ansible FAILED! => playbook: local_prepare.yml; TASK: local : create packages.yml; message: {"changed": false, "msg": "AnsibleUndefinedVariable: 'tidb_version' is undefined"}

2018-02-27 14:40:04,675 p=166680 u=qupeng |  Ask for help:
2018-02-27 14:40:04,675 p=166680 u=qupeng |  Contact us: sre@pingcap.com
2018-02-27 14:40:04,676 p=166680 u=qupeng |  It seems that you encounter some problems. You can send an email to the above email address, attached with the tidb-ansible/inventory.ini and tidb-ansible/log/ansible.log files and the error message, or new issue on https://github.com/pingcap/tidb-ansible/issues. We'll try our best to help you deploy a TiDB cluster. Thanks. :-)
2018-02-27 14:40:31,721 p=166783 u=qupeng |  PLAY [do local preparation] ************************************************************************************************************************************************
2018-02-27 14:40:31,740 p=166783 u=qupeng |  TASK [local : create downloads and resources directories] ******************************************************************************************************************
2018-02-27 14:40:32,065 p=166783 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/downloads)
2018-02-27 14:40:32,257 p=166783 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources)
2018-02-27 14:40:32,419 p=166783 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources/bin)
2018-02-27 14:40:32,428 p=166783 u=qupeng |  TASK [local : create packages.yml] *****************************************************************************************************************************************
2018-02-27 14:40:33,078 p=166783 u=qupeng |  changed: [localhost]
2018-02-27 14:40:33,085 p=166783 u=qupeng |  TASK [local : create specific deployment method packages.yml] **************************************************************************************************************
2018-02-27 14:40:33,415 p=166783 u=qupeng |  changed: [localhost]
2018-02-27 14:40:33,422 p=166783 u=qupeng |  TASK [local : include_vars] ************************************************************************************************************************************************
2018-02-27 14:40:33,456 p=166783 u=qupeng |  ok: [localhost]
2018-02-27 14:40:33,464 p=166783 u=qupeng |  TASK [local : include_vars] ************************************************************************************************************************************************
2018-02-27 14:40:33,504 p=166783 u=qupeng |  ok: [localhost]
2018-02-27 14:40:33,515 p=166783 u=qupeng |  TASK [local : detect outbound network] *************************************************************************************************************************************
2018-02-27 14:40:33,905 p=166783 u=qupeng |  ok: [localhost]
2018-02-27 14:40:33,913 p=166783 u=qupeng |  TASK [local : set outbound network fact] ***********************************************************************************************************************************
2018-02-27 14:40:33,946 p=166783 u=qupeng |  ok: [localhost]
2018-02-27 14:40:33,953 p=166783 u=qupeng |  TASK [local : fail] ********************************************************************************************************************************************************
2018-02-27 14:40:33,977 p=166783 u=qupeng |  TASK [local : detect GFW] **************************************************************************************************************************************************
2018-02-27 14:40:44,201 p=166783 u=qupeng |  ok: [localhost]
2018-02-27 14:40:44,208 p=166783 u=qupeng |  TASK [local : set GFW fact] ************************************************************************************************************************************************
2018-02-27 14:40:44,234 p=166783 u=qupeng |  ok: [localhost]
2018-02-27 14:40:44,241 p=166783 u=qupeng |  TASK [local : download tidb binary] ****************************************************************************************************************************************
2018-02-27 14:41:35,596 p=166783 u=qupeng |   [ERROR]: User interrupted execution

2018-02-27 14:44:27,813 p=185212 u=qupeng |  PLAY [do local preparation] ************************************************************************************************************************************************
2018-02-27 14:44:27,828 p=185212 u=qupeng |  TASK [local : create downloads and resources directories] ******************************************************************************************************************
2018-02-27 14:44:28,172 p=185212 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/downloads)
2018-02-27 14:44:28,302 p=185212 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources)
2018-02-27 14:44:28,492 p=185212 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources/bin)
2018-02-27 14:44:28,498 p=185212 u=qupeng |  TASK [local : create packages.yml] *****************************************************************************************************************************************
2018-02-27 14:44:29,000 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:29,003 p=185212 u=qupeng |  TASK [local : create specific deployment method packages.yml] **************************************************************************************************************
2018-02-27 14:44:29,329 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:29,333 p=185212 u=qupeng |  TASK [local : include_vars] ************************************************************************************************************************************************
2018-02-27 14:44:29,367 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:29,370 p=185212 u=qupeng |  TASK [local : include_vars] ************************************************************************************************************************************************
2018-02-27 14:44:29,400 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:29,407 p=185212 u=qupeng |  TASK [local : detect outbound network] *************************************************************************************************************************************
2018-02-27 14:44:29,775 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:29,779 p=185212 u=qupeng |  TASK [local : set outbound network fact] ***********************************************************************************************************************************
2018-02-27 14:44:29,812 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:29,815 p=185212 u=qupeng |  TASK [local : fail] ********************************************************************************************************************************************************
2018-02-27 14:44:29,836 p=185212 u=qupeng |  TASK [local : detect GFW] **************************************************************************************************************************************************
2018-02-27 14:44:40,041 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:40,050 p=185212 u=qupeng |  TASK [local : set GFW fact] ************************************************************************************************************************************************
2018-02-27 14:44:40,088 p=185212 u=qupeng |  ok: [localhost]
2018-02-27 14:44:40,095 p=185212 u=qupeng |  TASK [local : download tidb binary] ****************************************************************************************************************************************
2018-02-27 14:45:57,772 p=185212 u=qupeng |   [ERROR]: User interrupted execution

2018-02-27 14:46:59,885 p=185617 u=qupeng |  PLAY [do local preparation] ************************************************************************************************************************************************
2018-02-27 14:46:59,901 p=185617 u=qupeng |  TASK [local : create downloads and resources directories] ******************************************************************************************************************
2018-02-27 14:47:00,244 p=185617 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/downloads)
2018-02-27 14:47:00,434 p=185617 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources)
2018-02-27 14:47:00,624 p=185617 u=qupeng |  ok: [localhost] => (item=/home/qupeng/ansible/tidb-ansible/resources/bin)
2018-02-27 14:47:00,633 p=185617 u=qupeng |  TASK [local : create packages.yml] *****************************************************************************************************************************************
2018-02-27 14:47:01,099 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:01,106 p=185617 u=qupeng |  TASK [local : create specific deployment method packages.yml] **************************************************************************************************************
2018-02-27 14:47:01,452 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:01,459 p=185617 u=qupeng |  TASK [local : include_vars] ************************************************************************************************************************************************
2018-02-27 14:47:01,493 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:01,500 p=185617 u=qupeng |  TASK [local : include_vars] ************************************************************************************************************************************************
2018-02-27 14:47:01,539 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:01,550 p=185617 u=qupeng |  TASK [local : detect outbound network] *************************************************************************************************************************************
2018-02-27 14:47:01,922 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:01,929 p=185617 u=qupeng |  TASK [local : set outbound network fact] ***********************************************************************************************************************************
2018-02-27 14:47:01,963 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:01,970 p=185617 u=qupeng |  TASK [local : fail] ********************************************************************************************************************************************************
2018-02-27 14:47:01,998 p=185617 u=qupeng |  TASK [local : detect GFW] **************************************************************************************************************************************************
2018-02-27 14:47:12,208 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:12,215 p=185617 u=qupeng |  TASK [local : set GFW fact] ************************************************************************************************************************************************
2018-02-27 14:47:12,247 p=185617 u=qupeng |  ok: [localhost]
2018-02-27 14:47:12,254 p=185617 u=qupeng |  TASK [local : download common binary] **************************************************************************************************************************************
2018-02-27 14:47:14,013 p=185617 u=qupeng |  ok: [localhost] => (item={u'url': u'https://download.pingcap.org/fio-2.16.tar.gz', u'version': 2.16, u'name': u'fio'})
2018-02-27 14:47:14,749 p=185617 u=qupeng |  ok: [localhost] => (item={u'url': u'http://download.pingcap.org/daemontools-0.53.tar.gz', u'version': 0.53, u'name': u'daemontools'})
2018-02-27 14:47:14,761 p=185617 u=qupeng |  TASK [local : include] *****************************************************************************************************************************************************
2018-02-27 14:47:14,802 p=185617 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/local/tasks/binary_deployment.yml for localhost
2018-02-27 14:47:14,811 p=185617 u=qupeng |  TASK [local : download other binary] ***************************************************************************************************************************************
2018-02-27 14:47:14,901 p=185617 u=qupeng |  TASK [local : download other binary under gfw] *****************************************************************************************************************************
2018-02-27 14:47:30,009 p=185617 u=qupeng |  ok: [localhost] => (item={u'url': u'http://download.pingcap.org/prometheus-2.0.0.linux-amd64.tar.gz', u'version': u'2.0.0', u'name': u'prometheus'})
2018-02-27 14:47:37,544 p=185617 u=qupeng |  ok: [localhost] => (item={u'url': u'http://download.pingcap.org/alertmanager-0.9.1.linux-amd64.tar.gz', u'version': u'0.9.1', u'name': u'alertmanager'})
2018-02-27 14:47:42,274 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'http://download.pingcap.org/node_exporter-0.15.2.linux-amd64.tar.gz', u'version': u'0.15.2', u'name': u'node_exporter'})
2018-02-27 14:47:45,291 p=185617 u=qupeng |  ok: [localhost] => (item={u'url': u'http://download.pingcap.org/pushgateway-0.4.0.linux-amd64.tar.gz', u'version': u'0.4.0', u'name': u'pushgateway'})
2018-02-27 14:48:23,337 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'http://download.pingcap.org/grafana-4.6.3.linux-x64.tar.gz', u'version': u'4.6.3', u'name': u'grafana'})
2018-02-27 14:48:26,832 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://download.pingcap.org/blackbox_exporter-0.11.0.linux-amd64.tar.gz', u'version': u'0.11.0', u'name': u'blackbox_exporter'})
2018-02-27 14:48:26,847 p=185617 u=qupeng |  TASK [local : unarchive third party binary] ********************************************************************************************************************************
2018-02-27 14:48:27,781 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://github.com/prometheus/prometheus/releases/download/v2.0.0/prometheus-2.0.0.linux-amd64.tar.gz', u'version': u'2.0.0', u'name': u'prometheus'})
2018-02-27 14:48:28,291 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://github.com/prometheus/alertmanager/releases/download/v0.9.1/alertmanager-0.9.1.linux-amd64.tar.gz', u'version': u'0.9.1', u'name': u'alertmanager'})
2018-02-27 14:48:28,632 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://github.com/prometheus/node_exporter/releases/download/v0.15.2/node_exporter-0.15.2.linux-amd64.tar.gz', u'version': u'0.15.2', u'name': u'node_exporter'})
2018-02-27 14:48:28,951 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://github.com/prometheus/blackbox_exporter/releases/download/v0.11.0/blackbox_exporter-0.11.0.linux-amd64.tar.gz', u'version': u'0.11.0', u'name': u'blackbox_exporter'})
2018-02-27 14:48:29,207 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://github.com/prometheus/pushgateway/releases/download/v0.4.0/pushgateway-0.4.0.linux-amd64.tar.gz', u'version': u'0.4.0', u'name': u'pushgateway'})
2018-02-27 14:48:30,548 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://s3-us-west-2.amazonaws.com/grafana-releases/release/grafana-4.6.3.linux-x64.tar.gz', u'version': u'4.6.3', u'name': u'grafana'})
2018-02-27 14:48:30,557 p=185617 u=qupeng |  TASK [local : cp monitoring binary] ****************************************************************************************************************************************
2018-02-27 14:48:30,813 p=185617 u=qupeng |  changed: [localhost] => (item=alertmanager)
2018-02-27 14:48:31,093 p=185617 u=qupeng |  changed: [localhost] => (item=prometheus)
2018-02-27 14:48:31,294 p=185617 u=qupeng |  changed: [localhost] => (item=node_exporter)
2018-02-27 14:48:31,496 p=185617 u=qupeng |  changed: [localhost] => (item=pushgateway)
2018-02-27 14:48:31,721 p=185617 u=qupeng |  changed: [localhost] => (item=blackbox_exporter)
2018-02-27 14:48:31,725 p=185617 u=qupeng |  TASK [local : unarchive common binary] *************************************************************************************************************************************
2018-02-27 14:48:32,019 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'https://download.pingcap.org/fio-2.16.tar.gz', u'version': 2.16, u'name': u'fio'})
2018-02-27 14:48:32,232 p=185617 u=qupeng |  changed: [localhost] => (item={u'url': u'http://download.pingcap.org/daemontools-0.53.tar.gz', u'version': 0.53, u'name': u'daemontools'})
2018-02-27 14:48:32,241 p=185617 u=qupeng |  TASK [local : cp fio binary] ***********************************************************************************************************************************************
2018-02-27 14:48:33,456 p=185617 u=qupeng |  changed: [localhost] => (item=fio)
2018-02-27 14:48:33,464 p=185617 u=qupeng |  TASK [local : cp daemontools binary] ***************************************************************************************************************************************
2018-02-27 14:48:33,705 p=185617 u=qupeng |  changed: [localhost] => (item=supervise)
2018-02-27 14:48:33,890 p=185617 u=qupeng |  changed: [localhost] => (item=svstat)
2018-02-27 14:48:34,085 p=185617 u=qupeng |  changed: [localhost] => (item=svc)
2018-02-27 14:48:34,092 p=185617 u=qupeng |  TASK [local : clean up download dir] ***************************************************************************************************************************************
2018-02-27 14:48:34,386 p=185617 u=qupeng |  changed: [localhost]
2018-02-27 14:48:34,389 p=185617 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 14:48:34,389 p=185617 u=qupeng |  localhost                  : ok=18   changed=7    unreachable=0    failed=0   
2018-02-27 14:48:34,389 p=185617 u=qupeng |  Congrats! All goes well. :-)
2018-02-27 14:48:56,357 p=186431 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 14:48:56,370 p=186431 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 14:48:56,395 p=186431 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 14:48:56,421 p=186431 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 14:48:56,445 p=186431 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 14:48:56,472 p=186431 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 14:48:56,499 p=186431 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 14:48:56,560 p=186431 u=qupeng |  ok: [localhost]
2018-02-27 14:48:56,567 p=186431 u=qupeng |  PLAY [initializing deployment target] **************************************************************************************************************************************
2018-02-27 14:48:56,585 p=186431 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 14:48:56,718 p=186431 u=qupeng |  fatal: [172.16.21.1]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,719 fail [172.16.21.1]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,731 p=186431 u=qupeng |  fatal: [monitoring]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,732 fail [monitoring]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,744 p=186431 u=qupeng |  fatal: [pd]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,745 fail [pd]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,756 p=186431 u=qupeng |  fatal: [tidb]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,757 fail [tidb]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,757 p=186431 u=qupeng |  fatal: [tikv1]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,758 fail [tikv1]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,830 p=186431 u=qupeng |  fatal: [tikv2]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,830 fail [tikv2]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,850 p=186431 u=qupeng |  fatal: [tikv3]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,850 fail [tikv3]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,857 p=186431 u=qupeng |  fatal: [tikv4]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,858 fail [tikv4]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,858 p=186431 u=qupeng |  fatal: [tikv5]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,859 fail [tikv5]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}
2018-02-27 14:48:56,860 p=186431 u=qupeng |  NO MORE HOSTS LEFT *********************************************************************************************************************************************************
2018-02-27 14:48:56,861 p=186431 u=qupeng |  	to retry, use: --limit @/home/qupeng/ansible/tidb-ansible/retry_files/deploy.retry

2018-02-27 14:48:56,861 p=186431 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 14:48:56,861 p=186431 u=qupeng |  172.16.21.1                : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,862 p=186431 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 14:48:56,862 p=186431 u=qupeng |  monitoring                 : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,862 p=186431 u=qupeng |  pd                         : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,862 p=186431 u=qupeng |  tidb                       : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,862 p=186431 u=qupeng |  tikv1                      : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,863 p=186431 u=qupeng |  tikv2                      : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,863 p=186431 u=qupeng |  tikv3                      : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,863 p=186431 u=qupeng |  tikv4                      : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,863 p=186431 u=qupeng |  tikv5                      : ok=0    changed=0    unreachable=1    failed=0   
2018-02-27 14:48:56,863 p=186431 u=qupeng |  ERROR MESSAGE SUMMARY ******************************************************************************************************************************************************
2018-02-27 14:48:56,864 p=186431 u=qupeng |  [172.16.21.1]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,864 p=186431 u=qupeng |  [monitoring]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,864 p=186431 u=qupeng |  [pd]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,864 p=186431 u=qupeng |  [tidb]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,864 p=186431 u=qupeng |  [tikv1]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,864 p=186431 u=qupeng |  [tikv2]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,865 p=186431 u=qupeng |  [tikv3]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,865 p=186431 u=qupeng |  [tikv4]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,865 p=186431 u=qupeng |  [tikv5]: Ansible UNREACHABLE! => playbook: deploy.yml; TASK: check_config_dynamic : Disk space check - Fail task when disk is full; message: {"changed": false, "msg": "Failed to connect to the host via ssh: Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).\r\n", "unreachable": true}

2018-02-27 14:48:56,865 p=186431 u=qupeng |  Ask for help:
2018-02-27 14:48:56,865 p=186431 u=qupeng |  Contact us: sre@pingcap.com
2018-02-27 14:48:56,865 p=186431 u=qupeng |  It seems that you encounter some problems. You can send an email to the above email address, attached with the tidb-ansible/inventory.ini and tidb-ansible/log/ansible.log files and the error message, or new issue on https://github.com/pingcap/tidb-ansible/issues. We'll try our best to help you deploy a TiDB cluster. Thanks. :-)
2018-02-27 14:50:32,891 p=186573 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 14:50:32,905 p=186573 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 14:50:32,933 p=186573 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 14:50:32,957 p=186573 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 14:50:32,977 p=186573 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 14:50:33,000 p=186573 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 14:50:33,023 p=186573 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 14:50:33,089 p=186573 u=qupeng |  ok: [localhost]
2018-02-27 14:50:33,095 p=186573 u=qupeng |  PLAY [initializing deployment target] **************************************************************************************************************************************
2018-02-27 14:50:33,109 p=186573 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 14:50:33,269 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:33,287 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:33,300 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:33,311 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:33,313 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:33,408 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:33,416 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:33,428 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:33,437 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:33,446 p=186573 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 14:50:38,971 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:39,141 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:39,507 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:40,199 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:40,472 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:44,267 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:45,867 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:45,904 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:45,935 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:45,955 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 14:50:46,849 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:46,871 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:46,890 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:46,905 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:46,907 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:47,573 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:47,593 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:47,602 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:47,617 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:47,625 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 14:50:47,736 p=186573 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 14:50:47,845 p=186573 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 14:50:47,954 p=186573 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 14:50:47,997 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:48,009 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:48,020 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:48,033 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:48,044 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:48,048 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:48,050 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:48,067 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:48,072 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:48,079 p=186573 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 14:50:48,182 p=186573 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 14:50:48,282 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 14:50:48,385 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 14:50:49,117 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:49,156 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:49,185 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:49,203 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:49,205 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:49,814 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:49,874 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:49,914 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:49,945 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:49,960 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 14:50:50,756 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:50,783 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:50,802 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:50,816 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:50,818 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:51,464 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:51,516 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:51,520 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:51,545 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:51,557 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 14:50:51,671 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 14:50:51,775 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 14:50:52,600 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:52,622 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:52,638 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:52,653 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:52,654 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:53,267 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:53,275 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:53,283 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:53,291 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:53,305 p=186573 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 14:50:53,457 p=186573 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 14:50:53,637 p=186573 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 14:50:54,298 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:54,318 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:54,337 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:54,353 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:54,354 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:54,869 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:54,949 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:54,950 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:54,971 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:54,980 p=186573 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 14:50:55,090 p=186573 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 14:50:55,123 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:50:55,138 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:50:55,162 p=186573 u=qupeng |  ok: [pd]
2018-02-27 14:50:55,175 p=186573 u=qupeng |  ok: [tidb]
2018-02-27 14:50:55,188 p=186573 u=qupeng |  ok: [tikv1]
2018-02-27 14:50:55,189 p=186573 u=qupeng |  ok: [tikv2]
2018-02-27 14:50:55,189 p=186573 u=qupeng |  ok: [tikv3]
2018-02-27 14:50:55,203 p=186573 u=qupeng |  ok: [tikv4]
2018-02-27 14:50:55,215 p=186573 u=qupeng |  ok: [tikv5]
2018-02-27 14:50:55,223 p=186573 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 14:50:55,340 p=186573 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 14:50:55,461 p=186573 u=qupeng |  PLAY [deploying monitoring agent] ******************************************************************************************************************************************
2018-02-27 14:50:55,471 p=186573 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:50:56,308 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:50:57,009 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:50:57,741 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:50:57,755 p=186573 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:50:57,801 p=186573 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:50:58,512 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:50:58,527 p=186573 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:50:58,568 p=186573 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 14:50:58,615 p=186573 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:50:58,629 p=186573 u=qupeng |  TASK [node_exporter : create deploy directories] ***************************************************************************************************************************
2018-02-27 14:50:59,355 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:50:59,363 p=186573 u=qupeng |  TASK [node_exporter : deploy node_exporter binary] *************************************************************************************************************************
2018-02-27 14:51:01,835 p=186573 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:51:01,848 p=186573 u=qupeng |  TASK [node_exporter : create run script] ***********************************************************************************************************************************
2018-02-27 14:51:03,249 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=run)
2018-02-27 14:51:03,262 p=186573 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 14:51:03,305 p=186573 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 14:51:03,317 p=186573 u=qupeng |  TASK [node_exporter : deploy supervise] ************************************************************************************************************************************
2018-02-27 14:51:03,863 p=186573 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:51:04,617 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/node_exporter)
2018-02-27 14:51:04,634 p=186573 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:51:06,030 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=supervise)
2018-02-27 14:51:07,447 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=svc)
2018-02-27 14:51:08,838 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=svstat)
2018-02-27 14:51:08,858 p=186573 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:51:10,293 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=start)
2018-02-27 14:51:11,696 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=stop)
2018-02-27 14:51:11,712 p=186573 u=qupeng |  TASK [node_exporter : prepare firewalld white list] ************************************************************************************************************************
2018-02-27 14:51:11,763 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:51:11,778 p=186573 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 14:51:11,832 p=186573 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:51:11,845 p=186573 u=qupeng |  TASK [blackbox_exporter : create deploy directories] ***********************************************************************************************************************
2018-02-27 14:51:12,602 p=186573 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:51:12,617 p=186573 u=qupeng |  TASK [blackbox_exporter : deploy blackbox_exporter binary] *****************************************************************************************************************
2018-02-27 14:51:14,933 p=186573 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:51:14,946 p=186573 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 14:51:14,989 p=186573 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 14:51:15,942 p=186573 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:51:15,956 p=186573 u=qupeng |  TASK [blackbox_exporter : create run script] *******************************************************************************************************************************
2018-02-27 14:51:17,423 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=run)
2018-02-27 14:51:17,437 p=186573 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 14:51:17,489 p=186573 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 14:51:17,505 p=186573 u=qupeng |  TASK [blackbox_exporter : deploy supervise] ********************************************************************************************************************************
2018-02-27 14:51:18,026 p=186573 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:51:18,826 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/blackbox_exporter)
2018-02-27 14:51:18,842 p=186573 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:51:20,367 p=186573 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 14:51:21,810 p=186573 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 14:51:23,230 p=186573 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 14:51:23,238 p=186573 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:51:24,702 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=start)
2018-02-27 14:51:26,107 p=186573 u=qupeng |  changed: [172.16.21.1] => (item=stop)
2018-02-27 14:51:26,119 p=186573 u=qupeng |  TASK [blackbox_exporter : create config file] ******************************************************************************************************************************
2018-02-27 14:51:27,529 p=186573 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:51:27,542 p=186573 u=qupeng |  TASK [blackbox_exporter : backup conf file] ********************************************************************************************************************************
2018-02-27 14:51:27,585 p=186573 u=qupeng |  TASK [blackbox_exporter : prepare firewalld white list] ********************************************************************************************************************
2018-02-27 14:51:27,637 p=186573 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:51:27,647 p=186573 u=qupeng |  PLAY [deploying monitoring server] *****************************************************************************************************************************************
2018-02-27 14:51:27,668 p=186573 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:51:28,395 p=186573 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:51:29,114 p=186573 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:51:29,816 p=186573 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:51:29,824 p=186573 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:51:29,863 p=186573 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:51:30,592 p=186573 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:51:30,600 p=186573 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:51:30,638 p=186573 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 14:51:30,669 p=186573 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/binary_deployment.yml for monitoring
2018-02-27 14:51:30,676 p=186573 u=qupeng |  TASK [pushgateway : create deploy directories] *****************************************************************************************************************************
2018-02-27 14:51:31,391 p=186573 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:51:31,402 p=186573 u=qupeng |  TASK [pushgateway : deploy pushgateway binary] *****************************************************************************************************************************
2018-02-27 14:51:32,987 p=186573 u=qupeng |  changed: [monitoring]
2018-02-27 14:51:32,998 p=186573 u=qupeng |  TASK [pushgateway : create run script] *************************************************************************************************************************************
2018-02-27 14:51:34,452 p=186573 u=qupeng |  changed: [monitoring] => (item=run)
2018-02-27 14:51:34,467 p=186573 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 14:51:34,511 p=186573 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/supervise_deployment.yml for monitoring
2018-02-27 14:51:34,525 p=186573 u=qupeng |  TASK [pushgateway : deploy supervise] **************************************************************************************************************************************
2018-02-27 14:51:35,082 p=186573 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:51:35,849 p=186573 u=qupeng |  changed: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/pushgateway)
2018-02-27 14:51:35,864 p=186573 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:51:37,354 p=186573 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 14:51:38,739 p=186573 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 14:51:40,229 p=186573 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 14:51:40,244 p=186573 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:51:41,693 p=186573 u=qupeng |  changed: [monitoring] => (item=start)
2018-02-27 14:51:43,105 p=186573 u=qupeng |  changed: [monitoring] => (item=stop)
2018-02-27 14:51:43,114 p=186573 u=qupeng |  TASK [pushgateway : prepare firewalld white list] **************************************************************************************************************************
2018-02-27 14:51:43,168 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:51:43,175 p=186573 u=qupeng |  TASK [prometheus : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:51:43,889 p=186573 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:51:44,575 p=186573 u=qupeng |  changed: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 14:51:45,289 p=186573 u=qupeng |  changed: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 14:51:45,305 p=186573 u=qupeng |  TASK [prometheus : get config file stat] ***********************************************************************************************************************************
2018-02-27 14:51:46,028 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:51:46,040 p=186573 u=qupeng |  TASK [prometheus : get alert conf stat] ************************************************************************************************************************************
2018-02-27 14:51:46,771 p=186573 u=qupeng |  ok: [monitoring]
2018-02-27 14:51:46,787 p=186573 u=qupeng |  TASK [prometheus : create configuration file if not exist] *****************************************************************************************************************
2018-02-27 14:51:48,607 p=186573 u=qupeng |  changed: [monitoring]
2018-02-27 14:51:48,620 p=186573 u=qupeng |  TASK [prometheus : copy alert rules file] **********************************************************************************************************************************
2018-02-27 14:51:48,698 p=186573 u=qupeng |   [ERROR]: User interrupted execution

2018-02-27 14:52:37,700 p=192762 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 14:52:37,723 p=192762 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 14:52:37,755 p=192762 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 14:52:37,781 p=192762 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 14:52:37,801 p=192762 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 14:52:37,824 p=192762 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 14:52:37,846 p=192762 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 14:52:37,925 p=192762 u=qupeng |  ok: [localhost]
2018-02-27 14:52:37,934 p=192762 u=qupeng |  PLAY [initializing deployment target] **************************************************************************************************************************************
2018-02-27 14:52:37,960 p=192762 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 14:52:38,125 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:52:38,147 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:38,172 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:38,188 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:38,189 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:38,256 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:52:38,283 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:52:38,315 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:52:38,316 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:52:38,326 p=192762 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 14:52:44,279 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:44,365 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:44,421 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:44,502 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:45,113 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:52:49,765 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:52:50,093 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:52:51,142 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:52:51,177 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:52:51,195 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 14:52:52,128 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:52,149 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:52,167 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:52,185 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:52,187 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:52:52,873 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:52:52,934 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:52:52,936 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:52:52,942 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:52:52,950 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 14:52:53,060 p=192762 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 14:52:53,168 p=192762 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 14:52:53,267 p=192762 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 14:52:53,310 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:53,322 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:52:53,335 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:53,361 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:53,362 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:53,362 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:52:53,369 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:52:53,383 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:52:53,392 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:52:53,400 p=192762 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 14:52:53,510 p=192762 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 14:52:53,622 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 14:52:53,728 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 14:52:54,517 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:54,542 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:54,560 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:54,577 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:52:54,579 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:55,274 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:52:55,302 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:52:55,315 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:52:55,329 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:52:55,340 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 14:52:56,103 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:56,126 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:52:56,140 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:56,155 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:56,156 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:56,794 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:52:56,861 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:52:56,875 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:52:56,884 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:52:56,892 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 14:52:57,005 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 14:52:57,109 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 14:52:57,900 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:57,915 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:57,927 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:58,127 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:58,164 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:52:58,553 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:52:58,562 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:52:58,577 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:52:58,755 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:52:58,768 p=192762 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 14:52:58,896 p=192762 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 14:52:59,004 p=192762 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 14:52:59,656 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:52:59,667 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:52:59,680 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:52:59,855 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:52:59,890 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:00,275 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:53:00,306 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:53:00,320 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:53:00,516 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:53:00,524 p=192762 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 14:53:01,509 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:01,512 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:01,520 p=192762 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 14:53:01,566 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:01,579 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:01,592 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:53:01,604 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:53:01,626 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:53:01,628 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:53:01,629 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:53:01,631 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:53:01,658 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:53:01,672 p=192762 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 14:53:01,739 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:01,767 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:01,812 p=192762 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 14:53:01,856 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:01,880 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:01,924 p=192762 u=qupeng |  PLAY [deploying monitoring agent] ******************************************************************************************************************************************
2018-02-27 14:53:01,934 p=192762 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:53:02,801 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:53:03,516 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:53:04,212 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:53:04,227 p=192762 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:53:04,267 p=192762 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:53:04,987 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:53:05,001 p=192762 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:53:05,048 p=192762 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 14:53:05,098 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:53:05,112 p=192762 u=qupeng |  TASK [node_exporter : create deploy directories] ***************************************************************************************************************************
2018-02-27 14:53:05,840 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:53:05,856 p=192762 u=qupeng |  TASK [node_exporter : deploy node_exporter binary] *************************************************************************************************************************
2018-02-27 14:53:08,060 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:08,073 p=192762 u=qupeng |  TASK [node_exporter : create run script] ***********************************************************************************************************************************
2018-02-27 14:53:09,497 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=run)
2018-02-27 14:53:09,510 p=192762 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 14:53:09,554 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 14:53:09,567 p=192762 u=qupeng |  TASK [node_exporter : deploy supervise] ************************************************************************************************************************************
2018-02-27 14:53:10,135 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:53:10,907 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/node_exporter)
2018-02-27 14:53:10,922 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:53:12,411 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 14:53:13,830 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 14:53:15,279 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 14:53:15,293 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:53:16,765 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=start)
2018-02-27 14:53:18,222 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=stop)
2018-02-27 14:53:18,237 p=192762 u=qupeng |  TASK [node_exporter : prepare firewalld white list] ************************************************************************************************************************
2018-02-27 14:53:18,290 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:18,306 p=192762 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 14:53:18,363 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:53:18,375 p=192762 u=qupeng |  TASK [blackbox_exporter : create deploy directories] ***********************************************************************************************************************
2018-02-27 14:53:19,180 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:53:19,194 p=192762 u=qupeng |  TASK [blackbox_exporter : deploy blackbox_exporter binary] *****************************************************************************************************************
2018-02-27 14:53:21,410 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:21,417 p=192762 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 14:53:21,443 p=192762 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 14:53:22,322 p=192762 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:53:22,336 p=192762 u=qupeng |  TASK [blackbox_exporter : create run script] *******************************************************************************************************************************
2018-02-27 14:53:23,851 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=run)
2018-02-27 14:53:23,866 p=192762 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 14:53:23,919 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 14:53:23,934 p=192762 u=qupeng |  TASK [blackbox_exporter : deploy supervise] ********************************************************************************************************************************
2018-02-27 14:53:24,461 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:53:25,272 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/blackbox_exporter)
2018-02-27 14:53:25,284 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:53:26,767 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 14:53:28,173 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 14:53:29,598 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 14:53:29,615 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:53:31,119 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=start)
2018-02-27 14:53:32,569 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=stop)
2018-02-27 14:53:32,584 p=192762 u=qupeng |  TASK [blackbox_exporter : create config file] ******************************************************************************************************************************
2018-02-27 14:53:34,063 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:34,076 p=192762 u=qupeng |  TASK [blackbox_exporter : backup conf file] ********************************************************************************************************************************
2018-02-27 14:53:34,122 p=192762 u=qupeng |  TASK [blackbox_exporter : prepare firewalld white list] ********************************************************************************************************************
2018-02-27 14:53:34,176 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:53:34,186 p=192762 u=qupeng |  PLAY [deploying monitoring server] *****************************************************************************************************************************************
2018-02-27 14:53:34,204 p=192762 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:53:34,935 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:53:35,652 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:53:36,377 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:53:36,390 p=192762 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:53:36,428 p=192762 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:53:37,151 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:53:37,165 p=192762 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:53:37,203 p=192762 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 14:53:37,245 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/binary_deployment.yml for monitoring
2018-02-27 14:53:37,257 p=192762 u=qupeng |  TASK [pushgateway : create deploy directories] *****************************************************************************************************************************
2018-02-27 14:53:38,010 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:53:38,025 p=192762 u=qupeng |  TASK [pushgateway : deploy pushgateway binary] *****************************************************************************************************************************
2018-02-27 14:53:39,507 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:39,518 p=192762 u=qupeng |  TASK [pushgateway : create run script] *************************************************************************************************************************************
2018-02-27 14:53:40,987 p=192762 u=qupeng |  ok: [monitoring] => (item=run)
2018-02-27 14:53:41,000 p=192762 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 14:53:41,039 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/supervise_deployment.yml for monitoring
2018-02-27 14:53:41,050 p=192762 u=qupeng |  TASK [pushgateway : deploy supervise] **************************************************************************************************************************************
2018-02-27 14:53:41,605 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:53:42,387 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/pushgateway)
2018-02-27 14:53:42,399 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:53:43,817 p=192762 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 14:53:45,258 p=192762 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 14:53:46,669 p=192762 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 14:53:46,684 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:53:48,150 p=192762 u=qupeng |  ok: [monitoring] => (item=start)
2018-02-27 14:53:49,554 p=192762 u=qupeng |  ok: [monitoring] => (item=stop)
2018-02-27 14:53:49,569 p=192762 u=qupeng |  TASK [pushgateway : prepare firewalld white list] **************************************************************************************************************************
2018-02-27 14:53:49,625 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:49,641 p=192762 u=qupeng |  TASK [prometheus : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:53:50,377 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:53:51,067 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 14:53:51,776 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 14:53:51,792 p=192762 u=qupeng |  TASK [prometheus : get config file stat] ***********************************************************************************************************************************
2018-02-27 14:53:52,754 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:52,763 p=192762 u=qupeng |  TASK [prometheus : get alert conf stat] ************************************************************************************************************************************
2018-02-27 14:53:53,499 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:53,512 p=192762 u=qupeng |  TASK [prometheus : create configuration file if not exist] *****************************************************************************************************************
2018-02-27 14:53:55,235 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:53:55,249 p=192762 u=qupeng |  TASK [prometheus : copy alert rules file] **********************************************************************************************************************************
2018-02-27 14:53:56,880 p=192762 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 14:53:58,289 p=192762 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 14:53:59,651 p=192762 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 14:54:01,045 p=192762 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 14:54:02,417 p=192762 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 14:54:03,785 p=192762 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 14:54:05,139 p=192762 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 14:54:05,154 p=192762 u=qupeng |  TASK [prometheus : set alert rules label changes] **************************************************************************************************************************
2018-02-27 14:54:05,975 p=192762 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 14:54:06,681 p=192762 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 14:54:07,350 p=192762 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 14:54:08,069 p=192762 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 14:54:08,767 p=192762 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 14:54:09,471 p=192762 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 14:54:10,184 p=192762 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 14:54:10,201 p=192762 u=qupeng |  TASK [prometheus : create deploy data directory] ***************************************************************************************************************************
2018-02-27 14:54:10,949 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 14:54:10,961 p=192762 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 14:54:11,006 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/binary_deployment.yml for monitoring
2018-02-27 14:54:11,018 p=192762 u=qupeng |  TASK [prometheus : create deploy log directory] ****************************************************************************************************************************
2018-02-27 14:54:11,736 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:54:11,749 p=192762 u=qupeng |  TASK [prometheus : deploy prometheus binary] *******************************************************************************************************************************
2018-02-27 14:54:13,876 p=192762 u=qupeng |  changed: [monitoring]
2018-02-27 14:54:13,890 p=192762 u=qupeng |  TASK [prometheus : create run script] **************************************************************************************************************************************
2018-02-27 14:54:15,274 p=192762 u=qupeng |  changed: [monitoring] => (item=run)
2018-02-27 14:54:15,288 p=192762 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 14:54:15,333 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/supervise_deployment.yml for monitoring
2018-02-27 14:54:15,346 p=192762 u=qupeng |  TASK [prometheus : deploy supervise] ***************************************************************************************************************************************
2018-02-27 14:54:15,953 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:54:16,718 p=192762 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 14:54:16,732 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:54:18,198 p=192762 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 14:54:19,640 p=192762 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 14:54:21,018 p=192762 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 14:54:21,032 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:54:22,460 p=192762 u=qupeng |  changed: [monitoring] => (item=start)
2018-02-27 14:54:23,830 p=192762 u=qupeng |  changed: [monitoring] => (item=stop)
2018-02-27 14:54:23,840 p=192762 u=qupeng |  TASK [prometheus : prepare firewalld white list] ***************************************************************************************************************************
2018-02-27 14:54:23,899 p=192762 u=qupeng |  ok: [monitoring]
2018-02-27 14:54:23,904 p=192762 u=qupeng |  PLAY [deploying grafana] ***************************************************************************************************************************************************
2018-02-27 14:54:23,914 p=192762 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:54:24,631 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:54:25,422 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:54:26,119 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:54:26,133 p=192762 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:54:26,168 p=192762 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:54:26,962 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:54:26,976 p=192762 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:54:27,030 p=192762 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 14:54:27,086 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/tasks.yml for 172.16.21.1
2018-02-27 14:54:27,099 p=192762 u=qupeng |  TASK [grafana : create common deploy directories] **************************************************************************************************************************
2018-02-27 14:54:27,893 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:54:28,586 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/data.grafana)
2018-02-27 14:54:28,599 p=192762 u=qupeng |  TASK [grafana : push data source file] *************************************************************************************************************************************
2018-02-27 14:54:30,018 p=192762 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:54:30,033 p=192762 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 14:54:30,088 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:54:30,101 p=192762 u=qupeng |  TASK [grafana : create binary deploy directories (1/2)] ********************************************************************************************************************
2018-02-27 14:54:30,842 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt)
2018-02-27 14:54:30,857 p=192762 u=qupeng |  TASK [grafana : deploy grafana binary] *************************************************************************************************************************************
2018-02-27 14:54:38,109 p=192762 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:54:38,123 p=192762 u=qupeng |  TASK [grafana : rename grafana deploy dir] *********************************************************************************************************************************
2018-02-27 14:54:38,981 p=192762 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:54:38,995 p=192762 u=qupeng |  TASK [grafana : create binary deploy directories (2/2)] ********************************************************************************************************************
2018-02-27 14:54:39,739 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/dashboards)
2018-02-27 14:54:40,450 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/plugins)
2018-02-27 14:54:40,463 p=192762 u=qupeng |  TASK [grafana : create grafana configuration file] *************************************************************************************************************************
2018-02-27 14:54:41,849 p=192762 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:54:41,864 p=192762 u=qupeng |  TASK [grafana : create run script] *****************************************************************************************************************************************
2018-02-27 14:54:43,242 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=run)
2018-02-27 14:54:43,252 p=192762 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 14:54:43,285 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 14:54:43,294 p=192762 u=qupeng |  TASK [grafana : deploy supervise] ******************************************************************************************************************************************
2018-02-27 14:54:43,848 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:54:44,585 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/grafana)
2018-02-27 14:54:44,598 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:54:46,069 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 14:54:47,436 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 14:54:48,875 p=192762 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 14:54:48,892 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:54:50,273 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=start)
2018-02-27 14:54:51,663 p=192762 u=qupeng |  changed: [172.16.21.1] => (item=stop)
2018-02-27 14:54:51,678 p=192762 u=qupeng |  TASK [grafana : prepare firewalld white list] ******************************************************************************************************************************
2018-02-27 14:54:51,736 p=192762 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:54:51,745 p=192762 u=qupeng |  PLAY [deploying PD cluster] ************************************************************************************************************************************************
2018-02-27 14:54:51,763 p=192762 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:54:52,472 p=192762 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/scripts)
2018-02-27 14:54:53,274 p=192762 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 14:54:53,993 p=192762 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/backup)
2018-02-27 14:54:54,009 p=192762 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:54:54,057 p=192762 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:54:54,879 p=192762 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/bin)
2018-02-27 14:54:54,894 p=192762 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:54:54,938 p=192762 u=qupeng |  TASK [pd : create deploy directories] **************************************************************************************************************************************
2018-02-27 14:54:55,764 p=192762 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 14:54:56,492 p=192762 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 14:54:57,189 p=192762 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/data.pd)
2018-02-27 14:54:57,205 p=192762 u=qupeng |  TASK [pd : load customized config] *****************************************************************************************************************************************
2018-02-27 14:54:57,260 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:54:57,273 p=192762 u=qupeng |  TASK [pd : load default config] ********************************************************************************************************************************************
2018-02-27 14:54:57,329 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:54:57,343 p=192762 u=qupeng |  TASK [pd : generate metrics config] ****************************************************************************************************************************************
2018-02-27 14:54:57,426 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:54:57,440 p=192762 u=qupeng |  TASK [pd : generate final config] ******************************************************************************************************************************************
2018-02-27 14:54:57,474 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:54:57,486 p=192762 u=qupeng |  TASK [pd : debug] **********************************************************************************************************************************************************
2018-02-27 14:54:57,520 p=192762 u=qupeng |  ok: [pd] => {
    "pd_conf": {
        "global": {
            "lease": 3, 
            "tso-save-interval": "3s"
        }, 
        "log": {
            "file": {}, 
            "level": "info"
        }, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s"
        }, 
        "replication": {
            "location-labels": [], 
            "max-replicas": 3
        }, 
        "schedule": {
            "leader-schedule-limit": 64, 
            "max-pending-peer-count": 16, 
            "max-snapshot-count": 3, 
            "max-store-down-time": "1h", 
            "region-schedule-limit": 16, 
            "replica-schedule-limit": 24, 
            "tolerant-size-ratio": 2.5
        }, 
        "security": {
            "cacert-path": "", 
            "cert-path": "", 
            "key-path": ""
        }
    }
}
2018-02-27 14:54:57,531 p=192762 u=qupeng |  TASK [pd : create configuration file] **************************************************************************************************************************************
2018-02-27 14:54:58,922 p=192762 u=qupeng |  changed: [pd]
2018-02-27 14:54:58,935 p=192762 u=qupeng |  TASK [pd : backup conf file] ***********************************************************************************************************************************************
2018-02-27 14:54:58,972 p=192762 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 14:54:59,021 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/binary_deployment.yml for pd
2018-02-27 14:54:59,035 p=192762 u=qupeng |  TASK [pd : deploy binary] **************************************************************************************************************************************************
2018-02-27 14:55:00,831 p=192762 u=qupeng |  changed: [pd]
2018-02-27 14:55:00,843 p=192762 u=qupeng |  TASK [pd : backup bianry file] *********************************************************************************************************************************************
2018-02-27 14:55:00,883 p=192762 u=qupeng |  TASK [pd : create startup script] ******************************************************************************************************************************************
2018-02-27 14:55:02,343 p=192762 u=qupeng |  changed: [pd] => (item=run)
2018-02-27 14:55:02,354 p=192762 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 14:55:02,390 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/supervise_deployment.yml for pd
2018-02-27 14:55:02,401 p=192762 u=qupeng |  TASK [pd : deploy supervise] ***********************************************************************************************************************************************
2018-02-27 14:55:02,998 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:55:03,772 p=192762 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/pd)
2018-02-27 14:55:03,787 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:55:05,204 p=192762 u=qupeng |  changed: [pd] => (item=supervise)
2018-02-27 14:55:06,640 p=192762 u=qupeng |  changed: [pd] => (item=svc)
2018-02-27 14:55:08,037 p=192762 u=qupeng |  changed: [pd] => (item=svstat)
2018-02-27 14:55:08,047 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:55:09,452 p=192762 u=qupeng |  changed: [pd] => (item=start)
2018-02-27 14:55:10,869 p=192762 u=qupeng |  changed: [pd] => (item=stop)
2018-02-27 14:55:10,888 p=192762 u=qupeng |  TASK [pd : prepare firewalld white list] ***********************************************************************************************************************************
2018-02-27 14:55:10,960 p=192762 u=qupeng |  ok: [pd]
2018-02-27 14:55:10,967 p=192762 u=qupeng |  PLAY [deploying TiKV cluster] **********************************************************************************************************************************************
2018-02-27 14:55:10,983 p=192762 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:55:11,669 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/scripts)
2018-02-27 14:55:11,685 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/scripts)
2018-02-27 14:55:11,685 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/scripts)
2018-02-27 14:55:11,688 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/scripts)
2018-02-27 14:55:11,693 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/scripts)
2018-02-27 14:55:12,354 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 14:55:12,357 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 14:55:12,368 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 14:55:12,381 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 14:55:12,382 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 14:55:13,009 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/backup)
2018-02-27 14:55:13,020 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/backup)
2018-02-27 14:55:13,032 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/backup)
2018-02-27 14:55:13,037 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/backup)
2018-02-27 14:55:13,040 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/backup)
2018-02-27 14:55:13,054 p=192762 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:55:13,690 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status)
2018-02-27 14:55:13,747 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status)
2018-02-27 14:55:13,759 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status)
2018-02-27 14:55:13,771 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status)
2018-02-27 14:55:13,776 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status)
2018-02-27 14:55:13,790 p=192762 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:55:14,498 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/bin)
2018-02-27 14:55:14,501 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/bin)
2018-02-27 14:55:14,504 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/bin)
2018-02-27 14:55:14,506 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/bin)
2018-02-27 14:55:14,534 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/bin)
2018-02-27 14:55:14,548 p=192762 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:55:14,656 p=192762 u=qupeng |  TASK [tikv : create deploy directories] ************************************************************************************************************************************
2018-02-27 14:55:15,288 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/log)
2018-02-27 14:55:15,319 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/log)
2018-02-27 14:55:15,342 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/log)
2018-02-27 14:55:15,360 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/log)
2018-02-27 14:55:15,368 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/log)
2018-02-27 14:55:15,890 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/data)
2018-02-27 14:55:15,958 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/data)
2018-02-27 14:55:15,960 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/data)
2018-02-27 14:55:15,968 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/data)
2018-02-27 14:55:15,988 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/data)
2018-02-27 14:55:16,494 p=192762 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 14:55:16,594 p=192762 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 14:55:16,612 p=192762 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 14:55:16,615 p=192762 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 14:55:16,618 p=192762 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 14:55:16,627 p=192762 u=qupeng |  TASK [tikv : load customized config] ***************************************************************************************************************************************
2018-02-27 14:55:16,684 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:55:16,686 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:55:16,697 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:55:16,723 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:55:16,726 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:55:16,733 p=192762 u=qupeng |  TASK [tikv : load default config] ******************************************************************************************************************************************
2018-02-27 14:55:16,789 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:55:16,792 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:55:16,796 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:55:16,815 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:55:16,826 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:55:16,833 p=192762 u=qupeng |  TASK [tikv : generate metrics config] **************************************************************************************************************************************
2018-02-27 14:55:16,910 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:55:16,912 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:55:16,936 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:55:16,969 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:55:16,980 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:55:16,988 p=192762 u=qupeng |  TASK [tikv : generate final config] ****************************************************************************************************************************************
2018-02-27 14:55:17,045 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:55:17,055 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:55:17,064 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:55:17,071 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:55:17,094 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:55:17,101 p=192762 u=qupeng |  TASK [tikv : debug] ********************************************************************************************************************************************************
2018-02-27 14:55:17,152 p=192762 u=qupeng |  ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 14:55:17,160 p=192762 u=qupeng |  ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 14:55:17,180 p=192762 u=qupeng |  ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 14:55:17,184 p=192762 u=qupeng |  ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 14:55:17,192 p=192762 u=qupeng |  ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 14:55:17,199 p=192762 u=qupeng |  TASK [tikv : create config file] *******************************************************************************************************************************************
2018-02-27 14:55:18,521 p=192762 u=qupeng |  changed: [tikv5]
2018-02-27 14:55:18,524 p=192762 u=qupeng |  changed: [tikv4]
2018-02-27 14:55:18,526 p=192762 u=qupeng |  changed: [tikv2]
2018-02-27 14:55:18,528 p=192762 u=qupeng |  changed: [tikv1]
2018-02-27 14:55:18,529 p=192762 u=qupeng |  changed: [tikv3]
2018-02-27 14:55:18,537 p=192762 u=qupeng |  TASK [tikv : backup conf file] *********************************************************************************************************************************************
2018-02-27 14:55:18,609 p=192762 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 14:55:18,707 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 14:55:18,719 p=192762 u=qupeng |  TASK [tikv : deploy binary] ************************************************************************************************************************************************
2018-02-27 14:55:22,472 p=192762 u=qupeng |  changed: [tikv4]
2018-02-27 14:55:22,515 p=192762 u=qupeng |  changed: [tikv3]
2018-02-27 14:55:22,524 p=192762 u=qupeng |  changed: [tikv2]
2018-02-27 14:55:22,679 p=192762 u=qupeng |  changed: [tikv5]
2018-02-27 14:55:22,681 p=192762 u=qupeng |  changed: [tikv1]
2018-02-27 14:55:22,690 p=192762 u=qupeng |  TASK [tikv : backup bianry file] *******************************************************************************************************************************************
2018-02-27 14:55:22,771 p=192762 u=qupeng |  TASK [tikv : create run script] ********************************************************************************************************************************************
2018-02-27 14:55:24,043 p=192762 u=qupeng |  changed: [tikv1] => (item=run)
2018-02-27 14:55:24,052 p=192762 u=qupeng |  changed: [tikv4] => (item=run)
2018-02-27 14:55:24,124 p=192762 u=qupeng |  changed: [tikv3] => (item=run)
2018-02-27 14:55:24,141 p=192762 u=qupeng |  changed: [tikv5] => (item=run)
2018-02-27 14:55:24,161 p=192762 u=qupeng |  changed: [tikv2] => (item=run)
2018-02-27 14:55:24,176 p=192762 u=qupeng |  TASK [tikv : backup script file] *******************************************************************************************************************************************
2018-02-27 14:55:24,270 p=192762 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 14:55:24,381 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/supervise_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 14:55:24,395 p=192762 u=qupeng |  TASK [tikv : deploy supervise] *********************************************************************************************************************************************
2018-02-27 14:55:26,863 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:55:27,732 p=192762 u=qupeng |  changed: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status/tikv)
2018-02-27 14:55:27,766 p=192762 u=qupeng |  changed: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status/tikv)
2018-02-27 14:55:27,770 p=192762 u=qupeng |  changed: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status/tikv)
2018-02-27 14:55:27,772 p=192762 u=qupeng |  changed: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status/tikv)
2018-02-27 14:55:27,777 p=192762 u=qupeng |  changed: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status/tikv)
2018-02-27 14:55:27,786 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:55:29,249 p=192762 u=qupeng |  changed: [tikv2] => (item=supervise)
2018-02-27 14:55:29,267 p=192762 u=qupeng |  changed: [tikv4] => (item=supervise)
2018-02-27 14:55:29,276 p=192762 u=qupeng |  changed: [tikv1] => (item=supervise)
2018-02-27 14:55:29,303 p=192762 u=qupeng |  changed: [tikv5] => (item=supervise)
2018-02-27 14:55:29,323 p=192762 u=qupeng |  changed: [tikv3] => (item=supervise)
2018-02-27 14:55:30,503 p=192762 u=qupeng |  changed: [tikv1] => (item=svc)
2018-02-27 14:55:30,505 p=192762 u=qupeng |  changed: [tikv2] => (item=svc)
2018-02-27 14:55:30,535 p=192762 u=qupeng |  changed: [tikv4] => (item=svc)
2018-02-27 14:55:30,598 p=192762 u=qupeng |  changed: [tikv5] => (item=svc)
2018-02-27 14:55:30,600 p=192762 u=qupeng |  changed: [tikv3] => (item=svc)
2018-02-27 14:55:31,772 p=192762 u=qupeng |  changed: [tikv1] => (item=svstat)
2018-02-27 14:55:31,797 p=192762 u=qupeng |  changed: [tikv2] => (item=svstat)
2018-02-27 14:55:31,809 p=192762 u=qupeng |  changed: [tikv4] => (item=svstat)
2018-02-27 14:55:31,901 p=192762 u=qupeng |  changed: [tikv5] => (item=svstat)
2018-02-27 14:55:31,919 p=192762 u=qupeng |  changed: [tikv3] => (item=svstat)
2018-02-27 14:55:31,932 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:55:33,200 p=192762 u=qupeng |  changed: [tikv1] => (item=start)
2018-02-27 14:55:33,249 p=192762 u=qupeng |  changed: [tikv3] => (item=start)
2018-02-27 14:55:33,263 p=192762 u=qupeng |  changed: [tikv4] => (item=start)
2018-02-27 14:55:33,280 p=192762 u=qupeng |  changed: [tikv2] => (item=start)
2018-02-27 14:55:33,304 p=192762 u=qupeng |  changed: [tikv5] => (item=start)
2018-02-27 14:55:34,434 p=192762 u=qupeng |  changed: [tikv1] => (item=stop)
2018-02-27 14:55:34,479 p=192762 u=qupeng |  changed: [tikv4] => (item=stop)
2018-02-27 14:55:34,525 p=192762 u=qupeng |  changed: [tikv3] => (item=stop)
2018-02-27 14:55:34,533 p=192762 u=qupeng |  changed: [tikv2] => (item=stop)
2018-02-27 14:55:34,560 p=192762 u=qupeng |  changed: [tikv5] => (item=stop)
2018-02-27 14:55:34,578 p=192762 u=qupeng |  TASK [tikv : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 14:55:34,647 p=192762 u=qupeng |  ok: [tikv1]
2018-02-27 14:55:34,665 p=192762 u=qupeng |  ok: [tikv2]
2018-02-27 14:55:34,679 p=192762 u=qupeng |  ok: [tikv3]
2018-02-27 14:55:34,682 p=192762 u=qupeng |  ok: [tikv4]
2018-02-27 14:55:34,711 p=192762 u=qupeng |  ok: [tikv5]
2018-02-27 14:55:34,718 p=192762 u=qupeng |  PLAY [deploying TiDB cluster] **********************************************************************************************************************************************
2018-02-27 14:55:34,735 p=192762 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:55:34,789 p=192762 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:55:34,823 p=192762 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:55:34,854 p=192762 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:55:34,880 p=192762 u=qupeng |  TASK [pump : create deploy directories] ************************************************************************************************************************************
2018-02-27 14:55:34,916 p=192762 u=qupeng |  TASK [pump : include] ******************************************************************************************************************************************************
2018-02-27 14:55:34,940 p=192762 u=qupeng |  TASK [pump : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 14:55:34,962 p=192762 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:55:35,664 p=192762 u=qupeng |  changed: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/scripts)
2018-02-27 14:55:36,368 p=192762 u=qupeng |  changed: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 14:55:37,096 p=192762 u=qupeng |  changed: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/backup)
2018-02-27 14:55:37,113 p=192762 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:55:37,155 p=192762 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:55:37,868 p=192762 u=qupeng |  changed: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/bin)
2018-02-27 14:55:37,879 p=192762 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:55:37,923 p=192762 u=qupeng |  TASK [tidb : create deploy directories] ************************************************************************************************************************************
2018-02-27 14:55:38,688 p=192762 u=qupeng |  changed: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/log)
2018-02-27 14:55:39,417 p=192762 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 14:55:39,432 p=192762 u=qupeng |  TASK [tidb : load customized config] ***************************************************************************************************************************************
2018-02-27 14:55:39,489 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:55:39,505 p=192762 u=qupeng |  TASK [tidb : load default config] ******************************************************************************************************************************************
2018-02-27 14:55:39,559 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:55:39,576 p=192762 u=qupeng |  TASK [tidb : generate metrics config] **************************************************************************************************************************************
2018-02-27 14:55:39,641 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:55:39,656 p=192762 u=qupeng |  TASK [tidb : combine final config] *****************************************************************************************************************************************
2018-02-27 14:55:39,694 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:55:39,707 p=192762 u=qupeng |  TASK [tidb : debug] ********************************************************************************************************************************************************
2018-02-27 14:55:39,745 p=192762 u=qupeng |  ok: [tidb] => {
    "tidb_conf": {
        "global": {
            "enable-chunk": true, 
            "host": "0.0.0.0", 
            "lease": "10s", 
            "run-ddl": true, 
            "split-table": true, 
            "store": "tikv"
        }, 
        "log": {
            "disable-timestamp": false, 
            "file": {
                "log-rotate": true
            }, 
            "format": "text", 
            "level": "info", 
            "query-log-max-len": 2048, 
            "slow-threshold": 300
        }, 
        "opentracing": {
            "enable": false, 
            "reporter": {
                "buffer-flush-interval": 0, 
                "local-agent-host-port": "", 
                "log-spans": false, 
                "queue-size": 0
            }, 
            "rpc-metrics": false, 
            "sampler": {
                "max-operations": 0, 
                "param": 1.0, 
                "sampling-refresh-interval": 0, 
                "sampling-server-url": "", 
                "type": "const"
            }
        }, 
        "performance": {
            "cross-join": true, 
            "join-concurrency": 5, 
            "max-procs": 0, 
            "retry-limit": 10, 
            "run-auto-analyze": true, 
            "stats-lease": "3s", 
            "tcp-keep-alive": true
        }, 
        "plan_cache": {
            "capacity": 2560, 
            "enabled": false, 
            "shards": 256
        }, 
        "prepared_plan_cache": {
            "capacity": 100, 
            "enabled": false
        }, 
        "proxy_protocol": {
            "header-timeout": 5, 
            "networks": ""
        }, 
        "security": {
            "cluster-ssl-ca": "", 
            "cluster-ssl-cert": "", 
            "cluster-ssl-key": "", 
            "ssl-ca": "", 
            "ssl-cert": "", 
            "ssl-key": ""
        }, 
        "status": {
            "metrics-addr": "172.16.21.1:70011", 
            "metrics-interval": 15, 
            "report-status": true
        }, 
        "tikv_client": {
            "grpc-connection-count": 16
        }, 
        "xprotocol": {
            "xhost": "0.0.0.0", 
            "xport": 14000, 
            "xserver": false, 
            "xsocket": ""
        }
    }
}
2018-02-27 14:55:39,758 p=192762 u=qupeng |  TASK [tidb : create config file] *******************************************************************************************************************************************
2018-02-27 14:55:41,177 p=192762 u=qupeng |  changed: [tidb]
2018-02-27 14:55:41,192 p=192762 u=qupeng |  TASK [tidb : backup conf file] *********************************************************************************************************************************************
2018-02-27 14:55:41,234 p=192762 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 14:55:41,287 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/binary_deployment.yml for tidb
2018-02-27 14:55:41,302 p=192762 u=qupeng |  TASK [tidb : deploy binary] ************************************************************************************************************************************************
2018-02-27 14:55:43,297 p=192762 u=qupeng |  changed: [tidb]
2018-02-27 14:55:43,308 p=192762 u=qupeng |  TASK [tidb : backup binary file] *******************************************************************************************************************************************
2018-02-27 14:55:43,348 p=192762 u=qupeng |  TASK [tidb : create run script] ********************************************************************************************************************************************
2018-02-27 14:55:44,780 p=192762 u=qupeng |  changed: [tidb] => (item=run)
2018-02-27 14:55:44,796 p=192762 u=qupeng |  TASK [tidb : backup script file] *******************************************************************************************************************************************
2018-02-27 14:55:44,830 p=192762 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 14:55:44,877 p=192762 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/supervise_deployment.yml for tidb
2018-02-27 14:55:44,893 p=192762 u=qupeng |  TASK [tidb : deploy supervise] *********************************************************************************************************************************************
2018-02-27 14:55:45,692 p=192762 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:55:46,446 p=192762 u=qupeng |  changed: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/status/tidb)
2018-02-27 14:55:46,454 p=192762 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:55:47,908 p=192762 u=qupeng |  changed: [tidb] => (item=supervise)
2018-02-27 14:55:49,338 p=192762 u=qupeng |  changed: [tidb] => (item=svc)
2018-02-27 14:55:50,754 p=192762 u=qupeng |  changed: [tidb] => (item=svstat)
2018-02-27 14:55:50,770 p=192762 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:55:52,281 p=192762 u=qupeng |  changed: [tidb] => (item=start)
2018-02-27 14:55:53,753 p=192762 u=qupeng |  changed: [tidb] => (item=stop)
2018-02-27 14:55:53,770 p=192762 u=qupeng |  TASK [tidb : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 14:55:53,895 p=192762 u=qupeng |  ok: [tidb]
2018-02-27 14:55:53,908 p=192762 u=qupeng |  TASK [tispark : deploy spark-2.1.1-bin-hadoop2.7] **************************************************************************************************************************
2018-02-27 14:55:54,475 p=192762 u=qupeng |  fatal: [tidb]: FAILED! => {"changed": false, "msg": "Could not find or access '/home/qupeng/ansible/tidb-ansible/downloads/spark-2.1.1-bin-hadoop2.7.tgz'"}
2018-02-27 14:55:54,475 fail [tidb]: Ansible FAILED! => playbook: deploy.yml; TASK: tispark : deploy spark-2.1.1-bin-hadoop2.7; message: {"changed": false, "msg": "Could not find or access '/home/qupeng/ansible/tidb-ansible/downloads/spark-2.1.1-bin-hadoop2.7.tgz'"}
2018-02-27 14:55:54,477 p=192762 u=qupeng |  	to retry, use: --limit @/home/qupeng/ansible/tidb-ansible/retry_files/deploy.retry

2018-02-27 14:55:54,477 p=192762 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 14:55:54,478 p=192762 u=qupeng |  172.16.21.1                : ok=51   changed=11   unreachable=0    failed=0   
2018-02-27 14:55:54,478 p=192762 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 14:55:54,478 p=192762 u=qupeng |  monitoring                 : ok=39   changed=5    unreachable=0    failed=0   
2018-02-27 14:55:54,478 p=192762 u=qupeng |  pd                         : ok=26   changed=9    unreachable=0    failed=0   
2018-02-27 14:55:54,479 p=192762 u=qupeng |  tidb                       : ok=26   changed=9    unreachable=0    failed=1   
2018-02-27 14:55:54,479 p=192762 u=qupeng |  tikv1                      : ok=27   changed=10   unreachable=0    failed=0   
2018-02-27 14:55:54,479 p=192762 u=qupeng |  tikv2                      : ok=27   changed=10   unreachable=0    failed=0   
2018-02-27 14:55:54,479 p=192762 u=qupeng |  tikv3                      : ok=27   changed=10   unreachable=0    failed=0   
2018-02-27 14:55:54,480 p=192762 u=qupeng |  tikv4                      : ok=27   changed=10   unreachable=0    failed=0   
2018-02-27 14:55:54,480 p=192762 u=qupeng |  tikv5                      : ok=27   changed=10   unreachable=0    failed=0   
2018-02-27 14:55:54,480 p=192762 u=qupeng |  ERROR MESSAGE SUMMARY ******************************************************************************************************************************************************
2018-02-27 14:55:54,480 p=192762 u=qupeng |  [tidb]: Ansible FAILED! => playbook: deploy.yml; TASK: tispark : deploy spark-2.1.1-bin-hadoop2.7; message: {"changed": false, "msg": "Could not find or access '/home/qupeng/ansible/tidb-ansible/downloads/spark-2.1.1-bin-hadoop2.7.tgz'"}

2018-02-27 14:55:54,481 p=192762 u=qupeng |  Ask for help:
2018-02-27 14:55:54,481 p=192762 u=qupeng |  Contact us: sre@pingcap.com
2018-02-27 14:55:54,481 p=192762 u=qupeng |  It seems that you encounter some problems. You can send an email to the above email address, attached with the tidb-ansible/inventory.ini and tidb-ansible/log/ansible.log files and the error message, or new issue on https://github.com/pingcap/tidb-ansible/issues. We'll try our best to help you deploy a TiDB cluster. Thanks. :-)
2018-02-27 14:57:03,243 p=13221 u=qupeng |  ERROR! the role 'tispark' was not found in /home/qupeng/ansible/tidb-ansible/roles:/home/qupeng/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:/home/qupeng/ansible/tidb-ansible

The error appears to have been in '/home/qupeng/ansible/tidb-ansible/deploy.yml': line 65, column 7, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

    - tidb
    - { role: tispark, when: "(groups.get('spark_master', []) | length == 0 or groups.get('spark_slaves', []) | length == 0) and (deployment_method == 'binary')" }
      ^ here

2018-02-27 14:58:02,483 p=13247 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 14:58:02,501 p=13247 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 14:58:02,529 p=13247 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 14:58:02,553 p=13247 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 14:58:02,571 p=13247 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 14:58:02,594 p=13247 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 14:58:02,619 p=13247 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 14:58:02,684 p=13247 u=qupeng |  ok: [localhost]
2018-02-27 14:58:02,693 p=13247 u=qupeng |  PLAY [initializing deployment target] **************************************************************************************************************************************
2018-02-27 14:58:02,718 p=13247 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 14:58:02,881 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:02,904 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:02,925 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:02,943 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:02,944 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:03,009 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:03,038 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:03,054 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:03,061 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:03,072 p=13247 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 14:58:09,109 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:09,183 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:09,244 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:10,095 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:10,212 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:14,797 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:14,845 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:15,524 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:15,704 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:15,732 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 14:58:16,686 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:16,706 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:16,723 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:16,741 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:16,743 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:17,396 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:17,419 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:17,434 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:17,440 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:17,449 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 14:58:17,554 p=13247 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 14:58:17,657 p=13247 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 14:58:17,764 p=13247 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 14:58:17,810 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:17,824 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:17,847 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:17,860 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:17,862 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:17,871 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:17,875 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:17,887 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:17,897 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:17,904 p=13247 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 14:58:18,015 p=13247 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 14:58:18,127 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 14:58:18,242 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 14:58:19,010 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:19,030 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:19,046 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:19,059 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:19,060 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:19,773 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:19,783 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:19,784 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:19,796 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:19,807 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 14:58:20,581 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:20,604 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:20,626 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:20,642 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:20,644 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:21,346 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:21,347 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:21,351 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:21,352 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:21,360 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 14:58:21,479 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 14:58:21,592 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 14:58:22,617 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:22,632 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:22,679 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:22,695 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:22,715 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:23,497 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:23,507 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:23,519 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:23,545 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:23,556 p=13247 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 14:58:23,668 p=13247 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 14:58:23,775 p=13247 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 14:58:24,659 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:24,673 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:24,692 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:24,704 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:24,721 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:25,506 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:25,567 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:25,575 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:25,599 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:25,607 p=13247 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 14:58:26,492 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:26,508 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:26,523 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:26,537 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:26,545 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:27,338 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:27,346 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:27,418 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:27,432 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:27,445 p=13247 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 14:58:27,508 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:27,520 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:27,532 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:27,548 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:27,560 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:27,561 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:27,565 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:27,580 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:27,585 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:27,593 p=13247 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 14:58:27,648 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:27,661 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:27,683 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:27,696 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:27,696 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:27,697 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:27,712 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:27,730 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:27,733 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:27,740 p=13247 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 14:58:27,793 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:58:27,807 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:27,824 p=13247 u=qupeng |  ok: [pd]
2018-02-27 14:58:27,837 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 14:58:27,844 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 14:58:27,848 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 14:58:27,850 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 14:58:27,882 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 14:58:27,887 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 14:58:27,894 p=13247 u=qupeng |  PLAY [deploying monitoring agent] ******************************************************************************************************************************************
2018-02-27 14:58:27,904 p=13247 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:58:28,764 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:58:29,452 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:58:30,132 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:58:30,147 p=13247 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:58:30,187 p=13247 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:58:30,889 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:58:30,905 p=13247 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:58:30,953 p=13247 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 14:58:31,002 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:58:31,016 p=13247 u=qupeng |  TASK [node_exporter : create deploy directories] ***************************************************************************************************************************
2018-02-27 14:58:31,741 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:58:31,756 p=13247 u=qupeng |  TASK [node_exporter : deploy node_exporter binary] *************************************************************************************************************************
2018-02-27 14:58:33,957 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:33,967 p=13247 u=qupeng |  TASK [node_exporter : create run script] ***********************************************************************************************************************************
2018-02-27 14:58:35,360 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=run)
2018-02-27 14:58:35,368 p=13247 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 14:58:35,403 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 14:58:35,411 p=13247 u=qupeng |  TASK [node_exporter : deploy supervise] ************************************************************************************************************************************
2018-02-27 14:58:35,922 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:58:36,692 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/node_exporter)
2018-02-27 14:58:36,700 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:58:38,174 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 14:58:39,651 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 14:58:41,009 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 14:58:41,018 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:58:42,529 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=start)
2018-02-27 14:58:44,005 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=stop)
2018-02-27 14:58:44,022 p=13247 u=qupeng |  TASK [node_exporter : prepare firewalld white list] ************************************************************************************************************************
2018-02-27 14:58:44,145 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:44,153 p=13247 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 14:58:44,204 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:58:44,214 p=13247 u=qupeng |  TASK [blackbox_exporter : create deploy directories] ***********************************************************************************************************************
2018-02-27 14:58:45,016 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:58:45,029 p=13247 u=qupeng |  TASK [blackbox_exporter : deploy blackbox_exporter binary] *****************************************************************************************************************
2018-02-27 14:58:47,265 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:47,282 p=13247 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 14:58:47,328 p=13247 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 14:58:48,206 p=13247 u=qupeng |  changed: [172.16.21.1]
2018-02-27 14:58:48,218 p=13247 u=qupeng |  TASK [blackbox_exporter : create run script] *******************************************************************************************************************************
2018-02-27 14:58:49,658 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=run)
2018-02-27 14:58:49,672 p=13247 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 14:58:49,718 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 14:58:49,733 p=13247 u=qupeng |  TASK [blackbox_exporter : deploy supervise] ********************************************************************************************************************************
2018-02-27 14:58:50,287 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:58:51,051 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/blackbox_exporter)
2018-02-27 14:58:51,062 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:58:52,528 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 14:58:54,013 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 14:58:55,491 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 14:58:55,508 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:58:56,971 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=start)
2018-02-27 14:58:58,390 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=stop)
2018-02-27 14:58:58,407 p=13247 u=qupeng |  TASK [blackbox_exporter : create config file] ******************************************************************************************************************************
2018-02-27 14:58:59,846 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:59,861 p=13247 u=qupeng |  TASK [blackbox_exporter : backup conf file] ********************************************************************************************************************************
2018-02-27 14:58:59,905 p=13247 u=qupeng |  TASK [blackbox_exporter : prepare firewalld white list] ********************************************************************************************************************
2018-02-27 14:58:59,971 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:58:59,980 p=13247 u=qupeng |  PLAY [deploying monitoring server] *****************************************************************************************************************************************
2018-02-27 14:58:59,999 p=13247 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:59:00,738 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:59:01,457 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:59:02,158 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:59:02,167 p=13247 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:59:02,211 p=13247 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:59:02,940 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:59:02,948 p=13247 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:59:02,988 p=13247 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 14:59:03,024 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/binary_deployment.yml for monitoring
2018-02-27 14:59:03,032 p=13247 u=qupeng |  TASK [pushgateway : create deploy directories] *****************************************************************************************************************************
2018-02-27 14:59:03,761 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:59:03,769 p=13247 u=qupeng |  TASK [pushgateway : deploy pushgateway binary] *****************************************************************************************************************************
2018-02-27 14:59:05,238 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:59:05,253 p=13247 u=qupeng |  TASK [pushgateway : create run script] *************************************************************************************************************************************
2018-02-27 14:59:06,672 p=13247 u=qupeng |  ok: [monitoring] => (item=run)
2018-02-27 14:59:06,681 p=13247 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 14:59:06,708 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/supervise_deployment.yml for monitoring
2018-02-27 14:59:06,716 p=13247 u=qupeng |  TASK [pushgateway : deploy supervise] **************************************************************************************************************************************
2018-02-27 14:59:07,290 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:59:08,038 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/pushgateway)
2018-02-27 14:59:08,053 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:59:09,532 p=13247 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 14:59:10,951 p=13247 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 14:59:12,400 p=13247 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 14:59:12,417 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:59:13,935 p=13247 u=qupeng |  ok: [monitoring] => (item=start)
2018-02-27 14:59:15,362 p=13247 u=qupeng |  ok: [monitoring] => (item=stop)
2018-02-27 14:59:15,379 p=13247 u=qupeng |  TASK [pushgateway : prepare firewalld white list] **************************************************************************************************************************
2018-02-27 14:59:15,429 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:59:15,445 p=13247 u=qupeng |  TASK [prometheus : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:59:16,209 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:59:16,938 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 14:59:17,639 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 14:59:17,647 p=13247 u=qupeng |  TASK [prometheus : get config file stat] ***********************************************************************************************************************************
2018-02-27 14:59:18,690 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:59:18,705 p=13247 u=qupeng |  TASK [prometheus : get alert conf stat] ************************************************************************************************************************************
2018-02-27 14:59:19,410 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:59:19,424 p=13247 u=qupeng |  TASK [prometheus : create configuration file if not exist] *****************************************************************************************************************
2018-02-27 14:59:21,286 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:59:21,299 p=13247 u=qupeng |  TASK [prometheus : copy alert rules file] **********************************************************************************************************************************
2018-02-27 14:59:23,145 p=13247 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 14:59:24,713 p=13247 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 14:59:26,357 p=13247 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 14:59:27,994 p=13247 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 14:59:29,691 p=13247 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 14:59:31,404 p=13247 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 14:59:32,989 p=13247 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 14:59:33,008 p=13247 u=qupeng |  TASK [prometheus : set alert rules label changes] **************************************************************************************************************************
2018-02-27 14:59:33,893 p=13247 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 14:59:34,542 p=13247 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 14:59:35,262 p=13247 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 14:59:35,957 p=13247 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 14:59:36,680 p=13247 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 14:59:37,385 p=13247 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 14:59:38,089 p=13247 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 14:59:38,106 p=13247 u=qupeng |  TASK [prometheus : create deploy data directory] ***************************************************************************************************************************
2018-02-27 14:59:38,849 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 14:59:38,865 p=13247 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 14:59:38,914 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/binary_deployment.yml for monitoring
2018-02-27 14:59:38,927 p=13247 u=qupeng |  TASK [prometheus : create deploy log directory] ****************************************************************************************************************************
2018-02-27 14:59:39,668 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:59:39,683 p=13247 u=qupeng |  TASK [prometheus : deploy prometheus binary] *******************************************************************************************************************************
2018-02-27 14:59:41,374 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:59:41,387 p=13247 u=qupeng |  TASK [prometheus : create run script] **************************************************************************************************************************************
2018-02-27 14:59:42,854 p=13247 u=qupeng |  ok: [monitoring] => (item=run)
2018-02-27 14:59:42,869 p=13247 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 14:59:42,913 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/supervise_deployment.yml for monitoring
2018-02-27 14:59:42,927 p=13247 u=qupeng |  TASK [prometheus : deploy supervise] ***************************************************************************************************************************************
2018-02-27 14:59:43,568 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 14:59:44,293 p=13247 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 14:59:44,308 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 14:59:45,748 p=13247 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 14:59:47,157 p=13247 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 14:59:48,601 p=13247 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 14:59:48,618 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 14:59:50,125 p=13247 u=qupeng |  ok: [monitoring] => (item=start)
2018-02-27 14:59:51,546 p=13247 u=qupeng |  ok: [monitoring] => (item=stop)
2018-02-27 14:59:51,562 p=13247 u=qupeng |  TASK [prometheus : prepare firewalld white list] ***************************************************************************************************************************
2018-02-27 14:59:51,609 p=13247 u=qupeng |  ok: [monitoring]
2018-02-27 14:59:51,617 p=13247 u=qupeng |  PLAY [deploying grafana] ***************************************************************************************************************************************************
2018-02-27 14:59:51,630 p=13247 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 14:59:52,334 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 14:59:53,123 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 14:59:53,835 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 14:59:53,852 p=13247 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 14:59:53,904 p=13247 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 14:59:54,724 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 14:59:54,739 p=13247 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 14:59:54,793 p=13247 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 14:59:54,842 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/tasks.yml for 172.16.21.1
2018-02-27 14:59:54,854 p=13247 u=qupeng |  TASK [grafana : create common deploy directories] **************************************************************************************************************************
2018-02-27 14:59:55,685 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 14:59:56,389 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/data.grafana)
2018-02-27 14:59:56,403 p=13247 u=qupeng |  TASK [grafana : push data source file] *************************************************************************************************************************************
2018-02-27 14:59:57,930 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:59:57,944 p=13247 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 14:59:58,004 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 14:59:58,018 p=13247 u=qupeng |  TASK [grafana : create binary deploy directories (1/2)] ********************************************************************************************************************
2018-02-27 14:59:58,723 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt)
2018-02-27 14:59:58,737 p=13247 u=qupeng |  TASK [grafana : deploy grafana binary] *************************************************************************************************************************************
2018-02-27 14:59:59,244 p=13247 u=qupeng |  TASK [grafana : rename grafana deploy dir] *********************************************************************************************************************************
2018-02-27 14:59:59,956 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 14:59:59,970 p=13247 u=qupeng |  TASK [grafana : create binary deploy directories (2/2)] ********************************************************************************************************************
2018-02-27 15:00:00,716 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/dashboards)
2018-02-27 15:00:01,406 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/plugins)
2018-02-27 15:00:01,416 p=13247 u=qupeng |  TASK [grafana : create grafana configuration file] *************************************************************************************************************************
2018-02-27 15:00:02,882 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:00:02,898 p=13247 u=qupeng |  TASK [grafana : create run script] *****************************************************************************************************************************************
2018-02-27 15:00:04,339 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=run)
2018-02-27 15:00:04,355 p=13247 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:00:04,405 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 15:00:04,421 p=13247 u=qupeng |  TASK [grafana : deploy supervise] ******************************************************************************************************************************************
2018-02-27 15:00:04,994 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:00:05,740 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/grafana)
2018-02-27 15:00:05,756 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:00:07,241 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 15:00:08,703 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 15:00:10,172 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 15:00:10,181 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:00:11,652 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=start)
2018-02-27 15:00:13,107 p=13247 u=qupeng |  ok: [172.16.21.1] => (item=stop)
2018-02-27 15:00:13,122 p=13247 u=qupeng |  TASK [grafana : prepare firewalld white list] ******************************************************************************************************************************
2018-02-27 15:00:13,166 p=13247 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:00:13,175 p=13247 u=qupeng |  PLAY [deploying PD cluster] ************************************************************************************************************************************************
2018-02-27 15:00:13,193 p=13247 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:00:13,928 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/scripts)
2018-02-27 15:00:14,611 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:00:15,265 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/backup)
2018-02-27 15:00:15,279 p=13247 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:00:15,320 p=13247 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:00:16,053 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/bin)
2018-02-27 15:00:16,066 p=13247 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:00:16,114 p=13247 u=qupeng |  TASK [pd : create deploy directories] **************************************************************************************************************************************
2018-02-27 15:00:16,808 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 15:00:17,490 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:00:18,182 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/data.pd)
2018-02-27 15:00:18,198 p=13247 u=qupeng |  TASK [pd : load customized config] *****************************************************************************************************************************************
2018-02-27 15:00:18,258 p=13247 u=qupeng |  ok: [pd]
2018-02-27 15:00:18,273 p=13247 u=qupeng |  TASK [pd : load default config] ********************************************************************************************************************************************
2018-02-27 15:00:18,321 p=13247 u=qupeng |  ok: [pd]
2018-02-27 15:00:18,335 p=13247 u=qupeng |  TASK [pd : generate metrics config] ****************************************************************************************************************************************
2018-02-27 15:00:18,422 p=13247 u=qupeng |  ok: [pd]
2018-02-27 15:00:18,436 p=13247 u=qupeng |  TASK [pd : generate final config] ******************************************************************************************************************************************
2018-02-27 15:00:18,483 p=13247 u=qupeng |  ok: [pd]
2018-02-27 15:00:18,496 p=13247 u=qupeng |  TASK [pd : debug] **********************************************************************************************************************************************************
2018-02-27 15:00:18,542 p=13247 u=qupeng |  ok: [pd] => {
    "pd_conf": {
        "global": {
            "lease": 3, 
            "tso-save-interval": "3s"
        }, 
        "log": {
            "file": {}, 
            "level": "info"
        }, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s"
        }, 
        "replication": {
            "location-labels": [], 
            "max-replicas": 3
        }, 
        "schedule": {
            "leader-schedule-limit": 64, 
            "max-pending-peer-count": 16, 
            "max-snapshot-count": 3, 
            "max-store-down-time": "1h", 
            "region-schedule-limit": 16, 
            "replica-schedule-limit": 24, 
            "tolerant-size-ratio": 2.5
        }, 
        "security": {
            "cacert-path": "", 
            "cert-path": "", 
            "key-path": ""
        }
    }
}
2018-02-27 15:00:18,556 p=13247 u=qupeng |  TASK [pd : create configuration file] **************************************************************************************************************************************
2018-02-27 15:00:19,994 p=13247 u=qupeng |  ok: [pd]
2018-02-27 15:00:20,007 p=13247 u=qupeng |  TASK [pd : backup conf file] ***********************************************************************************************************************************************
2018-02-27 15:00:20,048 p=13247 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 15:00:20,103 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/binary_deployment.yml for pd
2018-02-27 15:00:20,117 p=13247 u=qupeng |  TASK [pd : deploy binary] **************************************************************************************************************************************************
2018-02-27 15:00:21,690 p=13247 u=qupeng |  ok: [pd]
2018-02-27 15:00:21,704 p=13247 u=qupeng |  TASK [pd : backup bianry file] *********************************************************************************************************************************************
2018-02-27 15:00:21,742 p=13247 u=qupeng |  TASK [pd : create startup script] ******************************************************************************************************************************************
2018-02-27 15:00:23,289 p=13247 u=qupeng |  ok: [pd] => (item=run)
2018-02-27 15:00:23,303 p=13247 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 15:00:23,416 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/supervise_deployment.yml for pd
2018-02-27 15:00:23,426 p=13247 u=qupeng |  TASK [pd : deploy supervise] ***********************************************************************************************************************************************
2018-02-27 15:00:24,003 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:00:24,837 p=13247 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/pd)
2018-02-27 15:00:24,847 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:00:26,316 p=13247 u=qupeng |  ok: [pd] => (item=supervise)
2018-02-27 15:00:27,761 p=13247 u=qupeng |  ok: [pd] => (item=svc)
2018-02-27 15:00:29,183 p=13247 u=qupeng |  ok: [pd] => (item=svstat)
2018-02-27 15:00:29,194 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:00:30,582 p=13247 u=qupeng |  ok: [pd] => (item=start)
2018-02-27 15:00:31,997 p=13247 u=qupeng |  ok: [pd] => (item=stop)
2018-02-27 15:00:32,013 p=13247 u=qupeng |  TASK [pd : prepare firewalld white list] ***********************************************************************************************************************************
2018-02-27 15:00:32,058 p=13247 u=qupeng |  ok: [pd]
2018-02-27 15:00:32,068 p=13247 u=qupeng |  PLAY [deploying TiKV cluster] **********************************************************************************************************************************************
2018-02-27 15:00:32,088 p=13247 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:00:32,722 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/scripts)
2018-02-27 15:00:32,756 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/scripts)
2018-02-27 15:00:32,780 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/scripts)
2018-02-27 15:00:32,801 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/scripts)
2018-02-27 15:00:32,808 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/scripts)
2018-02-27 15:00:33,315 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 15:00:33,362 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 15:00:33,371 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 15:00:33,431 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 15:00:33,445 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 15:00:33,975 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/backup)
2018-02-27 15:00:33,989 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/backup)
2018-02-27 15:00:33,996 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/backup)
2018-02-27 15:00:34,060 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/backup)
2018-02-27 15:00:34,096 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/backup)
2018-02-27 15:00:34,110 p=13247 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:00:34,787 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status)
2018-02-27 15:00:34,791 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status)
2018-02-27 15:00:34,799 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status)
2018-02-27 15:00:34,816 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status)
2018-02-27 15:00:34,837 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status)
2018-02-27 15:00:34,852 p=13247 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:00:35,479 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/bin)
2018-02-27 15:00:35,564 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/bin)
2018-02-27 15:00:35,575 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/bin)
2018-02-27 15:00:35,596 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/bin)
2018-02-27 15:00:35,599 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/bin)
2018-02-27 15:00:35,608 p=13247 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:00:35,687 p=13247 u=qupeng |  TASK [tikv : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:00:36,315 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/log)
2018-02-27 15:00:36,395 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/log)
2018-02-27 15:00:36,396 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/log)
2018-02-27 15:00:36,397 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/log)
2018-02-27 15:00:36,398 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/log)
2018-02-27 15:00:36,978 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/data)
2018-02-27 15:00:37,072 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/data)
2018-02-27 15:00:37,086 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/data)
2018-02-27 15:00:37,093 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/data)
2018-02-27 15:00:37,113 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/data)
2018-02-27 15:00:37,629 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 15:00:37,730 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 15:00:37,737 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 15:00:37,744 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 15:00:37,750 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 15:00:37,764 p=13247 u=qupeng |  TASK [tikv : load customized config] ***************************************************************************************************************************************
2018-02-27 15:00:37,823 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 15:00:37,842 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 15:00:37,844 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 15:00:37,852 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 15:00:37,876 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 15:00:37,886 p=13247 u=qupeng |  TASK [tikv : load default config] ******************************************************************************************************************************************
2018-02-27 15:00:37,933 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 15:00:37,955 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 15:00:37,958 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 15:00:37,980 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 15:00:37,985 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 15:00:37,992 p=13247 u=qupeng |  TASK [tikv : generate metrics config] **************************************************************************************************************************************
2018-02-27 15:00:38,067 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 15:00:38,072 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 15:00:38,083 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 15:00:38,129 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 15:00:38,142 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 15:00:38,149 p=13247 u=qupeng |  TASK [tikv : generate final config] ****************************************************************************************************************************************
2018-02-27 15:00:38,206 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 15:00:38,212 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 15:00:38,225 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 15:00:38,244 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 15:00:38,257 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 15:00:38,264 p=13247 u=qupeng |  TASK [tikv : debug] ********************************************************************************************************************************************************
2018-02-27 15:00:38,319 p=13247 u=qupeng |  ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:00:38,322 p=13247 u=qupeng |  ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:00:38,346 p=13247 u=qupeng |  ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:00:38,350 p=13247 u=qupeng |  ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:00:38,356 p=13247 u=qupeng |  ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:00:38,367 p=13247 u=qupeng |  TASK [tikv : create config file] *******************************************************************************************************************************************
2018-02-27 15:00:39,621 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 15:00:39,696 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 15:00:39,748 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 15:00:39,767 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 15:00:39,799 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 15:00:39,811 p=13247 u=qupeng |  TASK [tikv : backup conf file] *********************************************************************************************************************************************
2018-02-27 15:00:39,899 p=13247 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 15:00:40,003 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 15:00:40,017 p=13247 u=qupeng |  TASK [tikv : deploy binary] ************************************************************************************************************************************************
2018-02-27 15:00:41,996 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 15:00:42,004 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 15:00:42,007 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 15:00:42,074 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 15:00:42,077 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 15:00:42,093 p=13247 u=qupeng |  TASK [tikv : backup bianry file] *******************************************************************************************************************************************
2018-02-27 15:00:42,189 p=13247 u=qupeng |  TASK [tikv : create run script] ********************************************************************************************************************************************
2018-02-27 15:00:43,523 p=13247 u=qupeng |  ok: [tikv1] => (item=run)
2018-02-27 15:00:43,547 p=13247 u=qupeng |  ok: [tikv4] => (item=run)
2018-02-27 15:00:43,565 p=13247 u=qupeng |  ok: [tikv3] => (item=run)
2018-02-27 15:00:43,582 p=13247 u=qupeng |  ok: [tikv2] => (item=run)
2018-02-27 15:00:43,595 p=13247 u=qupeng |  ok: [tikv5] => (item=run)
2018-02-27 15:00:43,604 p=13247 u=qupeng |  TASK [tikv : backup script file] *******************************************************************************************************************************************
2018-02-27 15:00:43,682 p=13247 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 15:00:43,782 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/supervise_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 15:00:43,795 p=13247 u=qupeng |  TASK [tikv : deploy supervise] *********************************************************************************************************************************************
2018-02-27 15:00:46,538 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:00:47,259 p=13247 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status/tikv)
2018-02-27 15:00:47,262 p=13247 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status/tikv)
2018-02-27 15:00:47,264 p=13247 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status/tikv)
2018-02-27 15:00:47,268 p=13247 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status/tikv)
2018-02-27 15:00:47,269 p=13247 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status/tikv)
2018-02-27 15:00:47,284 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:00:48,567 p=13247 u=qupeng |  ok: [tikv2] => (item=supervise)
2018-02-27 15:00:48,575 p=13247 u=qupeng |  ok: [tikv1] => (item=supervise)
2018-02-27 15:00:48,674 p=13247 u=qupeng |  ok: [tikv3] => (item=supervise)
2018-02-27 15:00:48,687 p=13247 u=qupeng |  ok: [tikv4] => (item=supervise)
2018-02-27 15:00:48,702 p=13247 u=qupeng |  ok: [tikv5] => (item=supervise)
2018-02-27 15:00:49,824 p=13247 u=qupeng |  ok: [tikv2] => (item=svc)
2018-02-27 15:00:49,906 p=13247 u=qupeng |  ok: [tikv1] => (item=svc)
2018-02-27 15:00:49,953 p=13247 u=qupeng |  ok: [tikv5] => (item=svc)
2018-02-27 15:00:49,964 p=13247 u=qupeng |  ok: [tikv3] => (item=svc)
2018-02-27 15:00:50,012 p=13247 u=qupeng |  ok: [tikv4] => (item=svc)
2018-02-27 15:00:51,091 p=13247 u=qupeng |  ok: [tikv2] => (item=svstat)
2018-02-27 15:00:51,138 p=13247 u=qupeng |  ok: [tikv1] => (item=svstat)
2018-02-27 15:00:51,220 p=13247 u=qupeng |  ok: [tikv3] => (item=svstat)
2018-02-27 15:00:51,244 p=13247 u=qupeng |  ok: [tikv4] => (item=svstat)
2018-02-27 15:00:51,282 p=13247 u=qupeng |  ok: [tikv5] => (item=svstat)
2018-02-27 15:00:51,291 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:00:52,648 p=13247 u=qupeng |  ok: [tikv1] => (item=start)
2018-02-27 15:00:52,651 p=13247 u=qupeng |  ok: [tikv3] => (item=start)
2018-02-27 15:00:52,662 p=13247 u=qupeng |  ok: [tikv2] => (item=start)
2018-02-27 15:00:52,681 p=13247 u=qupeng |  ok: [tikv5] => (item=start)
2018-02-27 15:00:52,707 p=13247 u=qupeng |  ok: [tikv4] => (item=start)
2018-02-27 15:00:53,949 p=13247 u=qupeng |  ok: [tikv4] => (item=stop)
2018-02-27 15:00:53,972 p=13247 u=qupeng |  ok: [tikv2] => (item=stop)
2018-02-27 15:00:53,991 p=13247 u=qupeng |  ok: [tikv1] => (item=stop)
2018-02-27 15:00:53,997 p=13247 u=qupeng |  ok: [tikv5] => (item=stop)
2018-02-27 15:00:54,017 p=13247 u=qupeng |  ok: [tikv3] => (item=stop)
2018-02-27 15:00:54,026 p=13247 u=qupeng |  TASK [tikv : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:00:54,088 p=13247 u=qupeng |  ok: [tikv1]
2018-02-27 15:00:54,104 p=13247 u=qupeng |  ok: [tikv2]
2018-02-27 15:00:54,108 p=13247 u=qupeng |  ok: [tikv3]
2018-02-27 15:00:54,134 p=13247 u=qupeng |  ok: [tikv4]
2018-02-27 15:00:54,140 p=13247 u=qupeng |  ok: [tikv5]
2018-02-27 15:00:54,147 p=13247 u=qupeng |  PLAY [deploying TiDB cluster] **********************************************************************************************************************************************
2018-02-27 15:00:54,160 p=13247 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:00:54,200 p=13247 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:00:54,233 p=13247 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:00:54,270 p=13247 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:00:54,297 p=13247 u=qupeng |  TASK [pump : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:00:54,331 p=13247 u=qupeng |  TASK [pump : include] ******************************************************************************************************************************************************
2018-02-27 15:00:54,359 p=13247 u=qupeng |  TASK [pump : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:00:54,385 p=13247 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:00:55,173 p=13247 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/scripts)
2018-02-27 15:00:56,014 p=13247 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 15:00:56,704 p=13247 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/backup)
2018-02-27 15:00:56,720 p=13247 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:00:56,767 p=13247 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:00:57,668 p=13247 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/bin)
2018-02-27 15:00:57,676 p=13247 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:00:57,715 p=13247 u=qupeng |  TASK [tidb : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:00:58,593 p=13247 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/log)
2018-02-27 15:00:59,304 p=13247 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 15:00:59,316 p=13247 u=qupeng |  TASK [tidb : load customized config] ***************************************************************************************************************************************
2018-02-27 15:00:59,366 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 15:00:59,378 p=13247 u=qupeng |  TASK [tidb : load default config] ******************************************************************************************************************************************
2018-02-27 15:00:59,441 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 15:00:59,455 p=13247 u=qupeng |  TASK [tidb : generate metrics config] **************************************************************************************************************************************
2018-02-27 15:00:59,549 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 15:00:59,562 p=13247 u=qupeng |  TASK [tidb : combine final config] *****************************************************************************************************************************************
2018-02-27 15:00:59,606 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 15:00:59,619 p=13247 u=qupeng |  TASK [tidb : debug] ********************************************************************************************************************************************************
2018-02-27 15:00:59,663 p=13247 u=qupeng |  ok: [tidb] => {
    "tidb_conf": {
        "global": {
            "enable-chunk": true, 
            "host": "0.0.0.0", 
            "lease": "10s", 
            "run-ddl": true, 
            "split-table": true, 
            "store": "tikv"
        }, 
        "log": {
            "disable-timestamp": false, 
            "file": {
                "log-rotate": true
            }, 
            "format": "text", 
            "level": "info", 
            "query-log-max-len": 2048, 
            "slow-threshold": 300
        }, 
        "opentracing": {
            "enable": false, 
            "reporter": {
                "buffer-flush-interval": 0, 
                "local-agent-host-port": "", 
                "log-spans": false, 
                "queue-size": 0
            }, 
            "rpc-metrics": false, 
            "sampler": {
                "max-operations": 0, 
                "param": 1.0, 
                "sampling-refresh-interval": 0, 
                "sampling-server-url": "", 
                "type": "const"
            }
        }, 
        "performance": {
            "cross-join": true, 
            "join-concurrency": 5, 
            "max-procs": 0, 
            "retry-limit": 10, 
            "run-auto-analyze": true, 
            "stats-lease": "3s", 
            "tcp-keep-alive": true
        }, 
        "plan_cache": {
            "capacity": 2560, 
            "enabled": false, 
            "shards": 256
        }, 
        "prepared_plan_cache": {
            "capacity": 100, 
            "enabled": false
        }, 
        "proxy_protocol": {
            "header-timeout": 5, 
            "networks": ""
        }, 
        "security": {
            "cluster-ssl-ca": "", 
            "cluster-ssl-cert": "", 
            "cluster-ssl-key": "", 
            "ssl-ca": "", 
            "ssl-cert": "", 
            "ssl-key": ""
        }, 
        "status": {
            "metrics-addr": "172.16.21.1:70011", 
            "metrics-interval": 15, 
            "report-status": true
        }, 
        "tikv_client": {
            "grpc-connection-count": 16
        }, 
        "xprotocol": {
            "xhost": "0.0.0.0", 
            "xport": 14000, 
            "xserver": false, 
            "xsocket": ""
        }
    }
}
2018-02-27 15:00:59,677 p=13247 u=qupeng |  TASK [tidb : create config file] *******************************************************************************************************************************************
2018-02-27 15:01:01,177 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 15:01:01,189 p=13247 u=qupeng |  TASK [tidb : backup conf file] *********************************************************************************************************************************************
2018-02-27 15:01:01,230 p=13247 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 15:01:01,275 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/binary_deployment.yml for tidb
2018-02-27 15:01:01,288 p=13247 u=qupeng |  TASK [tidb : deploy binary] ************************************************************************************************************************************************
2018-02-27 15:01:02,905 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 15:01:02,918 p=13247 u=qupeng |  TASK [tidb : backup binary file] *******************************************************************************************************************************************
2018-02-27 15:01:02,958 p=13247 u=qupeng |  TASK [tidb : create run script] ********************************************************************************************************************************************
2018-02-27 15:01:04,506 p=13247 u=qupeng |  ok: [tidb] => (item=run)
2018-02-27 15:01:04,523 p=13247 u=qupeng |  TASK [tidb : backup script file] *******************************************************************************************************************************************
2018-02-27 15:01:04,563 p=13247 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 15:01:04,608 p=13247 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/supervise_deployment.yml for tidb
2018-02-27 15:01:04,622 p=13247 u=qupeng |  TASK [tidb : deploy supervise] *********************************************************************************************************************************************
2018-02-27 15:01:05,249 p=13247 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:01:06,032 p=13247 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/status/tidb)
2018-02-27 15:01:06,045 p=13247 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:01:07,521 p=13247 u=qupeng |  ok: [tidb] => (item=supervise)
2018-02-27 15:01:08,927 p=13247 u=qupeng |  ok: [tidb] => (item=svc)
2018-02-27 15:01:10,428 p=13247 u=qupeng |  ok: [tidb] => (item=svstat)
2018-02-27 15:01:10,444 p=13247 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:01:11,897 p=13247 u=qupeng |  ok: [tidb] => (item=start)
2018-02-27 15:01:13,401 p=13247 u=qupeng |  ok: [tidb] => (item=stop)
2018-02-27 15:01:13,419 p=13247 u=qupeng |  TASK [tidb : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:01:13,479 p=13247 u=qupeng |  ok: [tidb]
2018-02-27 15:01:13,489 p=13247 u=qupeng |  PLAY [finalizing deployment target] ****************************************************************************************************************************************
2018-02-27 15:01:13,513 p=13247 u=qupeng |  TASK [firewalld : All enabled ports] ***************************************************************************************************************************************
2018-02-27 15:01:13,674 p=13247 u=qupeng |  TASK [firewalld : determine if firewalld is running] ***********************************************************************************************************************
2018-02-27 15:01:13,853 p=13247 u=qupeng |  TASK [firewalld : enable firewalld ports] **********************************************************************************************************************************
2018-02-27 15:01:14,051 p=13247 u=qupeng |  TASK [firewalld : reload firewalld] ****************************************************************************************************************************************
2018-02-27 15:01:14,219 p=13247 u=qupeng |  TASK [firewalld : All enabled ports] ***************************************************************************************************************************************
2018-02-27 15:01:14,386 p=13247 u=qupeng |  TASK [firewalld : determine if firewalld is running] ***********************************************************************************************************************
2018-02-27 15:01:14,557 p=13247 u=qupeng |  TASK [firewalld : enable firewalld ports] **********************************************************************************************************************************
2018-02-27 15:01:14,742 p=13247 u=qupeng |  TASK [firewalld : reload firewalld] ****************************************************************************************************************************************
2018-02-27 15:01:14,905 p=13247 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 15:01:14,905 p=13247 u=qupeng |  172.16.21.1                : ok=50   changed=1    unreachable=0    failed=0   
2018-02-27 15:01:14,905 p=13247 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,905 p=13247 u=qupeng |  monitoring                 : ok=39   changed=2    unreachable=0    failed=0   
2018-02-27 15:01:14,906 p=13247 u=qupeng |  pd                         : ok=29   changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,906 p=13247 u=qupeng |  tidb                       : ok=29   changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,906 p=13247 u=qupeng |  tikv1                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,906 p=13247 u=qupeng |  tikv2                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,906 p=13247 u=qupeng |  tikv3                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,906 p=13247 u=qupeng |  tikv4                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,906 p=13247 u=qupeng |  tikv5                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:01:14,907 p=13247 u=qupeng |  Congrats! All goes well. :-)
2018-02-27 15:01:30,437 p=29267 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:01:30,453 p=29267 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:01:30,479 p=29267 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:01:30,507 p=29267 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:01:30,528 p=29267 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:01:30,553 p=29267 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:01:30,579 p=29267 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:01:30,658 p=29267 u=qupeng |  ok: [localhost]
2018-02-27 15:01:30,665 p=29267 u=qupeng |  PLAY [gather all facts, and check dest] ************************************************************************************************************************************
2018-02-27 15:01:30,686 p=29267 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:01:30,849 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:30,871 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:30,897 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:30,919 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:30,920 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:30,979 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:31,011 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:31,035 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:31,042 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:31,053 p=29267 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:01:36,724 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:36,784 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:37,253 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:37,301 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:37,362 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:42,213 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:42,564 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:42,893 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:43,045 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:43,076 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:01:44,041 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:44,054 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:44,067 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:44,081 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:44,083 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:44,800 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:44,809 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:44,842 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:44,849 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:44,857 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:01:44,963 p=29267 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:01:45,063 p=29267 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:01:45,167 p=29267 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:01:45,208 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:45,218 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:45,244 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:45,257 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:45,258 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:45,258 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:45,278 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:45,282 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:45,285 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:45,292 p=29267 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:01:45,393 p=29267 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:01:45,493 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:01:45,594 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:01:46,387 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:46,402 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:46,420 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:46,437 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:46,439 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:47,161 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:47,171 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:47,176 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:47,188 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:47,201 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:01:47,964 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:47,986 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:48,005 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:48,022 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:48,024 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:48,713 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:48,748 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:48,757 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:48,762 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:48,776 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:01:48,902 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:01:49,000 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:01:49,987 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:50,019 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:50,043 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:50,057 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:50,059 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:50,887 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:50,897 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:50,902 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:50,910 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:50,922 p=29267 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:01:51,031 p=29267 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:01:51,130 p=29267 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:01:52,025 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:52,048 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:52,070 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:52,089 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:52,091 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:52,857 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:52,908 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:52,929 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:52,949 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:52,957 p=29267 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:01:53,827 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:53,858 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:53,890 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:53,905 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:53,907 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:54,696 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:54,757 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:54,769 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:54,799 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:54,811 p=29267 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:01:54,852 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:54,863 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:54,884 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:54,896 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:54,909 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:54,910 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:54,916 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:54,932 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:54,934 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:54,942 p=29267 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:01:54,998 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:55,010 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:55,023 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:55,037 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:55,054 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:55,060 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:55,070 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:55,071 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:55,079 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:55,086 p=29267 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:01:55,141 p=29267 u=qupeng |  ok: [monitoring]
2018-02-27 15:01:55,152 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:55,166 p=29267 u=qupeng |  ok: [pd]
2018-02-27 15:01:55,177 p=29267 u=qupeng |  ok: [tidb]
2018-02-27 15:01:55,186 p=29267 u=qupeng |  ok: [tikv2]
2018-02-27 15:01:55,190 p=29267 u=qupeng |  ok: [tikv3]
2018-02-27 15:01:55,193 p=29267 u=qupeng |  ok: [tikv1]
2018-02-27 15:01:55,209 p=29267 u=qupeng |  ok: [tikv4]
2018-02-27 15:01:55,222 p=29267 u=qupeng |  ok: [tikv5]
2018-02-27 15:01:55,229 p=29267 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:01:55,236 p=29267 u=qupeng |  TASK [start node_exporter by supervise] ************************************************************************************************************************************
2018-02-27 15:01:56,151 p=29267 u=qupeng |  changed: [172.16.21.1] => (item=node_exporter)
2018-02-27 15:01:56,165 p=29267 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:01:56,198 p=29267 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:01:56,235 p=29267 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:01:58,103 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:01:58,111 p=29267 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:01:58,125 p=29267 u=qupeng |  TASK [start blackbox_exporter by supervise] ********************************************************************************************************************************
2018-02-27 15:01:59,088 p=29267 u=qupeng |  changed: [172.16.21.1] => (item=blackbox_exporter)
2018-02-27 15:01:59,103 p=29267 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:01:59,138 p=29267 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:01:59,175 p=29267 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:02:00,864 p=29267 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:02:00,874 p=29267 u=qupeng |  PLAY [monitoring_servers] **************************************************************************************************************************************************
2018-02-27 15:02:00,889 p=29267 u=qupeng |  TASK [start monitoring modules by supervise] *******************************************************************************************************************************
2018-02-27 15:02:01,845 p=29267 u=qupeng |  changed: [monitoring] => (item=pushgateway)
2018-02-27 15:02:02,776 p=29267 u=qupeng |  changed: [monitoring] => (item=prometheus)
2018-02-27 15:02:02,790 p=29267 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:02:02,828 p=29267 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:02:02,872 p=29267 u=qupeng |  TASK [wait pushgateway up] *************************************************************************************************************************************************
2018-02-27 15:07:03,981 p=29267 u=qupeng |  fatal: [monitoring]: FAILED! => {"changed": false, "elapsed": 300, "msg": "Timeout when waiting for search string 200 OK in 172.16.21.1:70011"}
2018-02-27 15:07:03,982 fail [monitoring]: Ansible FAILED! => playbook: start.yml; TASK: wait pushgateway up; message: {"changed": false, "elapsed": 300, "msg": "Timeout when waiting for search string 200 OK in 172.16.21.1:70011"}
2018-02-27 15:07:03,984 p=29267 u=qupeng |  	to retry, use: --limit @/home/qupeng/ansible/tidb-ansible/retry_files/start.retry

2018-02-27 15:07:03,984 p=29267 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 15:07:03,985 p=29267 u=qupeng |  172.16.21.1                : ok=16   changed=2    unreachable=0    failed=0   
2018-02-27 15:07:03,985 p=29267 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,985 p=29267 u=qupeng |  monitoring                 : ok=13   changed=1    unreachable=0    failed=1   
2018-02-27 15:07:03,986 p=29267 u=qupeng |  pd                         : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,986 p=29267 u=qupeng |  tidb                       : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,986 p=29267 u=qupeng |  tikv1                      : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,986 p=29267 u=qupeng |  tikv2                      : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,986 p=29267 u=qupeng |  tikv3                      : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,987 p=29267 u=qupeng |  tikv4                      : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,987 p=29267 u=qupeng |  tikv5                      : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:07:03,987 p=29267 u=qupeng |  ERROR MESSAGE SUMMARY ******************************************************************************************************************************************************
2018-02-27 15:07:03,988 p=29267 u=qupeng |  [monitoring]: Ansible FAILED! => playbook: start.yml; TASK: wait pushgateway up; message: {"changed": false, "elapsed": 300, "msg": "Timeout when waiting for search string 200 OK in 172.16.21.1:70011"}

2018-02-27 15:07:03,988 p=29267 u=qupeng |  Ask for help:
2018-02-27 15:07:03,988 p=29267 u=qupeng |  Contact us: sre@pingcap.com
2018-02-27 15:07:03,988 p=29267 u=qupeng |  It seems that you encounter some problems. You can send an email to the above email address, attached with the tidb-ansible/inventory.ini and tidb-ansible/log/ansible.log files and the error message, or new issue on https://github.com/pingcap/tidb-ansible/issues. We'll try our best to help you deploy a TiDB cluster. Thanks. :-)
2018-02-27 15:08:49,559 p=53765 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:08:49,579 p=53765 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:08:49,607 p=53765 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:08:49,633 p=53765 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:08:49,653 p=53765 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:08:49,676 p=53765 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:08:49,699 p=53765 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:08:49,775 p=53765 u=qupeng |  ok: [localhost]
2018-02-27 15:08:49,782 p=53765 u=qupeng |  PLAY [gather all facts, and check dest] ************************************************************************************************************************************
2018-02-27 15:08:49,804 p=53765 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:08:49,969 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:08:49,990 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:08:50,008 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:08:50,023 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:08:50,024 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:08:50,094 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:08:50,113 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:08:50,122 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:08:50,155 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:08:50,164 p=53765 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:08:55,921 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:08:55,971 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:08:56,275 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:08:57,051 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:08:57,228 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:01,886 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:02,524 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:02,596 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:02,742 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:02,772 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:09:03,672 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:09:03,685 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:03,697 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:03,710 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:03,715 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:09:04,415 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:04,457 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:04,475 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:04,484 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:04,492 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:09:04,599 p=53765 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:09:04,699 p=53765 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:09:04,802 p=53765 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:09:04,851 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:04,862 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:04,875 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:09:04,888 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:09:04,889 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:04,889 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:04,905 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:04,909 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:04,923 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:04,931 p=53765 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:09:05,042 p=53765 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:09:05,149 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:09:05,256 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:09:06,034 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:06,057 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:09:06,077 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:09:06,094 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:06,096 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:06,777 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:06,779 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:06,801 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:06,823 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:06,832 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:09:07,604 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:09:07,618 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:07,633 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:07,646 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:07,648 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:09:08,368 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:08,375 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:08,376 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:08,405 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:08,419 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:09:08,555 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:09:08,673 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:09:09,707 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:09:09,735 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:09,752 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:09:09,766 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:09,768 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:10,580 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:10,602 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:10,607 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:10,616 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:10,626 p=53765 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:09:10,738 p=53765 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:09:10,841 p=53765 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:09:11,746 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:11,767 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:11,787 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:09:11,804 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:11,806 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:09:12,613 p=53765 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:12,637 p=53765 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:12,641 p=53765 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:12,674 p=53765 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:12,689 p=53765 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:09:13,528 p=53765 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:13,584 p=53765 u=qupeng |  ok: [pd]
2018-02-27 15:09:13,611 p=53765 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:13,629 p=53765 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:13,630 p=53765 u=qupeng |  ok: [tidb]
2018-02-27 15:09:14,098 p=53765 u=qupeng |   [ERROR]: User interrupted execution

2018-02-27 15:09:35,405 p=59784 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:09:35,424 p=59784 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:09:35,451 p=59784 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:09:35,475 p=59784 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:09:35,493 p=59784 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:09:35,516 p=59784 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:09:35,541 p=59784 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:09:35,609 p=59784 u=qupeng |  ok: [localhost]
2018-02-27 15:09:35,617 p=59784 u=qupeng |  PLAY [gather all facts, and check dest] ************************************************************************************************************************************
2018-02-27 15:09:35,643 p=59784 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:09:35,807 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:35,823 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:35,838 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:35,853 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:35,854 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:35,938 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:35,952 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:35,969 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:35,973 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:35,982 p=59784 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:09:41,753 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:41,970 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:42,021 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:42,944 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:43,015 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:47,405 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:47,439 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:47,474 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:48,577 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:48,605 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:09:49,522 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:49,541 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:49,556 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:49,574 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:49,576 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:50,264 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:50,265 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:50,269 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:50,326 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:50,335 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:09:50,431 p=59784 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:09:50,538 p=59784 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:09:50,636 p=59784 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:09:50,677 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:50,688 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:50,698 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:50,720 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:50,721 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:50,721 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:50,725 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:50,752 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:50,761 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:50,773 p=59784 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:09:50,885 p=59784 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:09:50,983 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:09:51,078 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:09:51,830 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:51,868 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:51,887 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:51,903 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:51,904 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:52,575 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:52,604 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:52,650 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:52,663 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:52,674 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:09:53,387 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:53,402 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:53,429 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:53,463 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:53,465 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:54,129 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:54,130 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:54,144 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:54,221 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:54,237 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:09:54,380 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:09:54,486 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:09:55,501 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:55,524 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:55,544 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:55,561 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:55,563 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:56,317 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:56,388 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:56,432 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:56,435 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:56,443 p=59784 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:09:56,553 p=59784 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:09:56,659 p=59784 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:09:57,551 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:57,575 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:57,595 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:57,614 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:09:57,617 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:58,410 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:09:58,449 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:09:58,468 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:09:58,497 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:09:58,511 p=59784 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:09:59,401 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:09:59,434 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:09:59,450 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:09:59,463 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:09:59,464 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:10:00,220 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:10:00,228 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:10:00,301 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:10:00,329 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:10:00,338 p=59784 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:10:00,393 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:10:00,404 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:10:00,415 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:10:00,428 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:10:00,429 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:10:00,430 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:10:00,449 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:10:00,452 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:10:00,464 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:10:00,475 p=59784 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:10:00,532 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:10:00,578 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:10:00,591 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:10:00,602 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:10:00,603 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:10:00,604 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:10:00,618 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:10:00,639 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:10:00,646 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:10:00,653 p=59784 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:10:00,705 p=59784 u=qupeng |  ok: [monitoring]
2018-02-27 15:10:00,718 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:10:00,730 p=59784 u=qupeng |  ok: [tidb]
2018-02-27 15:10:00,747 p=59784 u=qupeng |  ok: [pd]
2018-02-27 15:10:00,748 p=59784 u=qupeng |  ok: [tikv2]
2018-02-27 15:10:00,758 p=59784 u=qupeng |  ok: [tikv1]
2018-02-27 15:10:00,763 p=59784 u=qupeng |  ok: [tikv3]
2018-02-27 15:10:00,769 p=59784 u=qupeng |  ok: [tikv4]
2018-02-27 15:10:00,797 p=59784 u=qupeng |  ok: [tikv5]
2018-02-27 15:10:00,803 p=59784 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:10:00,810 p=59784 u=qupeng |  TASK [start node_exporter by supervise] ************************************************************************************************************************************
2018-02-27 15:10:01,683 p=59784 u=qupeng |  changed: [172.16.21.1] => (item=node_exporter)
2018-02-27 15:10:01,690 p=59784 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:10:01,717 p=59784 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:10:01,749 p=59784 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:10:03,635 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:10:03,642 p=59784 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:10:03,652 p=59784 u=qupeng |  TASK [start blackbox_exporter by supervise] ********************************************************************************************************************************
2018-02-27 15:10:04,594 p=59784 u=qupeng |  changed: [172.16.21.1] => (item=blackbox_exporter)
2018-02-27 15:10:04,604 p=59784 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:10:04,635 p=59784 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:10:04,662 p=59784 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:10:06,339 p=59784 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:10:06,347 p=59784 u=qupeng |  PLAY [monitoring_servers] **************************************************************************************************************************************************
2018-02-27 15:10:06,360 p=59784 u=qupeng |  TASK [start monitoring modules by supervise] *******************************************************************************************************************************
2018-02-27 15:10:07,297 p=59784 u=qupeng |  changed: [monitoring] => (item=pushgateway)
2018-02-27 15:10:08,207 p=59784 u=qupeng |  changed: [monitoring] => (item=prometheus)
2018-02-27 15:10:08,218 p=59784 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:10:08,262 p=59784 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:10:08,298 p=59784 u=qupeng |  TASK [wait pushgateway up] *************************************************************************************************************************************************
2018-02-27 15:12:13,496 p=59784 u=qupeng |   [ERROR]: User interrupted execution

2018-02-27 15:13:34,152 p=75932 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:13:34,166 p=75932 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:13:34,192 p=75932 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:13:34,219 p=75932 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:13:34,239 p=75932 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:13:34,263 p=75932 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:13:34,288 p=75932 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:13:34,355 p=75932 u=qupeng |  ok: [localhost]
2018-02-27 15:13:34,362 p=75932 u=qupeng |  PLAY [gather all facts, and check dest] ************************************************************************************************************************************
2018-02-27 15:13:34,389 p=75932 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:13:34,544 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:34,574 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:34,599 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:34,618 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:34,620 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:34,668 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:34,699 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:34,730 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:34,748 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:34,760 p=75932 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:13:40,664 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:40,887 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:41,122 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:41,818 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:41,867 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:46,155 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:46,508 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:46,661 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:47,705 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:47,734 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:13:48,683 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:48,701 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:48,716 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:48,739 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:48,743 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:49,377 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:49,414 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:49,426 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:49,469 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:49,482 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:13:49,624 p=75932 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:13:49,760 p=75932 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:13:49,910 p=75932 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:13:49,969 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:49,983 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:49,995 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:50,007 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:50,008 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:50,013 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:50,016 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:50,034 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:50,035 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:50,042 p=75932 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:13:50,145 p=75932 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:13:50,261 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:13:50,401 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:13:51,178 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:51,203 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:51,220 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:51,235 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:51,236 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:51,913 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:51,930 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:51,969 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:51,995 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:52,003 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:13:52,756 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:52,776 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:52,793 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:52,809 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:52,811 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:53,538 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:53,541 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:53,555 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:53,564 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:53,576 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:13:53,710 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:13:53,815 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:13:54,821 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:54,837 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:54,852 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:54,866 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:54,887 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:55,688 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:55,692 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:55,718 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:55,763 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:55,771 p=75932 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:13:55,888 p=75932 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:13:56,004 p=75932 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:13:56,919 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:56,938 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:56,957 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:56,972 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:56,974 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:57,787 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:57,799 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:57,814 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:57,832 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:57,840 p=75932 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:13:58,679 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:58,706 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:58,725 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:58,745 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:58,790 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:59,564 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:59,568 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:59,588 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:59,611 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:59,622 p=75932 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:13:59,663 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:59,687 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:59,700 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:59,714 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:59,726 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:59,727 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:59,730 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:59,741 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:59,751 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:59,758 p=75932 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:13:59,813 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:59,825 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:59,849 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:13:59,863 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:13:59,864 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:13:59,865 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:13:59,874 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:13:59,898 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:13:59,903 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:13:59,911 p=75932 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:13:59,966 p=75932 u=qupeng |  ok: [tidb]
2018-02-27 15:13:59,979 p=75932 u=qupeng |  ok: [tikv1]
2018-02-27 15:13:59,992 p=75932 u=qupeng |  ok: [tikv2]
2018-02-27 15:14:00,009 p=75932 u=qupeng |  ok: [tikv5]
2018-02-27 15:14:00,011 p=75932 u=qupeng |  ok: [tikv3]
2018-02-27 15:14:00,022 p=75932 u=qupeng |  ok: [tikv4]
2018-02-27 15:14:00,024 p=75932 u=qupeng |  ok: [pd]
2018-02-27 15:14:00,036 p=75932 u=qupeng |  ok: [monitoring]
2018-02-27 15:14:00,048 p=75932 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:14:00,053 p=75932 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:14:00,062 p=75932 u=qupeng |  TASK [start node_exporter by supervise] ************************************************************************************************************************************
2018-02-27 15:14:00,841 p=75932 u=qupeng |  failed: [tidb] (item=node_exporter) => {"changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tidb/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.120133", "end": "2018-02-27 15:14:00.808382", "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.688249", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}
2018-02-27 15:14:00,843 fail [tidb]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tidb/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.120133", "end": "2018-02-27 15:14:00.808382", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tidb/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.688249", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}
2018-02-27 15:14:00,856 p=75932 u=qupeng |  failed: [tikv1] (item=node_exporter) => {"changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv1/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.097127", "end": "2018-02-27 15:14:00.821175", "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.724048", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}
2018-02-27 15:14:00,857 fail [tikv1]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv1/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.097127", "end": "2018-02-27 15:14:00.821175", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv1/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.724048", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}
2018-02-27 15:14:00,877 p=75932 u=qupeng |  failed: [tikv4] (item=node_exporter) => {"changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv4/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.131915", "end": "2018-02-27 15:14:00.858252", "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.726337", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}
2018-02-27 15:14:00,879 fail [tikv4]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv4/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.131915", "end": "2018-02-27 15:14:00.858252", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv4/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.726337", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}
2018-02-27 15:14:00,880 p=75932 u=qupeng |  failed: [tikv2] (item=node_exporter) => {"changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv2/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.142260", "end": "2018-02-27 15:14:00.860885", "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.718625", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}
2018-02-27 15:14:00,881 fail [tikv2]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv2/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.142260", "end": "2018-02-27 15:14:00.860885", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv2/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.718625", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}
2018-02-27 15:14:00,894 p=75932 u=qupeng |  failed: [tikv3] (item=node_exporter) => {"changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv3/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.139678", "end": "2018-02-27 15:14:00.876475", "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.736797", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}
2018-02-27 15:14:00,895 fail [tikv3]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv3/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.139678", "end": "2018-02-27 15:14:00.876475", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv3/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.736797", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}
2018-02-27 15:14:01,598 p=75932 u=qupeng |  failed: [tikv5] (item=node_exporter) => {"changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv5/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.086808", "end": "2018-02-27 15:14:01.574690", "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:01.487882", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}
2018-02-27 15:14:01,600 fail [tikv5]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv5/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.086808", "end": "2018-02-27 15:14:01.574690", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv5/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:01.487882", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}
2018-02-27 15:14:01,651 p=75932 u=qupeng |  failed: [pd] (item=node_exporter) => {"changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/pd/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.127187", "end": "2018-02-27 15:14:01.624765", "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:01.497578", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}
2018-02-27 15:14:01,652 fail [pd]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/pd/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.127187", "end": "2018-02-27 15:14:01.624765", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/pd/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:01.497578", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}
2018-02-27 15:14:01,654 p=75932 u=qupeng |  	to retry, use: --limit @/home/qupeng/ansible/tidb-ansible/retry_files/start.retry

2018-02-27 15:14:01,654 p=75932 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 15:14:01,654 p=75932 u=qupeng |  172.16.21.1                : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:14:01,654 p=75932 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 15:14:01,654 p=75932 u=qupeng |  monitoring                 : ok=12   changed=0    unreachable=0    failed=0   
2018-02-27 15:14:01,654 p=75932 u=qupeng |  pd                         : ok=12   changed=0    unreachable=0    failed=1   
2018-02-27 15:14:01,655 p=75932 u=qupeng |  tidb                       : ok=12   changed=0    unreachable=0    failed=1   
2018-02-27 15:14:01,655 p=75932 u=qupeng |  tikv1                      : ok=12   changed=0    unreachable=0    failed=1   
2018-02-27 15:14:01,655 p=75932 u=qupeng |  tikv2                      : ok=12   changed=0    unreachable=0    failed=1   
2018-02-27 15:14:01,655 p=75932 u=qupeng |  tikv3                      : ok=12   changed=0    unreachable=0    failed=1   
2018-02-27 15:14:01,655 p=75932 u=qupeng |  tikv4                      : ok=12   changed=0    unreachable=0    failed=1   
2018-02-27 15:14:01,655 p=75932 u=qupeng |  tikv5                      : ok=12   changed=0    unreachable=0    failed=1   
2018-02-27 15:14:01,655 p=75932 u=qupeng |  ERROR MESSAGE SUMMARY ******************************************************************************************************************************************************
2018-02-27 15:14:01,656 p=75932 u=qupeng |  [tidb]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tidb/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.120133", "end": "2018-02-27 15:14:00.808382", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tidb/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.688249", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}

2018-02-27 15:14:01,656 p=75932 u=qupeng |  [tikv1]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv1/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.097127", "end": "2018-02-27 15:14:00.821175", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv1/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.724048", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}

2018-02-27 15:14:01,656 p=75932 u=qupeng |  [tikv4]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv4/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.131915", "end": "2018-02-27 15:14:00.858252", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv4/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.726337", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}

2018-02-27 15:14:01,656 p=75932 u=qupeng |  [tikv2]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv2/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.142260", "end": "2018-02-27 15:14:00.860885", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv2/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.718625", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}

2018-02-27 15:14:01,656 p=75932 u=qupeng |  [tikv3]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv3/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.139678", "end": "2018-02-27 15:14:00.876475", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv3/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:00.736797", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}

2018-02-27 15:14:01,656 p=75932 u=qupeng |  [tikv5]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/tikv5/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.086808", "end": "2018-02-27 15:14:01.574690", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/tikv5/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:01.487882", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}

2018-02-27 15:14:01,657 p=75932 u=qupeng |  [pd]: Ansible FAILED! => playbook: start.yml; TASK: start node_exporter by supervise; message: {"changed": true, "msg": "All items completed", "results": [{"_ansible_item_result": true, "_ansible_no_log": false, "_ansible_parsed": true, "changed": true, "cmd": "cd /data3/qupeng/raftstore-learner/pd/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "delta": "0:00:00.127187", "end": "2018-02-27 15:14:01.624765", "failed": true, "invocation": {"module_args": {"_raw_params": "cd /data3/qupeng/raftstore-learner/pd/scripts && (./stop_node_exporter.sh; ./start_node_exporter.sh)", "_uses_shell": true, "chdir": null, "creates": null, "executable": null, "removes": null, "stdin": null, "warn": true}}, "item": "node_exporter", "msg": "non-zero return code", "rc": 127, "start": "2018-02-27 15:14:01.497578", "stderr": "/bin/sh: ./stop_node_exporter.sh: \n/bin/sh: ./start_node_exporter.sh: ", "stderr_lines": ["/bin/sh: ./stop_node_exporter.sh: ", "/bin/sh: ./start_node_exporter.sh: "], "stdout": "", "stdout_lines": []}]}

2018-02-27 15:14:01,657 p=75932 u=qupeng |  Ask for help:
2018-02-27 15:14:01,657 p=75932 u=qupeng |  Contact us: sre@pingcap.com
2018-02-27 15:14:01,657 p=75932 u=qupeng |  It seems that you encounter some problems. You can send an email to the above email address, attached with the tidb-ansible/inventory.ini and tidb-ansible/log/ansible.log files and the error message, or new issue on https://github.com/pingcap/tidb-ansible/issues. We'll try our best to help you deploy a TiDB cluster. Thanks. :-)
2018-02-27 15:15:36,108 p=86106 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:15:36,126 p=86106 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:15:36,155 p=86106 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:15:36,179 p=86106 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:15:36,198 p=86106 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:15:36,220 p=86106 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:15:36,241 p=86106 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:15:36,312 p=86106 u=qupeng |  ok: [localhost]
2018-02-27 15:15:36,320 p=86106 u=qupeng |  PLAY [initializing deployment target] **************************************************************************************************************************************
2018-02-27 15:15:36,346 p=86106 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:15:36,494 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:36,519 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:36,538 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:36,555 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:36,556 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:36,644 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:36,649 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:36,665 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:36,689 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:36,698 p=86106 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:15:42,462 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:42,559 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:42,684 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:42,796 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:43,549 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:47,950 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:48,128 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:48,376 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:49,041 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:49,069 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:15:50,016 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:50,033 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:50,048 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:50,065 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:50,066 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:50,737 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:50,752 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:50,777 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:50,780 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:50,791 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:15:50,930 p=86106 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:15:51,059 p=86106 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:15:51,197 p=86106 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:15:51,240 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:51,254 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:51,271 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:51,299 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:51,314 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:51,315 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:51,329 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:51,337 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:51,344 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:51,355 p=86106 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:15:51,485 p=86106 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:15:51,619 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:15:51,763 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:15:52,463 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:52,537 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:52,552 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:52,565 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:52,567 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:53,225 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:53,279 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:53,300 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:53,342 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:53,352 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:15:54,068 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:54,088 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:54,113 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:54,135 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:54,146 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:54,767 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:54,843 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:54,867 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:54,868 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:54,878 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:15:55,022 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:15:55,165 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:15:56,178 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:56,206 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:56,226 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:56,245 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:56,247 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:56,982 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:57,078 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:57,080 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:57,082 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:57,098 p=86106 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:15:57,235 p=86106 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:15:57,357 p=86106 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:15:58,177 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:15:58,216 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:15:58,264 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:15:58,280 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:15:58,282 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:15:59,019 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:15:59,092 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:15:59,129 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:15:59,146 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:15:59,157 p=86106 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:16:00,047 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:16:00,073 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:16:00,093 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:00,109 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:16:00,111 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:16:00,917 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:16:00,934 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:16:00,953 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:16:01,079 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:16:01,095 p=86106 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:16:01,148 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:16:01,163 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:01,179 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:16:01,195 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:16:01,210 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:16:01,225 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:16:01,227 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:16:01,233 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:16:01,254 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:16:01,264 p=86106 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:16:01,318 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:16:01,357 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:01,371 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:16:01,383 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:16:01,384 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:16:01,388 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:16:01,407 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:16:01,410 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:16:01,433 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:16:01,442 p=86106 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:16:01,494 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:16:01,508 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:01,537 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:16:01,553 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:16:01,554 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:16:01,560 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:16:01,568 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:16:01,581 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:16:01,599 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:16:01,608 p=86106 u=qupeng |  PLAY [deploying monitoring agent] ******************************************************************************************************************************************
2018-02-27 15:16:01,623 p=86106 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:16:02,416 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/scripts)
2018-02-27 15:16:03,107 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:16:03,800 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/backup)
2018-02-27 15:16:03,812 p=86106 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:16:03,854 p=86106 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:16:04,533 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/bin)
2018-02-27 15:16:04,548 p=86106 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:16:04,589 p=86106 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 15:16:04,637 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/binary_deployment.yml for pd
2018-02-27 15:16:04,646 p=86106 u=qupeng |  TASK [node_exporter : create deploy directories] ***************************************************************************************************************************
2018-02-27 15:16:05,378 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 15:16:05,392 p=86106 u=qupeng |  TASK [node_exporter : deploy node_exporter binary] *************************************************************************************************************************
2018-02-27 15:16:07,675 p=86106 u=qupeng |  changed: [pd]
2018-02-27 15:16:07,695 p=86106 u=qupeng |  TASK [node_exporter : create run script] ***********************************************************************************************************************************
2018-02-27 15:16:09,011 p=86106 u=qupeng |  changed: [pd] => (item=run)
2018-02-27 15:16:09,027 p=86106 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 15:16:09,070 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/supervise_deployment.yml for pd
2018-02-27 15:16:09,084 p=86106 u=qupeng |  TASK [node_exporter : deploy supervise] ************************************************************************************************************************************
2018-02-27 15:16:09,657 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:16:10,389 p=86106 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/node_exporter)
2018-02-27 15:16:10,397 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:16:11,780 p=86106 u=qupeng |  ok: [pd] => (item=supervise)
2018-02-27 15:16:13,222 p=86106 u=qupeng |  ok: [pd] => (item=svc)
2018-02-27 15:16:14,550 p=86106 u=qupeng |  ok: [pd] => (item=svstat)
2018-02-27 15:16:14,566 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:16:15,987 p=86106 u=qupeng |  changed: [pd] => (item=start)
2018-02-27 15:16:17,456 p=86106 u=qupeng |  changed: [pd] => (item=stop)
2018-02-27 15:16:17,467 p=86106 u=qupeng |  TASK [node_exporter : prepare firewalld white list] ************************************************************************************************************************
2018-02-27 15:16:17,583 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:16:17,600 p=86106 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 15:16:17,637 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/binary_deployment.yml for pd
2018-02-27 15:16:17,644 p=86106 u=qupeng |  TASK [blackbox_exporter : create deploy directories] ***********************************************************************************************************************
2018-02-27 15:16:18,432 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 15:16:18,448 p=86106 u=qupeng |  TASK [blackbox_exporter : deploy blackbox_exporter binary] *****************************************************************************************************************
2018-02-27 15:16:20,811 p=86106 u=qupeng |  changed: [pd]
2018-02-27 15:16:20,826 p=86106 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 15:16:20,863 p=86106 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 15:16:21,723 p=86106 u=qupeng |  changed: [pd]
2018-02-27 15:16:21,736 p=86106 u=qupeng |  TASK [blackbox_exporter : create run script] *******************************************************************************************************************************
2018-02-27 15:16:23,102 p=86106 u=qupeng |  changed: [pd] => (item=run)
2018-02-27 15:16:23,117 p=86106 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 15:16:23,172 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/supervise_deployment.yml for pd
2018-02-27 15:16:23,184 p=86106 u=qupeng |  TASK [blackbox_exporter : deploy supervise] ********************************************************************************************************************************
2018-02-27 15:16:23,859 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:16:24,589 p=86106 u=qupeng |  changed: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/blackbox_exporter)
2018-02-27 15:16:24,605 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:16:26,055 p=86106 u=qupeng |  ok: [pd] => (item=supervise)
2018-02-27 15:16:27,489 p=86106 u=qupeng |  ok: [pd] => (item=svc)
2018-02-27 15:16:28,893 p=86106 u=qupeng |  ok: [pd] => (item=svstat)
2018-02-27 15:16:28,922 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:16:30,291 p=86106 u=qupeng |  changed: [pd] => (item=start)
2018-02-27 15:16:31,642 p=86106 u=qupeng |  changed: [pd] => (item=stop)
2018-02-27 15:16:31,659 p=86106 u=qupeng |  TASK [blackbox_exporter : create config file] ******************************************************************************************************************************
2018-02-27 15:16:32,999 p=86106 u=qupeng |  changed: [pd]
2018-02-27 15:16:33,014 p=86106 u=qupeng |  TASK [blackbox_exporter : backup conf file] ********************************************************************************************************************************
2018-02-27 15:16:33,056 p=86106 u=qupeng |  TASK [blackbox_exporter : prepare firewalld white list] ********************************************************************************************************************
2018-02-27 15:16:33,103 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:16:33,114 p=86106 u=qupeng |  PLAY [deploying monitoring server] *****************************************************************************************************************************************
2018-02-27 15:16:33,135 p=86106 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:16:33,800 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 15:16:34,480 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 15:16:35,152 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 15:16:35,167 p=86106 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:16:35,213 p=86106 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:16:35,918 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 15:16:35,931 p=86106 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:16:35,967 p=86106 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 15:16:36,007 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/binary_deployment.yml for monitoring
2018-02-27 15:16:36,018 p=86106 u=qupeng |  TASK [pushgateway : create deploy directories] *****************************************************************************************************************************
2018-02-27 15:16:36,724 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:16:36,735 p=86106 u=qupeng |  TASK [pushgateway : deploy pushgateway binary] *****************************************************************************************************************************
2018-02-27 15:16:38,192 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:38,204 p=86106 u=qupeng |  TASK [pushgateway : create run script] *************************************************************************************************************************************
2018-02-27 15:16:39,608 p=86106 u=qupeng |  ok: [monitoring] => (item=run)
2018-02-27 15:16:39,623 p=86106 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 15:16:39,671 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/supervise_deployment.yml for monitoring
2018-02-27 15:16:39,686 p=86106 u=qupeng |  TASK [pushgateway : deploy supervise] **************************************************************************************************************************************
2018-02-27 15:16:40,400 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:16:41,173 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/pushgateway)
2018-02-27 15:16:41,187 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:16:42,636 p=86106 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 15:16:44,065 p=86106 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 15:16:45,439 p=86106 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 15:16:45,454 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:16:46,994 p=86106 u=qupeng |  ok: [monitoring] => (item=start)
2018-02-27 15:16:48,508 p=86106 u=qupeng |  ok: [monitoring] => (item=stop)
2018-02-27 15:16:48,526 p=86106 u=qupeng |  TASK [pushgateway : prepare firewalld white list] **************************************************************************************************************************
2018-02-27 15:16:48,588 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:48,604 p=86106 u=qupeng |  TASK [prometheus : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:16:49,316 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:16:50,002 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 15:16:50,780 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 15:16:50,800 p=86106 u=qupeng |  TASK [prometheus : get config file stat] ***********************************************************************************************************************************
2018-02-27 15:16:51,768 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:51,780 p=86106 u=qupeng |  TASK [prometheus : get alert conf stat] ************************************************************************************************************************************
2018-02-27 15:16:52,515 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:52,525 p=86106 u=qupeng |  TASK [prometheus : create configuration file if not exist] *****************************************************************************************************************
2018-02-27 15:16:54,227 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:16:54,243 p=86106 u=qupeng |  TASK [prometheus : copy alert rules file] **********************************************************************************************************************************
2018-02-27 15:16:55,980 p=86106 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 15:16:57,700 p=86106 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 15:16:59,278 p=86106 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 15:17:00,916 p=86106 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 15:17:02,515 p=86106 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 15:17:04,166 p=86106 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 15:17:05,866 p=86106 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 15:17:05,878 p=86106 u=qupeng |  TASK [prometheus : set alert rules label changes] **************************************************************************************************************************
2018-02-27 15:17:06,728 p=86106 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 15:17:07,405 p=86106 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 15:17:08,152 p=86106 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 15:17:08,875 p=86106 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 15:17:09,584 p=86106 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 15:17:10,287 p=86106 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 15:17:10,965 p=86106 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 15:17:10,980 p=86106 u=qupeng |  TASK [prometheus : create deploy data directory] ***************************************************************************************************************************
2018-02-27 15:17:11,708 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 15:17:11,731 p=86106 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 15:17:11,785 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/binary_deployment.yml for monitoring
2018-02-27 15:17:11,800 p=86106 u=qupeng |  TASK [prometheus : create deploy log directory] ****************************************************************************************************************************
2018-02-27 15:17:12,560 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:17:12,574 p=86106 u=qupeng |  TASK [prometheus : deploy prometheus binary] *******************************************************************************************************************************
2018-02-27 15:17:14,141 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:17:14,154 p=86106 u=qupeng |  TASK [prometheus : create run script] **************************************************************************************************************************************
2018-02-27 15:17:15,548 p=86106 u=qupeng |  ok: [monitoring] => (item=run)
2018-02-27 15:17:15,557 p=86106 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 15:17:15,599 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/supervise_deployment.yml for monitoring
2018-02-27 15:17:15,609 p=86106 u=qupeng |  TASK [prometheus : deploy supervise] ***************************************************************************************************************************************
2018-02-27 15:17:16,309 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:17:17,051 p=86106 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 15:17:17,066 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:17:18,489 p=86106 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 15:17:19,912 p=86106 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 15:17:21,291 p=86106 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 15:17:21,308 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:17:22,771 p=86106 u=qupeng |  ok: [monitoring] => (item=start)
2018-02-27 15:17:24,139 p=86106 u=qupeng |  ok: [monitoring] => (item=stop)
2018-02-27 15:17:24,155 p=86106 u=qupeng |  TASK [prometheus : prepare firewalld white list] ***************************************************************************************************************************
2018-02-27 15:17:24,206 p=86106 u=qupeng |  ok: [monitoring]
2018-02-27 15:17:24,214 p=86106 u=qupeng |  PLAY [deploying grafana] ***************************************************************************************************************************************************
2018-02-27 15:17:24,230 p=86106 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:17:24,957 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 15:17:25,736 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 15:17:26,453 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 15:17:26,468 p=86106 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:17:26,510 p=86106 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:17:27,292 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 15:17:27,307 p=86106 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:17:27,356 p=86106 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:17:27,398 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/tasks.yml for 172.16.21.1
2018-02-27 15:17:27,407 p=86106 u=qupeng |  TASK [grafana : create common deploy directories] **************************************************************************************************************************
2018-02-27 15:17:28,241 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:17:28,930 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/data.grafana)
2018-02-27 15:17:28,943 p=86106 u=qupeng |  TASK [grafana : push data source file] *************************************************************************************************************************************
2018-02-27 15:17:30,296 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:17:30,312 p=86106 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:17:30,366 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 15:17:30,380 p=86106 u=qupeng |  TASK [grafana : create binary deploy directories (1/2)] ********************************************************************************************************************
2018-02-27 15:17:31,125 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt)
2018-02-27 15:17:31,141 p=86106 u=qupeng |  TASK [grafana : deploy grafana binary] *************************************************************************************************************************************
2018-02-27 15:17:31,638 p=86106 u=qupeng |  TASK [grafana : rename grafana deploy dir] *********************************************************************************************************************************
2018-02-27 15:17:32,342 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:17:32,357 p=86106 u=qupeng |  TASK [grafana : create binary deploy directories (2/2)] ********************************************************************************************************************
2018-02-27 15:17:33,066 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/dashboards)
2018-02-27 15:17:33,801 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/plugins)
2018-02-27 15:17:33,819 p=86106 u=qupeng |  TASK [grafana : create grafana configuration file] *************************************************************************************************************************
2018-02-27 15:17:35,187 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:17:35,199 p=86106 u=qupeng |  TASK [grafana : create run script] *****************************************************************************************************************************************
2018-02-27 15:17:36,707 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=run)
2018-02-27 15:17:36,724 p=86106 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:17:36,771 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 15:17:36,786 p=86106 u=qupeng |  TASK [grafana : deploy supervise] ******************************************************************************************************************************************
2018-02-27 15:17:37,469 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:17:38,235 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/grafana)
2018-02-27 15:17:38,249 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:17:39,644 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 15:17:41,025 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 15:17:42,443 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 15:17:42,454 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:17:43,951 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=start)
2018-02-27 15:17:45,405 p=86106 u=qupeng |  ok: [172.16.21.1] => (item=stop)
2018-02-27 15:17:45,417 p=86106 u=qupeng |  TASK [grafana : prepare firewalld white list] ******************************************************************************************************************************
2018-02-27 15:17:45,473 p=86106 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:17:45,481 p=86106 u=qupeng |  PLAY [deploying PD cluster] ************************************************************************************************************************************************
2018-02-27 15:17:45,498 p=86106 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:17:46,247 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/scripts)
2018-02-27 15:17:46,928 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:17:47,606 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/backup)
2018-02-27 15:17:47,617 p=86106 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:17:47,654 p=86106 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:17:48,369 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/bin)
2018-02-27 15:17:48,383 p=86106 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:17:48,430 p=86106 u=qupeng |  TASK [pd : create deploy directories] **************************************************************************************************************************************
2018-02-27 15:17:49,148 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 15:17:49,794 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:17:50,572 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/data.pd)
2018-02-27 15:17:50,583 p=86106 u=qupeng |  TASK [pd : load customized config] *****************************************************************************************************************************************
2018-02-27 15:17:50,646 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:17:50,658 p=86106 u=qupeng |  TASK [pd : load default config] ********************************************************************************************************************************************
2018-02-27 15:17:50,720 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:17:50,730 p=86106 u=qupeng |  TASK [pd : generate metrics config] ****************************************************************************************************************************************
2018-02-27 15:17:50,810 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:17:50,817 p=86106 u=qupeng |  TASK [pd : generate final config] ******************************************************************************************************************************************
2018-02-27 15:17:50,877 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:17:50,885 p=86106 u=qupeng |  TASK [pd : debug] **********************************************************************************************************************************************************
2018-02-27 15:17:50,943 p=86106 u=qupeng |  ok: [pd] => {
    "pd_conf": {
        "global": {
            "lease": 3, 
            "tso-save-interval": "3s"
        }, 
        "log": {
            "file": {}, 
            "level": "info"
        }, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s"
        }, 
        "replication": {
            "location-labels": [], 
            "max-replicas": 3
        }, 
        "schedule": {
            "leader-schedule-limit": 64, 
            "max-pending-peer-count": 16, 
            "max-snapshot-count": 3, 
            "max-store-down-time": "1h", 
            "region-schedule-limit": 16, 
            "replica-schedule-limit": 24, 
            "tolerant-size-ratio": 2.5
        }, 
        "security": {
            "cacert-path": "", 
            "cert-path": "", 
            "key-path": ""
        }
    }
}
2018-02-27 15:17:50,950 p=86106 u=qupeng |  TASK [pd : create configuration file] **************************************************************************************************************************************
2018-02-27 15:17:52,454 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:17:52,469 p=86106 u=qupeng |  TASK [pd : backup conf file] ***********************************************************************************************************************************************
2018-02-27 15:17:52,506 p=86106 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 15:17:52,549 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/binary_deployment.yml for pd
2018-02-27 15:17:52,560 p=86106 u=qupeng |  TASK [pd : deploy binary] **************************************************************************************************************************************************
2018-02-27 15:17:54,242 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:17:54,253 p=86106 u=qupeng |  TASK [pd : backup bianry file] *********************************************************************************************************************************************
2018-02-27 15:17:54,289 p=86106 u=qupeng |  TASK [pd : create startup script] ******************************************************************************************************************************************
2018-02-27 15:17:55,854 p=86106 u=qupeng |  ok: [pd] => (item=run)
2018-02-27 15:17:55,868 p=86106 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 15:17:55,911 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/supervise_deployment.yml for pd
2018-02-27 15:17:55,925 p=86106 u=qupeng |  TASK [pd : deploy supervise] ***********************************************************************************************************************************************
2018-02-27 15:17:56,726 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:17:57,475 p=86106 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/pd)
2018-02-27 15:17:57,491 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:17:58,843 p=86106 u=qupeng |  ok: [pd] => (item=supervise)
2018-02-27 15:18:00,272 p=86106 u=qupeng |  ok: [pd] => (item=svc)
2018-02-27 15:18:01,600 p=86106 u=qupeng |  ok: [pd] => (item=svstat)
2018-02-27 15:18:01,618 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:18:03,011 p=86106 u=qupeng |  ok: [pd] => (item=start)
2018-02-27 15:18:04,461 p=86106 u=qupeng |  ok: [pd] => (item=stop)
2018-02-27 15:18:04,476 p=86106 u=qupeng |  TASK [pd : prepare firewalld white list] ***********************************************************************************************************************************
2018-02-27 15:18:04,515 p=86106 u=qupeng |  ok: [pd]
2018-02-27 15:18:04,522 p=86106 u=qupeng |  PLAY [deploying TiKV cluster] **********************************************************************************************************************************************
2018-02-27 15:18:04,538 p=86106 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:18:05,158 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/scripts)
2018-02-27 15:18:05,195 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/scripts)
2018-02-27 15:18:05,235 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/scripts)
2018-02-27 15:18:05,237 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/scripts)
2018-02-27 15:18:05,241 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/scripts)
2018-02-27 15:18:05,763 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 15:18:05,780 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 15:18:05,844 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 15:18:05,849 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 15:18:05,855 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 15:18:06,393 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/backup)
2018-02-27 15:18:06,412 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/backup)
2018-02-27 15:18:06,493 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/backup)
2018-02-27 15:18:06,497 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/backup)
2018-02-27 15:18:06,509 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/backup)
2018-02-27 15:18:06,522 p=86106 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:18:07,181 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status)
2018-02-27 15:18:07,202 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status)
2018-02-27 15:18:07,212 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status)
2018-02-27 15:18:07,222 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status)
2018-02-27 15:18:07,232 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status)
2018-02-27 15:18:07,247 p=86106 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:18:07,874 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/bin)
2018-02-27 15:18:07,892 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/bin)
2018-02-27 15:18:07,913 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/bin)
2018-02-27 15:18:07,919 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/bin)
2018-02-27 15:18:07,929 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/bin)
2018-02-27 15:18:07,939 p=86106 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:18:08,029 p=86106 u=qupeng |  TASK [tikv : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:18:08,667 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/log)
2018-02-27 15:18:08,686 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/log)
2018-02-27 15:18:08,701 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/log)
2018-02-27 15:18:08,729 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/log)
2018-02-27 15:18:08,731 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/log)
2018-02-27 15:18:09,258 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/data)
2018-02-27 15:18:09,284 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/data)
2018-02-27 15:18:09,286 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/data)
2018-02-27 15:18:09,315 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/data)
2018-02-27 15:18:09,360 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/data)
2018-02-27 15:18:09,872 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 15:18:09,880 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 15:18:09,894 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 15:18:09,916 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 15:18:09,968 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 15:18:09,982 p=86106 u=qupeng |  TASK [tikv : load customized config] ***************************************************************************************************************************************
2018-02-27 15:18:10,038 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:10,058 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:10,059 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:10,088 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:10,089 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:10,099 p=86106 u=qupeng |  TASK [tikv : load default config] ******************************************************************************************************************************************
2018-02-27 15:18:10,147 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:10,166 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:10,171 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:10,178 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:10,200 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:10,216 p=86106 u=qupeng |  TASK [tikv : generate metrics config] **************************************************************************************************************************************
2018-02-27 15:18:10,289 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:10,332 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:10,345 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:10,347 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:10,369 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:10,382 p=86106 u=qupeng |  TASK [tikv : generate final config] ****************************************************************************************************************************************
2018-02-27 15:18:10,438 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:10,465 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:10,470 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:10,479 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:10,510 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:10,520 p=86106 u=qupeng |  TASK [tikv : debug] ********************************************************************************************************************************************************
2018-02-27 15:18:10,591 p=86106 u=qupeng |  ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:18:10,593 p=86106 u=qupeng |  ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:18:10,609 p=86106 u=qupeng |  ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:18:10,612 p=86106 u=qupeng |  ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:18:10,627 p=86106 u=qupeng |  ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:70011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:18:10,637 p=86106 u=qupeng |  TASK [tikv : create config file] *******************************************************************************************************************************************
2018-02-27 15:18:11,925 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:11,945 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:11,959 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:12,009 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:12,040 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:12,051 p=86106 u=qupeng |  TASK [tikv : backup conf file] *********************************************************************************************************************************************
2018-02-27 15:18:12,137 p=86106 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 15:18:12,261 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 15:18:12,278 p=86106 u=qupeng |  TASK [tikv : deploy binary] ************************************************************************************************************************************************
2018-02-27 15:18:14,223 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:14,230 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:14,235 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:14,315 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:14,324 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:14,334 p=86106 u=qupeng |  TASK [tikv : backup bianry file] *******************************************************************************************************************************************
2018-02-27 15:18:14,417 p=86106 u=qupeng |  TASK [tikv : create run script] ********************************************************************************************************************************************
2018-02-27 15:18:15,752 p=86106 u=qupeng |  ok: [tikv1] => (item=run)
2018-02-27 15:18:15,756 p=86106 u=qupeng |  ok: [tikv2] => (item=run)
2018-02-27 15:18:15,822 p=86106 u=qupeng |  ok: [tikv4] => (item=run)
2018-02-27 15:18:15,829 p=86106 u=qupeng |  ok: [tikv5] => (item=run)
2018-02-27 15:18:15,835 p=86106 u=qupeng |  ok: [tikv3] => (item=run)
2018-02-27 15:18:15,852 p=86106 u=qupeng |  TASK [tikv : backup script file] *******************************************************************************************************************************************
2018-02-27 15:18:15,945 p=86106 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 15:18:16,050 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/supervise_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 15:18:16,062 p=86106 u=qupeng |  TASK [tikv : deploy supervise] *********************************************************************************************************************************************
2018-02-27 15:18:18,865 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:18:19,568 p=86106 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status/tikv)
2018-02-27 15:18:19,592 p=86106 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status/tikv)
2018-02-27 15:18:19,606 p=86106 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status/tikv)
2018-02-27 15:18:19,614 p=86106 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status/tikv)
2018-02-27 15:18:19,620 p=86106 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status/tikv)
2018-02-27 15:18:19,633 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:18:20,959 p=86106 u=qupeng |  ok: [tikv2] => (item=supervise)
2018-02-27 15:18:20,969 p=86106 u=qupeng |  ok: [tikv3] => (item=supervise)
2018-02-27 15:18:20,977 p=86106 u=qupeng |  ok: [tikv1] => (item=supervise)
2018-02-27 15:18:20,999 p=86106 u=qupeng |  ok: [tikv4] => (item=supervise)
2018-02-27 15:18:21,031 p=86106 u=qupeng |  ok: [tikv5] => (item=supervise)
2018-02-27 15:18:22,216 p=86106 u=qupeng |  ok: [tikv1] => (item=svc)
2018-02-27 15:18:22,219 p=86106 u=qupeng |  ok: [tikv2] => (item=svc)
2018-02-27 15:18:22,230 p=86106 u=qupeng |  ok: [tikv4] => (item=svc)
2018-02-27 15:18:22,236 p=86106 u=qupeng |  ok: [tikv3] => (item=svc)
2018-02-27 15:18:22,280 p=86106 u=qupeng |  ok: [tikv5] => (item=svc)
2018-02-27 15:18:23,537 p=86106 u=qupeng |  ok: [tikv4] => (item=svstat)
2018-02-27 15:18:23,538 p=86106 u=qupeng |  ok: [tikv3] => (item=svstat)
2018-02-27 15:18:23,539 p=86106 u=qupeng |  ok: [tikv1] => (item=svstat)
2018-02-27 15:18:23,564 p=86106 u=qupeng |  ok: [tikv5] => (item=svstat)
2018-02-27 15:18:23,570 p=86106 u=qupeng |  ok: [tikv2] => (item=svstat)
2018-02-27 15:18:23,582 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:18:24,897 p=86106 u=qupeng |  ok: [tikv2] => (item=start)
2018-02-27 15:18:24,919 p=86106 u=qupeng |  ok: [tikv1] => (item=start)
2018-02-27 15:18:24,953 p=86106 u=qupeng |  ok: [tikv3] => (item=start)
2018-02-27 15:18:24,967 p=86106 u=qupeng |  ok: [tikv5] => (item=start)
2018-02-27 15:18:24,991 p=86106 u=qupeng |  ok: [tikv4] => (item=start)
2018-02-27 15:18:26,140 p=86106 u=qupeng |  ok: [tikv2] => (item=stop)
2018-02-27 15:18:26,191 p=86106 u=qupeng |  ok: [tikv1] => (item=stop)
2018-02-27 15:18:26,194 p=86106 u=qupeng |  ok: [tikv3] => (item=stop)
2018-02-27 15:18:26,241 p=86106 u=qupeng |  ok: [tikv5] => (item=stop)
2018-02-27 15:18:26,271 p=86106 u=qupeng |  ok: [tikv4] => (item=stop)
2018-02-27 15:18:26,282 p=86106 u=qupeng |  TASK [tikv : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:18:26,343 p=86106 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:26,370 p=86106 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:26,379 p=86106 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:26,380 p=86106 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:26,419 p=86106 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:26,426 p=86106 u=qupeng |  PLAY [deploying TiDB cluster] **********************************************************************************************************************************************
2018-02-27 15:18:26,441 p=86106 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:18:26,488 p=86106 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:18:26,520 p=86106 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:18:26,557 p=86106 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:18:26,588 p=86106 u=qupeng |  TASK [pump : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:18:26,625 p=86106 u=qupeng |  TASK [pump : include] ******************************************************************************************************************************************************
2018-02-27 15:18:26,650 p=86106 u=qupeng |  TASK [pump : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:18:26,674 p=86106 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:18:27,391 p=86106 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/scripts)
2018-02-27 15:18:28,245 p=86106 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 15:18:28,947 p=86106 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/backup)
2018-02-27 15:18:28,960 p=86106 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:18:29,007 p=86106 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:18:29,891 p=86106 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/bin)
2018-02-27 15:18:29,922 p=86106 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:18:29,977 p=86106 u=qupeng |  TASK [tidb : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:18:30,884 p=86106 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/log)
2018-02-27 15:18:31,572 p=86106 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 15:18:31,586 p=86106 u=qupeng |  TASK [tidb : load customized config] ***************************************************************************************************************************************
2018-02-27 15:18:31,638 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:18:31,650 p=86106 u=qupeng |  TASK [tidb : load default config] ******************************************************************************************************************************************
2018-02-27 15:18:31,700 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:18:31,716 p=86106 u=qupeng |  TASK [tidb : generate metrics config] **************************************************************************************************************************************
2018-02-27 15:18:31,798 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:18:31,812 p=86106 u=qupeng |  TASK [tidb : combine final config] *****************************************************************************************************************************************
2018-02-27 15:18:31,859 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:18:31,873 p=86106 u=qupeng |  TASK [tidb : debug] ********************************************************************************************************************************************************
2018-02-27 15:18:31,929 p=86106 u=qupeng |  ok: [tidb] => {
    "tidb_conf": {
        "global": {
            "enable-chunk": true, 
            "host": "0.0.0.0", 
            "lease": "10s", 
            "run-ddl": true, 
            "split-table": true, 
            "store": "tikv"
        }, 
        "log": {
            "disable-timestamp": false, 
            "file": {
                "log-rotate": true
            }, 
            "format": "text", 
            "level": "info", 
            "query-log-max-len": 2048, 
            "slow-threshold": 300
        }, 
        "opentracing": {
            "enable": false, 
            "reporter": {
                "buffer-flush-interval": 0, 
                "local-agent-host-port": "", 
                "log-spans": false, 
                "queue-size": 0
            }, 
            "rpc-metrics": false, 
            "sampler": {
                "max-operations": 0, 
                "param": 1.0, 
                "sampling-refresh-interval": 0, 
                "sampling-server-url": "", 
                "type": "const"
            }
        }, 
        "performance": {
            "cross-join": true, 
            "join-concurrency": 5, 
            "max-procs": 0, 
            "retry-limit": 10, 
            "run-auto-analyze": true, 
            "stats-lease": "3s", 
            "tcp-keep-alive": true
        }, 
        "plan_cache": {
            "capacity": 2560, 
            "enabled": false, 
            "shards": 256
        }, 
        "prepared_plan_cache": {
            "capacity": 100, 
            "enabled": false
        }, 
        "proxy_protocol": {
            "header-timeout": 5, 
            "networks": ""
        }, 
        "security": {
            "cluster-ssl-ca": "", 
            "cluster-ssl-cert": "", 
            "cluster-ssl-key": "", 
            "ssl-ca": "", 
            "ssl-cert": "", 
            "ssl-key": ""
        }, 
        "status": {
            "metrics-addr": "172.16.21.1:70011", 
            "metrics-interval": 15, 
            "report-status": true
        }, 
        "tikv_client": {
            "grpc-connection-count": 16
        }, 
        "xprotocol": {
            "xhost": "0.0.0.0", 
            "xport": 14000, 
            "xserver": false, 
            "xsocket": ""
        }
    }
}
2018-02-27 15:18:31,940 p=86106 u=qupeng |  TASK [tidb : create config file] *******************************************************************************************************************************************
2018-02-27 15:18:33,409 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:18:33,419 p=86106 u=qupeng |  TASK [tidb : backup conf file] *********************************************************************************************************************************************
2018-02-27 15:18:33,450 p=86106 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 15:18:33,496 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/binary_deployment.yml for tidb
2018-02-27 15:18:33,508 p=86106 u=qupeng |  TASK [tidb : deploy binary] ************************************************************************************************************************************************
2018-02-27 15:18:35,041 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:18:35,048 p=86106 u=qupeng |  TASK [tidb : backup binary file] *******************************************************************************************************************************************
2018-02-27 15:18:35,080 p=86106 u=qupeng |  TASK [tidb : create run script] ********************************************************************************************************************************************
2018-02-27 15:18:36,581 p=86106 u=qupeng |  ok: [tidb] => (item=run)
2018-02-27 15:18:36,596 p=86106 u=qupeng |  TASK [tidb : backup script file] *******************************************************************************************************************************************
2018-02-27 15:18:36,633 p=86106 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 15:18:36,668 p=86106 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/supervise_deployment.yml for tidb
2018-02-27 15:18:36,677 p=86106 u=qupeng |  TASK [tidb : deploy supervise] *********************************************************************************************************************************************
2018-02-27 15:18:37,247 p=86106 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:18:37,986 p=86106 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/status/tidb)
2018-02-27 15:18:38,002 p=86106 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:18:39,452 p=86106 u=qupeng |  ok: [tidb] => (item=supervise)
2018-02-27 15:18:40,939 p=86106 u=qupeng |  ok: [tidb] => (item=svc)
2018-02-27 15:18:42,354 p=86106 u=qupeng |  ok: [tidb] => (item=svstat)
2018-02-27 15:18:42,367 p=86106 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:18:43,768 p=86106 u=qupeng |  ok: [tidb] => (item=start)
2018-02-27 15:18:45,191 p=86106 u=qupeng |  ok: [tidb] => (item=stop)
2018-02-27 15:18:45,220 p=86106 u=qupeng |  TASK [tidb : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:18:45,286 p=86106 u=qupeng |  ok: [tidb]
2018-02-27 15:18:45,295 p=86106 u=qupeng |  PLAY [finalizing deployment target] ****************************************************************************************************************************************
2018-02-27 15:18:45,316 p=86106 u=qupeng |  TASK [firewalld : All enabled ports] ***************************************************************************************************************************************
2018-02-27 15:18:45,495 p=86106 u=qupeng |  TASK [firewalld : determine if firewalld is running] ***********************************************************************************************************************
2018-02-27 15:18:45,672 p=86106 u=qupeng |  TASK [firewalld : enable firewalld ports] **********************************************************************************************************************************
2018-02-27 15:18:45,864 p=86106 u=qupeng |  TASK [firewalld : reload firewalld] ****************************************************************************************************************************************
2018-02-27 15:18:46,038 p=86106 u=qupeng |  TASK [firewalld : All enabled ports] ***************************************************************************************************************************************
2018-02-27 15:18:46,219 p=86106 u=qupeng |  TASK [firewalld : determine if firewalld is running] ***********************************************************************************************************************
2018-02-27 15:18:46,409 p=86106 u=qupeng |  TASK [firewalld : enable firewalld ports] **********************************************************************************************************************************
2018-02-27 15:18:46,606 p=86106 u=qupeng |  TASK [firewalld : reload firewalld] ****************************************************************************************************************************************
2018-02-27 15:18:46,778 p=86106 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 15:18:46,778 p=86106 u=qupeng |  172.16.21.1                : ok=28   changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,778 p=86106 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,779 p=86106 u=qupeng |  monitoring                 : ok=39   changed=2    unreachable=0    failed=0   
2018-02-27 15:18:46,779 p=86106 u=qupeng |  pd                         : ok=51   changed=10   unreachable=0    failed=0   
2018-02-27 15:18:46,779 p=86106 u=qupeng |  tidb                       : ok=29   changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,779 p=86106 u=qupeng |  tikv1                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,779 p=86106 u=qupeng |  tikv2                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,779 p=86106 u=qupeng |  tikv3                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,779 p=86106 u=qupeng |  tikv4                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,780 p=86106 u=qupeng |  tikv5                      : ok=30   changed=0    unreachable=0    failed=0   
2018-02-27 15:18:46,780 p=86106 u=qupeng |  Congrats! All goes well. :-)
2018-02-27 15:18:55,828 p=111943 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:18:55,843 p=111943 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:18:55,869 p=111943 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:18:55,892 p=111943 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:18:55,911 p=111943 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:18:55,935 p=111943 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:18:55,958 p=111943 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:18:56,032 p=111943 u=qupeng |  ok: [localhost]
2018-02-27 15:18:56,038 p=111943 u=qupeng |  PLAY [gather all facts, and check dest] ************************************************************************************************************************************
2018-02-27 15:18:56,058 p=111943 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:18:56,208 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:18:56,226 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:18:56,249 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:18:56,263 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:18:56,264 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:18:56,340 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:18:56,356 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:18:56,388 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:18:56,388 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:18:56,396 p=111943 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:19:02,031 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:02,284 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:02,437 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:02,501 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:02,625 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:07,347 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:07,850 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:08,234 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:08,918 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:08,947 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:19:09,802 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:09,817 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:09,830 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:09,842 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:09,869 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:10,553 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:10,577 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:10,584 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:10,585 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:10,593 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:19:10,692 p=111943 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:19:10,796 p=111943 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:19:10,903 p=111943 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:19:10,949 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:10,972 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:10,984 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:10,995 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:10,996 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:11,001 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:11,012 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:11,018 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:11,037 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:11,047 p=111943 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:19:11,154 p=111943 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:19:11,255 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:19:11,369 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:19:12,149 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:12,176 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:12,190 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:12,203 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:12,204 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:12,828 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:12,922 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:12,935 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:12,937 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:12,949 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:19:13,698 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:13,720 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:13,749 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:13,769 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:13,771 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:14,412 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:14,416 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:14,481 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:14,563 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:14,572 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:19:14,685 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:19:14,786 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:19:15,811 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:15,828 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:15,841 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:15,854 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:15,855 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:16,634 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:16,667 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:16,707 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:16,709 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:16,717 p=111943 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:19:16,828 p=111943 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:19:16,935 p=111943 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:19:17,787 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:17,799 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:17,835 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:17,852 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:17,854 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:18,614 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:18,639 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:18,690 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:18,729 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:18,738 p=111943 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:19:19,633 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:19,654 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:19,672 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:19,691 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:19,700 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:20,467 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:20,490 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:20,510 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:20,529 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:20,537 p=111943 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:19:20,591 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:20,604 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:20,617 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:20,630 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:20,630 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:20,631 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:20,637 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:20,646 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:20,659 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:20,666 p=111943 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:19:20,724 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:20,737 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:20,753 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:20,765 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:20,766 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:20,774 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:20,777 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:20,802 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:20,812 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:20,819 p=111943 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:19:20,872 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:20,883 p=111943 u=qupeng |  ok: [monitoring]
2018-02-27 15:19:20,898 p=111943 u=qupeng |  ok: [tidb]
2018-02-27 15:19:20,911 p=111943 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:19:20,912 p=111943 u=qupeng |  ok: [tikv1]
2018-02-27 15:19:20,913 p=111943 u=qupeng |  ok: [tikv2]
2018-02-27 15:19:20,928 p=111943 u=qupeng |  ok: [tikv3]
2018-02-27 15:19:20,935 p=111943 u=qupeng |  ok: [tikv4]
2018-02-27 15:19:20,957 p=111943 u=qupeng |  ok: [tikv5]
2018-02-27 15:19:20,963 p=111943 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:19:20,971 p=111943 u=qupeng |  TASK [start node_exporter by supervise] ************************************************************************************************************************************
2018-02-27 15:19:21,875 p=111943 u=qupeng |  changed: [pd] => (item=node_exporter)
2018-02-27 15:19:21,885 p=111943 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:19:21,914 p=111943 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:19:21,942 p=111943 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:19:22,829 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:22,838 p=111943 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:19:22,853 p=111943 u=qupeng |  TASK [start blackbox_exporter by supervise] ********************************************************************************************************************************
2018-02-27 15:19:23,799 p=111943 u=qupeng |  changed: [pd] => (item=blackbox_exporter)
2018-02-27 15:19:23,812 p=111943 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:19:23,846 p=111943 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:19:23,876 p=111943 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:19:24,585 p=111943 u=qupeng |  ok: [pd]
2018-02-27 15:19:24,594 p=111943 u=qupeng |  PLAY [monitoring_servers] **************************************************************************************************************************************************
2018-02-27 15:19:24,608 p=111943 u=qupeng |  TASK [start monitoring modules by supervise] *******************************************************************************************************************************
2018-02-27 15:19:25,514 p=111943 u=qupeng |  changed: [monitoring] => (item=pushgateway)
2018-02-27 15:19:26,429 p=111943 u=qupeng |  changed: [monitoring] => (item=prometheus)
2018-02-27 15:19:26,443 p=111943 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:19:26,481 p=111943 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:19:26,517 p=111943 u=qupeng |  TASK [wait pushgateway up] *************************************************************************************************************************************************
2018-02-27 15:24:03,002 p=111943 u=qupeng |   [ERROR]: User interrupted execution

2018-02-27 15:24:27,711 p=137138 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:24:27,727 p=137138 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:24:27,756 p=137138 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:24:27,783 p=137138 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:24:27,799 p=137138 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:24:27,818 p=137138 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:24:27,838 p=137138 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:24:27,909 p=137138 u=qupeng |  ok: [localhost]
2018-02-27 15:24:27,915 p=137138 u=qupeng |  PLAY [initializing deployment target] **************************************************************************************************************************************
2018-02-27 15:24:27,931 p=137138 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:24:28,080 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:28,098 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:28,112 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:28,126 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:28,127 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:28,198 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:28,221 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:28,234 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:28,253 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:28,260 p=137138 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:24:34,097 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:34,151 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:34,204 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:34,265 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:34,303 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:39,476 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:39,766 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:39,914 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:40,600 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:40,631 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:24:41,533 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:41,571 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:41,593 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:41,614 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:41,615 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:42,221 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:42,281 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:42,304 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:42,311 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:42,319 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:24:42,422 p=137138 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:24:42,521 p=137138 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:24:42,633 p=137138 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:24:42,689 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:42,705 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:42,717 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:42,729 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:42,730 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:42,730 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:42,745 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:42,755 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:42,769 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:42,780 p=137138 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:24:42,888 p=137138 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:24:43,002 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:24:43,120 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:24:43,906 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:43,926 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:43,943 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:43,959 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:43,960 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:44,616 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:44,620 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:44,639 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:44,686 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:44,696 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:24:45,438 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:45,459 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:45,472 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:45,486 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:45,487 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:46,169 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:46,172 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:46,187 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:46,189 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:46,199 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:24:46,310 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:24:46,427 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:24:47,450 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:47,473 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:47,493 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:47,511 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:47,513 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:48,283 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:48,312 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:48,315 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:48,319 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:48,327 p=137138 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:24:48,429 p=137138 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:24:48,529 p=137138 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:24:49,410 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:49,426 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:49,441 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:49,454 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:49,456 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:50,292 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:50,294 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:50,296 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:50,315 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:50,326 p=137138 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:24:51,246 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:51,263 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:51,283 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:51,300 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:51,302 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:52,115 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:52,139 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:52,158 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:52,196 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:52,210 p=137138 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:24:52,259 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:52,274 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:52,299 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:52,311 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:52,322 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:52,322 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:52,327 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:52,345 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:52,347 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:52,354 p=137138 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:24:52,413 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:52,424 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:52,441 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:52,455 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:52,455 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:52,466 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:52,473 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:52,493 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:52,504 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:52,511 p=137138 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:24:52,575 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:52,588 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:24:52,600 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:24:52,613 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:24:52,619 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:24:52,637 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:24:52,643 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:24:52,647 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:24:52,654 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:24:52,661 p=137138 u=qupeng |  PLAY [deploying monitoring agent] ******************************************************************************************************************************************
2018-02-27 15:24:52,670 p=137138 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:24:53,475 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/scripts)
2018-02-27 15:24:54,157 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:24:54,831 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/backup)
2018-02-27 15:24:54,846 p=137138 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:24:54,895 p=137138 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:24:55,608 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/bin)
2018-02-27 15:24:55,623 p=137138 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:24:55,669 p=137138 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 15:24:55,718 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/binary_deployment.yml for pd
2018-02-27 15:24:55,731 p=137138 u=qupeng |  TASK [node_exporter : create deploy directories] ***************************************************************************************************************************
2018-02-27 15:24:56,455 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 15:24:56,472 p=137138 u=qupeng |  TASK [node_exporter : deploy node_exporter binary] *************************************************************************************************************************
2018-02-27 15:24:58,629 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:24:58,645 p=137138 u=qupeng |  TASK [node_exporter : create run script] ***********************************************************************************************************************************
2018-02-27 15:25:00,038 p=137138 u=qupeng |  ok: [pd] => (item=run)
2018-02-27 15:25:00,054 p=137138 u=qupeng |  TASK [node_exporter : include] *********************************************************************************************************************************************
2018-02-27 15:25:00,101 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/node_exporter/tasks/supervise_deployment.yml for pd
2018-02-27 15:25:00,116 p=137138 u=qupeng |  TASK [node_exporter : deploy supervise] ************************************************************************************************************************************
2018-02-27 15:25:00,647 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:25:01,347 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/node_exporter)
2018-02-27 15:25:01,359 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:25:02,786 p=137138 u=qupeng |  ok: [pd] => (item=supervise)
2018-02-27 15:25:04,206 p=137138 u=qupeng |  ok: [pd] => (item=svc)
2018-02-27 15:25:05,618 p=137138 u=qupeng |  ok: [pd] => (item=svstat)
2018-02-27 15:25:05,636 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:25:07,080 p=137138 u=qupeng |  ok: [pd] => (item=start)
2018-02-27 15:25:08,536 p=137138 u=qupeng |  ok: [pd] => (item=stop)
2018-02-27 15:25:08,550 p=137138 u=qupeng |  TASK [node_exporter : prepare firewalld white list] ************************************************************************************************************************
2018-02-27 15:25:08,672 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:25:08,686 p=137138 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 15:25:08,745 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/binary_deployment.yml for pd
2018-02-27 15:25:08,758 p=137138 u=qupeng |  TASK [blackbox_exporter : create deploy directories] ***********************************************************************************************************************
2018-02-27 15:25:09,555 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 15:25:09,572 p=137138 u=qupeng |  TASK [blackbox_exporter : deploy blackbox_exporter binary] *****************************************************************************************************************
2018-02-27 15:25:11,824 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:25:11,837 p=137138 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 15:25:11,886 p=137138 u=qupeng |  TASK [blackbox_exporter : blackbox_exporter binary add CAP_NET_RAW capability] *********************************************************************************************
2018-02-27 15:25:12,672 p=137138 u=qupeng |  changed: [pd]
2018-02-27 15:25:12,679 p=137138 u=qupeng |  TASK [blackbox_exporter : create run script] *******************************************************************************************************************************
2018-02-27 15:25:14,043 p=137138 u=qupeng |  ok: [pd] => (item=run)
2018-02-27 15:25:14,053 p=137138 u=qupeng |  TASK [blackbox_exporter : include] *****************************************************************************************************************************************
2018-02-27 15:25:14,102 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/blackbox_exporter/tasks/supervise_deployment.yml for pd
2018-02-27 15:25:14,115 p=137138 u=qupeng |  TASK [blackbox_exporter : deploy supervise] ********************************************************************************************************************************
2018-02-27 15:25:14,701 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:25:15,454 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/blackbox_exporter)
2018-02-27 15:25:15,465 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:25:16,950 p=137138 u=qupeng |  ok: [pd] => (item=supervise)
2018-02-27 15:25:18,414 p=137138 u=qupeng |  ok: [pd] => (item=svc)
2018-02-27 15:25:19,784 p=137138 u=qupeng |  ok: [pd] => (item=svstat)
2018-02-27 15:25:19,802 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:25:21,293 p=137138 u=qupeng |  ok: [pd] => (item=start)
2018-02-27 15:25:22,671 p=137138 u=qupeng |  ok: [pd] => (item=stop)
2018-02-27 15:25:22,692 p=137138 u=qupeng |  TASK [blackbox_exporter : create config file] ******************************************************************************************************************************
2018-02-27 15:25:24,083 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:25:24,092 p=137138 u=qupeng |  TASK [blackbox_exporter : backup conf file] ********************************************************************************************************************************
2018-02-27 15:25:24,130 p=137138 u=qupeng |  TASK [blackbox_exporter : prepare firewalld white list] ********************************************************************************************************************
2018-02-27 15:25:24,186 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:25:24,195 p=137138 u=qupeng |  PLAY [deploying monitoring server] *****************************************************************************************************************************************
2018-02-27 15:25:24,214 p=137138 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:25:24,919 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 15:25:25,598 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 15:25:26,292 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 15:25:26,308 p=137138 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:25:26,356 p=137138 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:25:27,015 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 15:25:27,030 p=137138 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:25:27,068 p=137138 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 15:25:27,110 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/binary_deployment.yml for monitoring
2018-02-27 15:25:27,121 p=137138 u=qupeng |  TASK [pushgateway : create deploy directories] *****************************************************************************************************************************
2018-02-27 15:25:27,863 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:25:27,876 p=137138 u=qupeng |  TASK [pushgateway : deploy pushgateway binary] *****************************************************************************************************************************
2018-02-27 15:25:29,294 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:25:29,309 p=137138 u=qupeng |  TASK [pushgateway : create run script] *************************************************************************************************************************************
2018-02-27 15:25:31,410 p=137138 u=qupeng |  changed: [monitoring] => (item=run)
2018-02-27 15:25:31,423 p=137138 u=qupeng |  TASK [pushgateway : include] ***********************************************************************************************************************************************
2018-02-27 15:25:31,459 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pushgateway/tasks/supervise_deployment.yml for monitoring
2018-02-27 15:25:31,471 p=137138 u=qupeng |  TASK [pushgateway : deploy supervise] **************************************************************************************************************************************
2018-02-27 15:25:32,014 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:25:32,759 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/pushgateway)
2018-02-27 15:25:32,774 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:25:34,202 p=137138 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 15:25:35,606 p=137138 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 15:25:36,983 p=137138 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 15:25:36,995 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:25:38,405 p=137138 u=qupeng |  ok: [monitoring] => (item=start)
2018-02-27 15:25:39,782 p=137138 u=qupeng |  ok: [monitoring] => (item=stop)
2018-02-27 15:25:39,796 p=137138 u=qupeng |  TASK [pushgateway : prepare firewalld white list] **************************************************************************************************************************
2018-02-27 15:25:39,853 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:25:39,865 p=137138 u=qupeng |  TASK [prometheus : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:25:40,568 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:25:41,266 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 15:25:41,916 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 15:25:41,924 p=137138 u=qupeng |  TASK [prometheus : get config file stat] ***********************************************************************************************************************************
2018-02-27 15:25:42,888 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:25:42,902 p=137138 u=qupeng |  TASK [prometheus : get alert conf stat] ************************************************************************************************************************************
2018-02-27 15:25:43,614 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:25:43,624 p=137138 u=qupeng |  TASK [prometheus : create configuration file if not exist] *****************************************************************************************************************
2018-02-27 15:25:45,661 p=137138 u=qupeng |  changed: [monitoring]
2018-02-27 15:25:45,671 p=137138 u=qupeng |  TASK [prometheus : copy alert rules file] **********************************************************************************************************************************
2018-02-27 15:25:47,318 p=137138 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 15:25:49,043 p=137138 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 15:25:50,615 p=137138 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 15:25:52,222 p=137138 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 15:25:53,827 p=137138 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 15:25:55,434 p=137138 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 15:25:57,031 p=137138 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 15:25:57,046 p=137138 u=qupeng |  TASK [prometheus : set alert rules label changes] **************************************************************************************************************************
2018-02-27 15:25:57,880 p=137138 u=qupeng |  changed: [monitoring] => (item=node.rules.yml)
2018-02-27 15:25:58,583 p=137138 u=qupeng |  changed: [monitoring] => (item=bypass.rules.yml)
2018-02-27 15:25:59,225 p=137138 u=qupeng |  changed: [monitoring] => (item=pd.rules.yml)
2018-02-27 15:25:59,937 p=137138 u=qupeng |  changed: [monitoring] => (item=tidb.rules.yml)
2018-02-27 15:26:00,597 p=137138 u=qupeng |  changed: [monitoring] => (item=tikv.rules.yml)
2018-02-27 15:26:01,294 p=137138 u=qupeng |  changed: [monitoring] => (item=binlog.rules.yml)
2018-02-27 15:26:01,975 p=137138 u=qupeng |  changed: [monitoring] => (item=blacker.rules.yml)
2018-02-27 15:26:01,988 p=137138 u=qupeng |  TASK [prometheus : create deploy data directory] ***************************************************************************************************************************
2018-02-27 15:26:02,725 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/prometheus2.0.0.data.metrics)
2018-02-27 15:26:02,734 p=137138 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 15:26:02,769 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/binary_deployment.yml for monitoring
2018-02-27 15:26:02,778 p=137138 u=qupeng |  TASK [prometheus : create deploy log directory] ****************************************************************************************************************************
2018-02-27 15:26:03,496 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:26:03,513 p=137138 u=qupeng |  TASK [prometheus : deploy prometheus binary] *******************************************************************************************************************************
2018-02-27 15:26:05,093 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:26:05,104 p=137138 u=qupeng |  TASK [prometheus : create run script] **************************************************************************************************************************************
2018-02-27 15:26:07,077 p=137138 u=qupeng |  changed: [monitoring] => (item=run)
2018-02-27 15:26:07,089 p=137138 u=qupeng |  TASK [prometheus : include] ************************************************************************************************************************************************
2018-02-27 15:26:07,135 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/prometheus/tasks/supervise_deployment.yml for monitoring
2018-02-27 15:26:07,148 p=137138 u=qupeng |  TASK [prometheus : deploy supervise] ***************************************************************************************************************************************
2018-02-27 15:26:07,840 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:26:08,561 p=137138 u=qupeng |  ok: [monitoring] => (item=/data3/qupeng/raftstore-learner/monitor/status/prometheus)
2018-02-27 15:26:08,580 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:26:09,960 p=137138 u=qupeng |  ok: [monitoring] => (item=supervise)
2018-02-27 15:26:11,368 p=137138 u=qupeng |  ok: [monitoring] => (item=svc)
2018-02-27 15:26:12,796 p=137138 u=qupeng |  ok: [monitoring] => (item=svstat)
2018-02-27 15:26:12,819 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:26:14,281 p=137138 u=qupeng |  ok: [monitoring] => (item=start)
2018-02-27 15:26:15,674 p=137138 u=qupeng |  ok: [monitoring] => (item=stop)
2018-02-27 15:26:15,691 p=137138 u=qupeng |  TASK [prometheus : prepare firewalld white list] ***************************************************************************************************************************
2018-02-27 15:26:15,751 p=137138 u=qupeng |  ok: [monitoring]
2018-02-27 15:26:15,761 p=137138 u=qupeng |  PLAY [deploying grafana] ***************************************************************************************************************************************************
2018-02-27 15:26:15,776 p=137138 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:26:16,524 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/scripts)
2018-02-27 15:26:17,316 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/conf)
2018-02-27 15:26:18,020 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/backup)
2018-02-27 15:26:18,035 p=137138 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:26:18,088 p=137138 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:26:18,876 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/bin)
2018-02-27 15:26:18,890 p=137138 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:26:18,933 p=137138 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:26:18,983 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/tasks.yml for 172.16.21.1
2018-02-27 15:26:18,995 p=137138 u=qupeng |  TASK [grafana : create common deploy directories] **************************************************************************************************************************
2018-02-27 15:26:19,789 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/log)
2018-02-27 15:26:20,509 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/data.grafana)
2018-02-27 15:26:20,524 p=137138 u=qupeng |  TASK [grafana : push data source file] *************************************************************************************************************************************
2018-02-27 15:26:22,180 p=137138 u=qupeng |  changed: [172.16.21.1]
2018-02-27 15:26:22,194 p=137138 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:26:22,246 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/binary_deployment.yml for 172.16.21.1
2018-02-27 15:26:22,259 p=137138 u=qupeng |  TASK [grafana : create binary deploy directories (1/2)] ********************************************************************************************************************
2018-02-27 15:26:22,993 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt)
2018-02-27 15:26:23,005 p=137138 u=qupeng |  TASK [grafana : deploy grafana binary] *************************************************************************************************************************************
2018-02-27 15:26:23,476 p=137138 u=qupeng |  TASK [grafana : rename grafana deploy dir] *********************************************************************************************************************************
2018-02-27 15:26:24,199 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:26:24,214 p=137138 u=qupeng |  TASK [grafana : create binary deploy directories (2/2)] ********************************************************************************************************************
2018-02-27 15:26:24,958 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/dashboards)
2018-02-27 15:26:25,647 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/opt/grafana/plugins)
2018-02-27 15:26:25,670 p=137138 u=qupeng |  TASK [grafana : create grafana configuration file] *************************************************************************************************************************
2018-02-27 15:26:27,350 p=137138 u=qupeng |  changed: [172.16.21.1]
2018-02-27 15:26:27,358 p=137138 u=qupeng |  TASK [grafana : create run script] *****************************************************************************************************************************************
2018-02-27 15:26:28,818 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=run)
2018-02-27 15:26:28,833 p=137138 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:26:28,878 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/grafana/tasks/supervise_deployment.yml for 172.16.21.1
2018-02-27 15:26:28,894 p=137138 u=qupeng |  TASK [grafana : deploy supervise] ******************************************************************************************************************************************
2018-02-27 15:26:29,487 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:26:30,233 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=/data3/qupeng/raftstore-learner/monitor/status/grafana)
2018-02-27 15:26:30,247 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:26:31,639 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=supervise)
2018-02-27 15:26:33,016 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=svc)
2018-02-27 15:26:34,396 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=svstat)
2018-02-27 15:26:34,412 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:26:35,901 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=start)
2018-02-27 15:26:37,329 p=137138 u=qupeng |  ok: [172.16.21.1] => (item=stop)
2018-02-27 15:26:37,350 p=137138 u=qupeng |  TASK [grafana : prepare firewalld white list] ******************************************************************************************************************************
2018-02-27 15:26:37,417 p=137138 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:26:37,430 p=137138 u=qupeng |  PLAY [deploying PD cluster] ************************************************************************************************************************************************
2018-02-27 15:26:37,450 p=137138 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:26:38,190 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/scripts)
2018-02-27 15:26:38,896 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:26:39,599 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/backup)
2018-02-27 15:26:39,615 p=137138 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:26:39,661 p=137138 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:26:40,413 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/bin)
2018-02-27 15:26:40,428 p=137138 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:26:40,474 p=137138 u=qupeng |  TASK [pd : create deploy directories] **************************************************************************************************************************************
2018-02-27 15:26:41,179 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/log)
2018-02-27 15:26:41,843 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/conf)
2018-02-27 15:26:42,625 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/data.pd)
2018-02-27 15:26:42,638 p=137138 u=qupeng |  TASK [pd : load customized config] *****************************************************************************************************************************************
2018-02-27 15:26:42,693 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:26:42,703 p=137138 u=qupeng |  TASK [pd : load default config] ********************************************************************************************************************************************
2018-02-27 15:26:42,748 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:26:42,758 p=137138 u=qupeng |  TASK [pd : generate metrics config] ****************************************************************************************************************************************
2018-02-27 15:26:42,854 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:26:42,866 p=137138 u=qupeng |  TASK [pd : generate final config] ******************************************************************************************************************************************
2018-02-27 15:26:42,929 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:26:42,938 p=137138 u=qupeng |  TASK [pd : debug] **********************************************************************************************************************************************************
2018-02-27 15:26:42,989 p=137138 u=qupeng |  ok: [pd] => {
    "pd_conf": {
        "global": {
            "lease": 3, 
            "tso-save-interval": "3s"
        }, 
        "log": {
            "file": {}, 
            "level": "info"
        }, 
        "metric": {
            "address": "172.16.21.1:60011", 
            "interval": "15s"
        }, 
        "replication": {
            "location-labels": [], 
            "max-replicas": 3
        }, 
        "schedule": {
            "leader-schedule-limit": 64, 
            "max-pending-peer-count": 16, 
            "max-snapshot-count": 3, 
            "max-store-down-time": "1h", 
            "region-schedule-limit": 16, 
            "replica-schedule-limit": 24, 
            "tolerant-size-ratio": 2.5
        }, 
        "security": {
            "cacert-path": "", 
            "cert-path": "", 
            "key-path": ""
        }
    }
}
2018-02-27 15:26:42,998 p=137138 u=qupeng |  TASK [pd : create configuration file] **************************************************************************************************************************************
2018-02-27 15:26:44,836 p=137138 u=qupeng |  changed: [pd]
2018-02-27 15:26:44,850 p=137138 u=qupeng |  TASK [pd : backup conf file] ***********************************************************************************************************************************************
2018-02-27 15:26:45,750 p=137138 u=qupeng |  changed: [pd]
2018-02-27 15:26:45,761 p=137138 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 15:26:45,808 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/binary_deployment.yml for pd
2018-02-27 15:26:45,820 p=137138 u=qupeng |  TASK [pd : deploy binary] **************************************************************************************************************************************************
2018-02-27 15:26:47,430 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:26:47,444 p=137138 u=qupeng |  TASK [pd : backup bianry file] *********************************************************************************************************************************************
2018-02-27 15:26:47,481 p=137138 u=qupeng |  TASK [pd : create startup script] ******************************************************************************************************************************************
2018-02-27 15:26:49,418 p=137138 u=qupeng |  changed: [pd] => (item=run)
2018-02-27 15:26:49,433 p=137138 u=qupeng |  TASK [pd : include] ********************************************************************************************************************************************************
2018-02-27 15:26:49,481 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/pd/tasks/supervise_deployment.yml for pd
2018-02-27 15:26:49,495 p=137138 u=qupeng |  TASK [pd : deploy supervise] ***********************************************************************************************************************************************
2018-02-27 15:26:50,055 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:26:50,803 p=137138 u=qupeng |  ok: [pd] => (item=/data3/qupeng/raftstore-learner/pd/status/pd)
2018-02-27 15:26:50,818 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:26:52,263 p=137138 u=qupeng |  ok: [pd] => (item=supervise)
2018-02-27 15:26:53,706 p=137138 u=qupeng |  ok: [pd] => (item=svc)
2018-02-27 15:26:55,080 p=137138 u=qupeng |  ok: [pd] => (item=svstat)
2018-02-27 15:26:55,100 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:26:56,505 p=137138 u=qupeng |  ok: [pd] => (item=start)
2018-02-27 15:26:57,931 p=137138 u=qupeng |  ok: [pd] => (item=stop)
2018-02-27 15:26:57,947 p=137138 u=qupeng |  TASK [pd : prepare firewalld white list] ***********************************************************************************************************************************
2018-02-27 15:26:58,011 p=137138 u=qupeng |  ok: [pd]
2018-02-27 15:26:58,022 p=137138 u=qupeng |  PLAY [deploying TiKV cluster] **********************************************************************************************************************************************
2018-02-27 15:26:58,043 p=137138 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:26:58,708 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/scripts)
2018-02-27 15:26:58,726 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/scripts)
2018-02-27 15:26:58,741 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/scripts)
2018-02-27 15:26:58,760 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/scripts)
2018-02-27 15:26:58,775 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/scripts)
2018-02-27 15:26:59,293 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 15:26:59,350 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 15:26:59,353 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 15:26:59,355 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 15:26:59,370 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 15:26:59,904 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/backup)
2018-02-27 15:26:59,982 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/backup)
2018-02-27 15:26:59,991 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/backup)
2018-02-27 15:27:00,001 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/backup)
2018-02-27 15:27:00,004 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/backup)
2018-02-27 15:27:00,018 p=137138 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:27:00,653 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status)
2018-02-27 15:27:00,686 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status)
2018-02-27 15:27:00,700 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status)
2018-02-27 15:27:00,710 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status)
2018-02-27 15:27:00,739 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status)
2018-02-27 15:27:00,747 p=137138 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:27:01,389 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/bin)
2018-02-27 15:27:01,398 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/bin)
2018-02-27 15:27:01,402 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/bin)
2018-02-27 15:27:01,417 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/bin)
2018-02-27 15:27:01,438 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/bin)
2018-02-27 15:27:01,448 p=137138 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:27:01,529 p=137138 u=qupeng |  TASK [tikv : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:27:02,173 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/log)
2018-02-27 15:27:02,175 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/log)
2018-02-27 15:27:02,205 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/log)
2018-02-27 15:27:02,224 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/log)
2018-02-27 15:27:02,235 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/log)
2018-02-27 15:27:02,764 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/data)
2018-02-27 15:27:02,769 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/data)
2018-02-27 15:27:02,824 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/data)
2018-02-27 15:27:02,836 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/data)
2018-02-27 15:27:02,848 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/data)
2018-02-27 15:27:03,360 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/conf)
2018-02-27 15:27:03,366 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/conf)
2018-02-27 15:27:03,452 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/conf)
2018-02-27 15:27:03,454 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/conf)
2018-02-27 15:27:03,465 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/conf)
2018-02-27 15:27:03,473 p=137138 u=qupeng |  TASK [tikv : load customized config] ***************************************************************************************************************************************
2018-02-27 15:27:03,515 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:27:03,531 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:27:03,542 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:27:03,562 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:27:03,570 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:27:03,577 p=137138 u=qupeng |  TASK [tikv : load default config] ******************************************************************************************************************************************
2018-02-27 15:27:03,618 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:27:03,635 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:27:03,655 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:27:03,664 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:27:03,671 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:27:03,678 p=137138 u=qupeng |  TASK [tikv : generate metrics config] **************************************************************************************************************************************
2018-02-27 15:27:03,757 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:27:03,759 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:27:03,784 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:27:03,816 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:27:03,823 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:27:03,830 p=137138 u=qupeng |  TASK [tikv : generate final config] ****************************************************************************************************************************************
2018-02-27 15:27:03,881 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:27:03,887 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:27:03,890 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:27:03,909 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:27:03,940 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:27:03,947 p=137138 u=qupeng |  TASK [tikv : debug] ********************************************************************************************************************************************************
2018-02-27 15:27:03,999 p=137138 u=qupeng |  ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:60011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:27:04,002 p=137138 u=qupeng |  ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:60011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:27:04,028 p=137138 u=qupeng |  ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:60011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:27:04,039 p=137138 u=qupeng |  ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:60011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:27:04,040 p=137138 u=qupeng |  ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {}, 
        "global": {}, 
        "metric": {
            "address": "172.16.21.1:60011", 
            "interval": "15s", 
            "job": "tikv"
        }, 
        "pd": {}, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "raftdb-path": "", 
            "sync-log": true
        }, 
        "rocksdb": {
            "defaultcf": {}, 
            "lockcf": {}, 
            "wal-dir": "", 
            "writecf": {}
        }, 
        "security": {}, 
        "server": {
            "labels": {}
        }, 
        "storage": {}
    }
}
2018-02-27 15:27:04,047 p=137138 u=qupeng |  TASK [tikv : create config file] *******************************************************************************************************************************************
2018-02-27 15:27:05,771 p=137138 u=qupeng |  changed: [tikv1]
2018-02-27 15:27:05,806 p=137138 u=qupeng |  changed: [tikv4]
2018-02-27 15:27:05,821 p=137138 u=qupeng |  changed: [tikv2]
2018-02-27 15:27:05,836 p=137138 u=qupeng |  changed: [tikv3]
2018-02-27 15:27:05,837 p=137138 u=qupeng |  changed: [tikv5]
2018-02-27 15:27:05,849 p=137138 u=qupeng |  TASK [tikv : backup conf file] *********************************************************************************************************************************************
2018-02-27 15:27:06,597 p=137138 u=qupeng |  changed: [tikv1]
2018-02-27 15:27:06,605 p=137138 u=qupeng |  changed: [tikv2]
2018-02-27 15:27:06,614 p=137138 u=qupeng |  changed: [tikv4]
2018-02-27 15:27:06,736 p=137138 u=qupeng |  changed: [tikv5]
2018-02-27 15:27:07,630 p=137138 u=qupeng |  changed: [tikv3]
2018-02-27 15:27:07,638 p=137138 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 15:27:07,769 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 15:27:07,789 p=137138 u=qupeng |  TASK [tikv : deploy binary] ************************************************************************************************************************************************
2018-02-27 15:27:09,667 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:27:09,730 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:27:09,744 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:27:09,754 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:27:09,860 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:27:09,873 p=137138 u=qupeng |  TASK [tikv : backup bianry file] *******************************************************************************************************************************************
2018-02-27 15:27:09,955 p=137138 u=qupeng |  TASK [tikv : create run script] ********************************************************************************************************************************************
2018-02-27 15:27:11,713 p=137138 u=qupeng |  changed: [tikv3] => (item=run)
2018-02-27 15:27:11,755 p=137138 u=qupeng |  changed: [tikv1] => (item=run)
2018-02-27 15:27:11,765 p=137138 u=qupeng |  changed: [tikv2] => (item=run)
2018-02-27 15:27:11,803 p=137138 u=qupeng |  changed: [tikv5] => (item=run)
2018-02-27 15:27:11,845 p=137138 u=qupeng |  changed: [tikv4] => (item=run)
2018-02-27 15:27:11,861 p=137138 u=qupeng |  TASK [tikv : backup script file] *******************************************************************************************************************************************
2018-02-27 15:27:11,963 p=137138 u=qupeng |  TASK [tikv : include] ******************************************************************************************************************************************************
2018-02-27 15:27:12,069 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tikv/tasks/supervise_deployment.yml for tikv1, tikv2, tikv3, tikv4, tikv5
2018-02-27 15:27:12,082 p=137138 u=qupeng |  TASK [tikv : deploy supervise] *********************************************************************************************************************************************
2018-02-27 15:27:14,791 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:27:15,555 p=137138 u=qupeng |  ok: [tikv2] => (item=/data3/qupeng/raftstore-learner/tikv2/status/tikv)
2018-02-27 15:27:15,557 p=137138 u=qupeng |  ok: [tikv4] => (item=/data3/qupeng/raftstore-learner/tikv4/status/tikv)
2018-02-27 15:27:15,559 p=137138 u=qupeng |  ok: [tikv5] => (item=/data3/qupeng/raftstore-learner/tikv5/status/tikv)
2018-02-27 15:27:15,560 p=137138 u=qupeng |  ok: [tikv1] => (item=/data3/qupeng/raftstore-learner/tikv1/status/tikv)
2018-02-27 15:27:15,562 p=137138 u=qupeng |  ok: [tikv3] => (item=/data3/qupeng/raftstore-learner/tikv3/status/tikv)
2018-02-27 15:27:15,572 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:27:16,887 p=137138 u=qupeng |  ok: [tikv2] => (item=supervise)
2018-02-27 15:27:16,895 p=137138 u=qupeng |  ok: [tikv1] => (item=supervise)
2018-02-27 15:27:16,932 p=137138 u=qupeng |  ok: [tikv3] => (item=supervise)
2018-02-27 15:27:16,965 p=137138 u=qupeng |  ok: [tikv5] => (item=supervise)
2018-02-27 15:27:16,983 p=137138 u=qupeng |  ok: [tikv4] => (item=supervise)
2018-02-27 15:27:18,166 p=137138 u=qupeng |  ok: [tikv3] => (item=svc)
2018-02-27 15:27:18,174 p=137138 u=qupeng |  ok: [tikv1] => (item=svc)
2018-02-27 15:27:18,201 p=137138 u=qupeng |  ok: [tikv2] => (item=svc)
2018-02-27 15:27:18,277 p=137138 u=qupeng |  ok: [tikv5] => (item=svc)
2018-02-27 15:27:18,282 p=137138 u=qupeng |  ok: [tikv4] => (item=svc)
2018-02-27 15:27:19,513 p=137138 u=qupeng |  ok: [tikv3] => (item=svstat)
2018-02-27 15:27:19,518 p=137138 u=qupeng |  ok: [tikv2] => (item=svstat)
2018-02-27 15:27:19,526 p=137138 u=qupeng |  ok: [tikv1] => (item=svstat)
2018-02-27 15:27:19,618 p=137138 u=qupeng |  ok: [tikv4] => (item=svstat)
2018-02-27 15:27:19,622 p=137138 u=qupeng |  ok: [tikv5] => (item=svstat)
2018-02-27 15:27:19,632 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:27:20,973 p=137138 u=qupeng |  ok: [tikv4] => (item=start)
2018-02-27 15:27:20,986 p=137138 u=qupeng |  ok: [tikv3] => (item=start)
2018-02-27 15:27:20,989 p=137138 u=qupeng |  ok: [tikv5] => (item=start)
2018-02-27 15:27:20,993 p=137138 u=qupeng |  ok: [tikv2] => (item=start)
2018-02-27 15:27:21,000 p=137138 u=qupeng |  ok: [tikv1] => (item=start)
2018-02-27 15:27:22,349 p=137138 u=qupeng |  ok: [tikv5] => (item=stop)
2018-02-27 15:27:22,377 p=137138 u=qupeng |  ok: [tikv2] => (item=stop)
2018-02-27 15:27:22,380 p=137138 u=qupeng |  ok: [tikv4] => (item=stop)
2018-02-27 15:27:22,392 p=137138 u=qupeng |  ok: [tikv3] => (item=stop)
2018-02-27 15:27:22,394 p=137138 u=qupeng |  ok: [tikv1] => (item=stop)
2018-02-27 15:27:22,404 p=137138 u=qupeng |  TASK [tikv : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:27:22,466 p=137138 u=qupeng |  ok: [tikv1]
2018-02-27 15:27:22,480 p=137138 u=qupeng |  ok: [tikv2]
2018-02-27 15:27:22,488 p=137138 u=qupeng |  ok: [tikv3]
2018-02-27 15:27:22,514 p=137138 u=qupeng |  ok: [tikv4]
2018-02-27 15:27:22,516 p=137138 u=qupeng |  ok: [tikv5]
2018-02-27 15:27:22,523 p=137138 u=qupeng |  PLAY [deploying TiDB cluster] **********************************************************************************************************************************************
2018-02-27 15:27:22,536 p=137138 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:27:22,587 p=137138 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:27:22,619 p=137138 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:27:22,649 p=137138 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:27:22,675 p=137138 u=qupeng |  TASK [pump : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:27:22,709 p=137138 u=qupeng |  TASK [pump : include] ******************************************************************************************************************************************************
2018-02-27 15:27:22,730 p=137138 u=qupeng |  TASK [pump : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:27:22,751 p=137138 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:27:23,476 p=137138 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/scripts)
2018-02-27 15:27:24,287 p=137138 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 15:27:24,981 p=137138 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/backup)
2018-02-27 15:27:24,997 p=137138 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:27:25,045 p=137138 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:27:25,918 p=137138 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/bin)
2018-02-27 15:27:25,933 p=137138 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:27:25,978 p=137138 u=qupeng |  TASK [tidb : create deploy directories] ************************************************************************************************************************************
2018-02-27 15:27:26,850 p=137138 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/log)
2018-02-27 15:27:27,534 p=137138 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/conf)
2018-02-27 15:27:27,549 p=137138 u=qupeng |  TASK [tidb : load customized config] ***************************************************************************************************************************************
2018-02-27 15:27:27,609 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:27:27,624 p=137138 u=qupeng |  TASK [tidb : load default config] ******************************************************************************************************************************************
2018-02-27 15:27:27,673 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:27:27,689 p=137138 u=qupeng |  TASK [tidb : generate metrics config] **************************************************************************************************************************************
2018-02-27 15:27:27,762 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:27:27,777 p=137138 u=qupeng |  TASK [tidb : combine final config] *****************************************************************************************************************************************
2018-02-27 15:27:27,823 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:27:27,837 p=137138 u=qupeng |  TASK [tidb : debug] ********************************************************************************************************************************************************
2018-02-27 15:27:27,884 p=137138 u=qupeng |  ok: [tidb] => {
    "tidb_conf": {
        "global": {
            "enable-chunk": true, 
            "host": "0.0.0.0", 
            "lease": "10s", 
            "run-ddl": true, 
            "split-table": true, 
            "store": "tikv"
        }, 
        "log": {
            "disable-timestamp": false, 
            "file": {
                "log-rotate": true
            }, 
            "format": "text", 
            "level": "info", 
            "query-log-max-len": 2048, 
            "slow-threshold": 300
        }, 
        "opentracing": {
            "enable": false, 
            "reporter": {
                "buffer-flush-interval": 0, 
                "local-agent-host-port": "", 
                "log-spans": false, 
                "queue-size": 0
            }, 
            "rpc-metrics": false, 
            "sampler": {
                "max-operations": 0, 
                "param": 1.0, 
                "sampling-refresh-interval": 0, 
                "sampling-server-url": "", 
                "type": "const"
            }
        }, 
        "performance": {
            "cross-join": true, 
            "join-concurrency": 5, 
            "max-procs": 0, 
            "retry-limit": 10, 
            "run-auto-analyze": true, 
            "stats-lease": "3s", 
            "tcp-keep-alive": true
        }, 
        "plan_cache": {
            "capacity": 2560, 
            "enabled": false, 
            "shards": 256
        }, 
        "prepared_plan_cache": {
            "capacity": 100, 
            "enabled": false
        }, 
        "proxy_protocol": {
            "header-timeout": 5, 
            "networks": ""
        }, 
        "security": {
            "cluster-ssl-ca": "", 
            "cluster-ssl-cert": "", 
            "cluster-ssl-key": "", 
            "ssl-ca": "", 
            "ssl-cert": "", 
            "ssl-key": ""
        }, 
        "status": {
            "metrics-addr": "172.16.21.1:60011", 
            "metrics-interval": 15, 
            "report-status": true
        }, 
        "tikv_client": {
            "grpc-connection-count": 16
        }, 
        "xprotocol": {
            "xhost": "0.0.0.0", 
            "xport": 14000, 
            "xserver": false, 
            "xsocket": ""
        }
    }
}
2018-02-27 15:27:27,898 p=137138 u=qupeng |  TASK [tidb : create config file] *******************************************************************************************************************************************
2018-02-27 15:27:29,799 p=137138 u=qupeng |  changed: [tidb]
2018-02-27 15:27:29,814 p=137138 u=qupeng |  TASK [tidb : backup conf file] *********************************************************************************************************************************************
2018-02-27 15:27:30,702 p=137138 u=qupeng |  changed: [tidb]
2018-02-27 15:27:30,711 p=137138 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 15:27:30,761 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/binary_deployment.yml for tidb
2018-02-27 15:27:30,774 p=137138 u=qupeng |  TASK [tidb : deploy binary] ************************************************************************************************************************************************
2018-02-27 15:27:32,418 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:27:32,432 p=137138 u=qupeng |  TASK [tidb : backup binary file] *******************************************************************************************************************************************
2018-02-27 15:27:32,468 p=137138 u=qupeng |  TASK [tidb : create run script] ********************************************************************************************************************************************
2018-02-27 15:27:34,401 p=137138 u=qupeng |  changed: [tidb] => (item=run)
2018-02-27 15:27:34,417 p=137138 u=qupeng |  TASK [tidb : backup script file] *******************************************************************************************************************************************
2018-02-27 15:27:34,452 p=137138 u=qupeng |  TASK [tidb : include] ******************************************************************************************************************************************************
2018-02-27 15:27:34,505 p=137138 u=qupeng |  included: /home/qupeng/ansible/tidb-ansible/roles/tidb/tasks/supervise_deployment.yml for tidb
2018-02-27 15:27:34,520 p=137138 u=qupeng |  TASK [tidb : deploy supervise] *********************************************************************************************************************************************
2018-02-27 15:27:35,335 p=137138 u=qupeng |  TASK [supervise : create supervise status directory] ***********************************************************************************************************************
2018-02-27 15:27:36,098 p=137138 u=qupeng |  ok: [tidb] => (item=/data3/qupeng/raftstore-learner/tidb/status/tidb)
2018-02-27 15:27:36,109 p=137138 u=qupeng |  TASK [supervise : deploy supervise binary] *********************************************************************************************************************************
2018-02-27 15:27:37,610 p=137138 u=qupeng |  ok: [tidb] => (item=supervise)
2018-02-27 15:27:38,950 p=137138 u=qupeng |  ok: [tidb] => (item=svc)
2018-02-27 15:27:40,353 p=137138 u=qupeng |  ok: [tidb] => (item=svstat)
2018-02-27 15:27:40,362 p=137138 u=qupeng |  TASK [supervise : create startup script - common start/stop] ***************************************************************************************************************
2018-02-27 15:27:41,848 p=137138 u=qupeng |  ok: [tidb] => (item=start)
2018-02-27 15:27:43,342 p=137138 u=qupeng |  ok: [tidb] => (item=stop)
2018-02-27 15:27:43,357 p=137138 u=qupeng |  TASK [tidb : prepare firewalld white list] *********************************************************************************************************************************
2018-02-27 15:27:43,411 p=137138 u=qupeng |  ok: [tidb]
2018-02-27 15:27:43,420 p=137138 u=qupeng |  PLAY [finalizing deployment target] ****************************************************************************************************************************************
2018-02-27 15:27:43,441 p=137138 u=qupeng |  TASK [firewalld : All enabled ports] ***************************************************************************************************************************************
2018-02-27 15:27:43,587 p=137138 u=qupeng |  TASK [firewalld : determine if firewalld is running] ***********************************************************************************************************************
2018-02-27 15:27:43,720 p=137138 u=qupeng |  TASK [firewalld : enable firewalld ports] **********************************************************************************************************************************
2018-02-27 15:27:43,862 p=137138 u=qupeng |  TASK [firewalld : reload firewalld] ****************************************************************************************************************************************
2018-02-27 15:27:44,036 p=137138 u=qupeng |  TASK [firewalld : All enabled ports] ***************************************************************************************************************************************
2018-02-27 15:27:44,201 p=137138 u=qupeng |  TASK [firewalld : determine if firewalld is running] ***********************************************************************************************************************
2018-02-27 15:27:44,374 p=137138 u=qupeng |  TASK [firewalld : enable firewalld ports] **********************************************************************************************************************************
2018-02-27 15:27:44,550 p=137138 u=qupeng |  TASK [firewalld : reload firewalld] ****************************************************************************************************************************************
2018-02-27 15:27:44,722 p=137138 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 15:27:44,723 p=137138 u=qupeng |  172.16.21.1                : ok=28   changed=2    unreachable=0    failed=0   
2018-02-27 15:27:44,723 p=137138 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 15:27:44,723 p=137138 u=qupeng |  monitoring                 : ok=39   changed=5    unreachable=0    failed=0   
2018-02-27 15:27:44,723 p=137138 u=qupeng |  pd                         : ok=52   changed=4    unreachable=0    failed=0   
2018-02-27 15:27:44,723 p=137138 u=qupeng |  tidb                       : ok=30   changed=3    unreachable=0    failed=0   
2018-02-27 15:27:44,723 p=137138 u=qupeng |  tikv1                      : ok=31   changed=3    unreachable=0    failed=0   
2018-02-27 15:27:44,724 p=137138 u=qupeng |  tikv2                      : ok=31   changed=3    unreachable=0    failed=0   
2018-02-27 15:27:44,724 p=137138 u=qupeng |  tikv3                      : ok=31   changed=3    unreachable=0    failed=0   
2018-02-27 15:27:44,724 p=137138 u=qupeng |  tikv4                      : ok=31   changed=3    unreachable=0    failed=0   
2018-02-27 15:27:44,724 p=137138 u=qupeng |  tikv5                      : ok=31   changed=3    unreachable=0    failed=0   
2018-02-27 15:27:44,724 p=137138 u=qupeng |  Congrats! All goes well. :-)
2018-02-27 15:27:58,017 p=161385 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:27:58,031 p=161385 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:27:58,057 p=161385 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:27:58,082 p=161385 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:27:58,097 p=161385 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:27:58,116 p=161385 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:27:58,136 p=161385 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:27:58,212 p=161385 u=qupeng |  ok: [localhost]
2018-02-27 15:27:58,220 p=161385 u=qupeng |  PLAY [gather all facts, and check dest] ************************************************************************************************************************************
2018-02-27 15:27:58,248 p=161385 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:27:58,407 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:27:58,429 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:27:58,445 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:27:58,460 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:27:58,461 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:27:58,543 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:27:58,558 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:27:58,571 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:27:58,586 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:27:58,599 p=161385 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:28:04,179 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:04,384 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:04,749 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:04,902 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:04,951 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:09,670 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:09,969 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:10,084 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:11,317 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:11,346 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:28:12,288 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:12,303 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:12,318 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:12,332 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:12,334 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:12,993 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:13,015 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:13,041 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:13,046 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:13,054 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:28:13,165 p=161385 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:28:13,273 p=161385 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:28:13,384 p=161385 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:28:13,431 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:13,442 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:13,465 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:13,477 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:13,478 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:13,479 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:13,498 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:13,502 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:13,506 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:13,514 p=161385 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:28:13,621 p=161385 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:28:13,722 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:28:13,825 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:28:14,594 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:14,617 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:14,630 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:14,643 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:14,644 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:15,354 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:15,357 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:15,364 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:15,406 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:15,422 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:28:16,165 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:16,179 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:16,205 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:16,223 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:16,226 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:16,863 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:16,895 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:16,944 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:16,985 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:17,000 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:28:17,136 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:28:17,244 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:28:18,255 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:18,271 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:18,287 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:18,301 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:18,303 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:19,060 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:19,107 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:19,165 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:19,214 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:19,227 p=161385 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:28:19,351 p=161385 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:28:19,461 p=161385 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:28:20,331 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:20,346 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:20,359 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:20,372 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:20,373 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:21,222 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:21,230 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:21,233 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:21,244 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:21,256 p=161385 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:28:22,102 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:22,123 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:22,142 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:22,195 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:22,198 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:22,960 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:22,980 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:23,045 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:23,093 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:23,101 p=161385 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:28:23,147 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:23,158 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:23,172 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:23,183 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:23,195 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:23,196 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:23,202 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:23,216 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:23,224 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:23,231 p=161385 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:28:23,300 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:23,312 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:23,326 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:23,338 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:23,338 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:23,347 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:23,359 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:23,372 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:23,400 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:23,411 p=161385 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:28:23,458 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:23,487 p=161385 u=qupeng |  ok: [monitoring]
2018-02-27 15:28:23,503 p=161385 u=qupeng |  ok: [tidb]
2018-02-27 15:28:23,518 p=161385 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:28:23,536 p=161385 u=qupeng |  ok: [tikv1]
2018-02-27 15:28:23,542 p=161385 u=qupeng |  ok: [tikv3]
2018-02-27 15:28:23,549 p=161385 u=qupeng |  ok: [tikv2]
2018-02-27 15:28:23,558 p=161385 u=qupeng |  ok: [tikv4]
2018-02-27 15:28:23,573 p=161385 u=qupeng |  ok: [tikv5]
2018-02-27 15:28:23,581 p=161385 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:28:23,593 p=161385 u=qupeng |  TASK [start node_exporter by supervise] ************************************************************************************************************************************
2018-02-27 15:28:24,527 p=161385 u=qupeng |  changed: [pd] => (item=node_exporter)
2018-02-27 15:28:24,537 p=161385 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:28:24,557 p=161385 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:28:24,588 p=161385 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:28:25,435 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:25,442 p=161385 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:28:25,456 p=161385 u=qupeng |  TASK [start blackbox_exporter by supervise] ********************************************************************************************************************************
2018-02-27 15:28:26,404 p=161385 u=qupeng |  changed: [pd] => (item=blackbox_exporter)
2018-02-27 15:28:26,418 p=161385 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:28:26,450 p=161385 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:28:26,480 p=161385 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:28:27,186 p=161385 u=qupeng |  ok: [pd]
2018-02-27 15:28:27,195 p=161385 u=qupeng |  PLAY [monitoring_servers] **************************************************************************************************************************************************
2018-02-27 15:28:27,209 p=161385 u=qupeng |  TASK [start monitoring modules by supervise] *******************************************************************************************************************************
2018-02-27 15:28:28,187 p=161385 u=qupeng |  changed: [monitoring] => (item=pushgateway)
2018-02-27 15:28:29,085 p=161385 u=qupeng |  changed: [monitoring] => (item=prometheus)
2018-02-27 15:28:29,099 p=161385 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:28:29,135 p=161385 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:28:29,170 p=161385 u=qupeng |  TASK [wait pushgateway up] *************************************************************************************************************************************************
2018-02-27 15:29:58,057 p=161385 u=qupeng |   [ERROR]: User interrupted execution

2018-02-27 15:30:22,080 p=167835 u=qupeng |  PLAY [check config locally] ************************************************************************************************************************************************
2018-02-27 15:30:22,096 p=167835 u=qupeng |  TASK [check_config_static : Ensure only one monitoring host exists] ********************************************************************************************************
2018-02-27 15:30:22,120 p=167835 u=qupeng |  TASK [check_config_static : Warn if TiDB host not exists] ******************************************************************************************************************
2018-02-27 15:30:22,140 p=167835 u=qupeng |  TASK [check_config_static : Ensure zookeeper address of kafka cluster is set when enable_binlog] ***************************************************************************
2018-02-27 15:30:22,155 p=167835 u=qupeng |  TASK [check_config_static : Ensure PD host exists] *************************************************************************************************************************
2018-02-27 15:30:22,181 p=167835 u=qupeng |  TASK [check_config_static : Ensure TiKV host exists] ***********************************************************************************************************************
2018-02-27 15:30:22,200 p=167835 u=qupeng |  TASK [check_config_static : Close old control master] **********************************************************************************************************************
2018-02-27 15:30:22,269 p=167835 u=qupeng |  ok: [localhost]
2018-02-27 15:30:22,278 p=167835 u=qupeng |  PLAY [gather all facts, and check dest] ************************************************************************************************************************************
2018-02-27 15:30:22,308 p=167835 u=qupeng |  TASK [check_config_dynamic : Disk space check - Fail task when disk is full] ***********************************************************************************************
2018-02-27 15:30:22,453 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:22,478 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:22,498 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:22,516 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:22,517 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:22,580 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:22,620 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:22,637 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:22,639 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:22,648 p=167835 u=qupeng |  TASK [check_config_dynamic : get facts] ************************************************************************************************************************************
2018-02-27 15:30:28,760 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:28,996 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:29,561 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:29,697 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:29,881 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:34,626 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:35,163 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:35,236 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:35,510 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:35,529 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - Set NTP service status] *****************************************************************************************************
2018-02-27 15:30:36,462 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:36,476 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:36,489 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:36,504 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:36,525 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:37,213 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:37,247 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:37,250 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:37,259 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:37,270 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - NTP service] ****************************************************************************************************************
2018-02-27 15:30:37,379 p=167835 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set default] **************************************************************************************************************
2018-02-27 15:30:37,480 p=167835 u=qupeng |  TASK [check_config_dynamic : Set enable_binlog - set inverse] **************************************************************************************************************
2018-02-27 15:30:37,607 p=167835 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - set ansible_user as default] **********************************************************************************************
2018-02-27 15:30:37,657 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:37,668 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:37,680 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:37,692 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:37,693 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:37,693 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:37,703 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:37,710 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:37,732 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:37,738 p=167835 u=qupeng |  TASK [check_config_dynamic : Guess deploy_user - use become_user under root] ***********************************************************************************************
2018-02-27 15:30:37,842 p=167835 u=qupeng |  TASK [check_config_dynamic : Set deploy dir if not presented] **************************************************************************************************************
2018-02-27 15:30:37,938 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - Deploy user] ****************************************************************************************************************
2018-02-27 15:30:38,042 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get umask] ******************************************************************************************************************
2018-02-27 15:30:38,799 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:38,814 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:38,854 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:38,872 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:38,873 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:39,475 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:39,501 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:39,531 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:39,565 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:39,573 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get Hard Max FD limit] ******************************************************************************************************
2018-02-27 15:30:40,322 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:40,336 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:40,358 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:40,375 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:40,377 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:41,015 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:41,030 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:41,092 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:41,098 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:41,108 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does the system have a standard umask?] *************************************************************************************
2018-02-27 15:30:41,213 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - ulimit -n] ******************************************************************************************************************
2018-02-27 15:30:41,316 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - Get deploy dir permissions] *************************************************************************************************
2018-02-27 15:30:42,304 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:42,327 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:42,348 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:42,364 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:42,367 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:43,125 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:43,144 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:43,188 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:43,190 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:43,201 p=167835 u=qupeng |  TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permissions?] ******************************************************************************
2018-02-27 15:30:43,308 p=167835 u=qupeng |  TASK [check_config_dynamic : Check swap] ***********************************************************************************************************************************
2018-02-27 15:30:43,408 p=167835 u=qupeng |  TASK [check_config_dynamic : environment check (deploy dir)] ***************************************************************************************************************
2018-02-27 15:30:44,261 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:44,284 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:44,315 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:44,329 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:44,330 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:45,125 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:45,152 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:45,154 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:45,180 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:45,193 p=167835 u=qupeng |  TASK [check_config_dynamic : environment check (supervise)] ****************************************************************************************************************
2018-02-27 15:30:46,048 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:46,065 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:46,082 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:46,097 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:46,129 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:46,908 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:46,911 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:46,920 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:46,928 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:46,938 p=167835 u=qupeng |  TASK [check_config_dynamic : config skip variables (default)] **************************************************************************************************************
2018-02-27 15:30:46,972 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:46,983 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:46,994 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:47,015 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:47,026 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:47,027 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:47,037 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:47,038 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:47,049 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:47,056 p=167835 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:30:47,111 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:47,122 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:47,132 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:47,144 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:47,145 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:47,156 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:47,172 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:47,182 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:47,186 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:47,194 p=167835 u=qupeng |  TASK [check_config_dynamic : config skip variables] ************************************************************************************************************************
2018-02-27 15:30:47,246 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:47,263 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:47,274 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:30:47,286 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:30:47,287 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:30:47,289 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:30:47,310 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:30:47,317 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:30:47,322 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:30:47,328 p=167835 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:30:47,335 p=167835 u=qupeng |  TASK [start node_exporter by supervise] ************************************************************************************************************************************
2018-02-27 15:30:48,279 p=167835 u=qupeng |  changed: [pd] => (item=node_exporter)
2018-02-27 15:30:48,288 p=167835 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:30:48,316 p=167835 u=qupeng |  TASK [start node_exporter by systemd] **************************************************************************************************************************************
2018-02-27 15:30:48,341 p=167835 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:30:49,206 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:49,211 p=167835 u=qupeng |  PLAY [monitored_servers] ***************************************************************************************************************************************************
2018-02-27 15:30:49,219 p=167835 u=qupeng |  TASK [start blackbox_exporter by supervise] ********************************************************************************************************************************
2018-02-27 15:30:50,146 p=167835 u=qupeng |  changed: [pd] => (item=blackbox_exporter)
2018-02-27 15:30:50,160 p=167835 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:30:50,192 p=167835 u=qupeng |  TASK [start blackbox_exporter by systemd] **********************************************************************************************************************************
2018-02-27 15:30:50,221 p=167835 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:30:50,917 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:30:50,926 p=167835 u=qupeng |  PLAY [monitoring_servers] **************************************************************************************************************************************************
2018-02-27 15:30:50,942 p=167835 u=qupeng |  TASK [start monitoring modules by supervise] *******************************************************************************************************************************
2018-02-27 15:30:51,937 p=167835 u=qupeng |  changed: [monitoring] => (item=pushgateway)
2018-02-27 15:30:52,824 p=167835 u=qupeng |  changed: [monitoring] => (item=prometheus)
2018-02-27 15:30:52,838 p=167835 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:30:52,872 p=167835 u=qupeng |  TASK [start monitoring modules by systemd] *********************************************************************************************************************************
2018-02-27 15:30:52,903 p=167835 u=qupeng |  TASK [wait pushgateway up] *************************************************************************************************************************************************
2018-02-27 15:30:53,603 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:53,616 p=167835 u=qupeng |  TASK [wait prometheus up] **************************************************************************************************************************************************
2018-02-27 15:30:54,305 p=167835 u=qupeng |  ok: [monitoring]
2018-02-27 15:30:54,311 p=167835 u=qupeng |  PLAY [pd_servers] **********************************************************************************************************************************************************
2018-02-27 15:30:54,323 p=167835 u=qupeng |  TASK [start PD by supervise] ***********************************************************************************************************************************************
2018-02-27 15:30:55,168 p=167835 u=qupeng |  changed: [pd] => (item=pd)
2018-02-27 15:30:55,181 p=167835 u=qupeng |  TASK [start PD by systemd] *************************************************************************************************************************************************
2018-02-27 15:30:55,213 p=167835 u=qupeng |  TASK [start PD by systemd] *************************************************************************************************************************************************
2018-02-27 15:30:55,243 p=167835 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:31:00,205 p=167835 u=qupeng |  ok: [pd]
2018-02-27 15:31:00,215 p=167835 u=qupeng |  PLAY [tikv_servers] ********************************************************************************************************************************************************
2018-02-27 15:31:00,232 p=167835 u=qupeng |  TASK [start TiKV by supervise] *********************************************************************************************************************************************
2018-02-27 15:31:01,015 p=167835 u=qupeng |  changed: [tikv1] => (item=tikv)
2018-02-27 15:31:01,021 p=167835 u=qupeng |  changed: [tikv2] => (item=tikv)
2018-02-27 15:31:01,043 p=167835 u=qupeng |  changed: [tikv3] => (item=tikv)
2018-02-27 15:31:01,084 p=167835 u=qupeng |  changed: [tikv4] => (item=tikv)
2018-02-27 15:31:01,098 p=167835 u=qupeng |  changed: [tikv5] => (item=tikv)
2018-02-27 15:31:01,106 p=167835 u=qupeng |  TASK [start TiKV by systemd] ***********************************************************************************************************************************************
2018-02-27 15:31:01,163 p=167835 u=qupeng |  TASK [start TiKV by systemd] ***********************************************************************************************************************************************
2018-02-27 15:31:01,222 p=167835 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:31:03,082 p=167835 u=qupeng |  ok: [tikv3]
2018-02-27 15:31:03,085 p=167835 u=qupeng |  ok: [tikv1]
2018-02-27 15:31:03,086 p=167835 u=qupeng |  ok: [tikv5]
2018-02-27 15:31:03,095 p=167835 u=qupeng |  ok: [tikv4]
2018-02-27 15:31:03,128 p=167835 u=qupeng |  ok: [tikv2]
2018-02-27 15:31:03,144 p=167835 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:31:03,242 p=167835 u=qupeng |  TASK [command] *************************************************************************************************************************************************************
2018-02-27 15:31:03,939 p=167835 u=qupeng |  changed: [tikv1]
2018-02-27 15:31:03,968 p=167835 u=qupeng |  changed: [tikv4]
2018-02-27 15:31:03,992 p=167835 u=qupeng |  changed: [tikv5]
2018-02-27 15:31:04,018 p=167835 u=qupeng |  changed: [tikv2]
2018-02-27 15:31:05,019 p=167835 u=qupeng |  changed: [tikv3]
2018-02-27 15:31:05,032 p=167835 u=qupeng |  TASK [display new tikv pid] ************************************************************************************************************************************************
2018-02-27 15:31:05,127 p=167835 u=qupeng |  ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 173091"
}
2018-02-27 15:31:05,138 p=167835 u=qupeng |  ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 173098"
}
2018-02-27 15:31:05,159 p=167835 u=qupeng |  ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 173113"
}
2018-02-27 15:31:05,183 p=167835 u=qupeng |  ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 173125"
}
2018-02-27 15:31:05,184 p=167835 u=qupeng |  ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 173136"
}
2018-02-27 15:31:05,191 p=167835 u=qupeng |  PLAY [tidb_servers] ********************************************************************************************************************************************************
2018-02-27 15:31:05,201 p=167835 u=qupeng |  TASK [clean pump .node file] ***********************************************************************************************************************************************
2018-02-27 15:31:05,222 p=167835 u=qupeng |  TASK [start pump by supervise] *********************************************************************************************************************************************
2018-02-27 15:31:05,245 p=167835 u=qupeng |  TASK [start pump by systemd] ***********************************************************************************************************************************************
2018-02-27 15:31:05,266 p=167835 u=qupeng |  TASK [start pump by systemd] ***********************************************************************************************************************************************
2018-02-27 15:31:05,288 p=167835 u=qupeng |  TASK [wait pump up] ********************************************************************************************************************************************************
2018-02-27 15:31:05,314 p=167835 u=qupeng |  TASK [start TiDB by supervise] *********************************************************************************************************************************************
2018-02-27 15:31:06,171 p=167835 u=qupeng |  changed: [tidb] => (item=tidb)
2018-02-27 15:31:06,183 p=167835 u=qupeng |  TASK [start TiDB by systemd] ***********************************************************************************************************************************************
2018-02-27 15:31:06,213 p=167835 u=qupeng |  TASK [start TiDB by systemd] ***********************************************************************************************************************************************
2018-02-27 15:31:06,248 p=167835 u=qupeng |  TASK [wait up] *************************************************************************************************************************************************************
2018-02-27 15:31:09,941 p=167835 u=qupeng |  ok: [tidb]
2018-02-27 15:31:09,949 p=167835 u=qupeng |  PLAY [grafana_servers] *****************************************************************************************************************************************************
2018-02-27 15:31:09,965 p=167835 u=qupeng |  TASK [common_dir : create deploy directories] ******************************************************************************************************************************
2018-02-27 15:31:10,020 p=167835 u=qupeng |  TASK [common_dir : create status directory] ********************************************************************************************************************************
2018-02-27 15:31:10,051 p=167835 u=qupeng |  TASK [common_dir : create deploy binary directory] *************************************************************************************************************************
2018-02-27 15:31:10,081 p=167835 u=qupeng |  TASK [common_dir : create docker image directory] **************************************************************************************************************************
2018-02-27 15:31:10,123 p=167835 u=qupeng |  TASK [grafana : include] ***************************************************************************************************************************************************
2018-02-27 15:31:10,148 p=167835 u=qupeng |  TASK [start grafana by supervise] ******************************************************************************************************************************************
2018-02-27 15:31:11,113 p=167835 u=qupeng |  changed: [172.16.21.1] => (item=grafana)
2018-02-27 15:31:11,127 p=167835 u=qupeng |  TASK [start grafana by systemd] ********************************************************************************************************************************************
2018-02-27 15:31:11,161 p=167835 u=qupeng |  TASK [start grafana by systemd] ********************************************************************************************************************************************
2018-02-27 15:31:11,192 p=167835 u=qupeng |  TASK [wait grafana up] *****************************************************************************************************************************************************
2018-02-27 15:32:11,985 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:32:12,001 p=167835 u=qupeng |  TASK [set_fact] ************************************************************************************************************************************************************
2018-02-27 15:32:12,087 p=167835 u=qupeng |  ok: [172.16.21.1]
2018-02-27 15:32:12,100 p=167835 u=qupeng |  TASK [import grafana data source] ******************************************************************************************************************************************
2018-02-27 15:32:13,000 p=167835 u=qupeng |  changed: [172.16.21.1]
2018-02-27 15:32:13,021 p=167835 u=qupeng |  TASK [import grafana dashboards - prepare config] **************************************************************************************************************************
2018-02-27 15:32:13,562 p=167835 u=qupeng |  changed: [172.16.21.1 -> localhost]
2018-02-27 15:32:13,582 p=167835 u=qupeng |  TASK [import grafana dashboards - run import script] ***********************************************************************************************************************
2018-02-27 15:32:14,624 p=167835 u=qupeng |  changed: [172.16.21.1 -> localhost]
2018-02-27 15:32:14,627 p=167835 u=qupeng |  PLAY RECAP *****************************************************************************************************************************************************************
2018-02-27 15:32:14,627 p=167835 u=qupeng |  172.16.21.1                : ok=18   changed=4    unreachable=0    failed=0   
2018-02-27 15:32:14,627 p=167835 u=qupeng |  localhost                  : ok=1    changed=0    unreachable=0    failed=0   
2018-02-27 15:32:14,628 p=167835 u=qupeng |  monitoring                 : ok=15   changed=1    unreachable=0    failed=0   
2018-02-27 15:32:14,628 p=167835 u=qupeng |  pd                         : ok=18   changed=3    unreachable=0    failed=0   
2018-02-27 15:32:14,628 p=167835 u=qupeng |  tidb                       : ok=14   changed=1    unreachable=0    failed=0   
2018-02-27 15:32:14,628 p=167835 u=qupeng |  tikv1                      : ok=16   changed=2    unreachable=0    failed=0   
2018-02-27 15:32:14,629 p=167835 u=qupeng |  tikv2                      : ok=16   changed=2    unreachable=0    failed=0   
2018-02-27 15:32:14,629 p=167835 u=qupeng |  tikv3                      : ok=16   changed=2    unreachable=0    failed=0   
2018-02-27 15:32:14,629 p=167835 u=qupeng |  tikv4                      : ok=16   changed=2    unreachable=0    failed=0   
2018-02-27 15:32:14,629 p=167835 u=qupeng |  tikv5                      : ok=16   changed=2    unreachable=0    failed=0   
2018-02-27 15:32:14,630 p=167835 u=qupeng |  Congrats! All goes well. :-)
