
PLAY [check config locally] ****************************************************

TASK [check_config_static : Ensure only one monitoring host exists] ************

TASK [check_config_static : Ensure monitored_servers exists] *******************

TASK [check_config_static : Ensure TiDB host exists] ***************************

TASK [check_config_static : Ensure PD host exists] *****************************

TASK [check_config_static : Ensure TiKV host exists] ***************************

TASK [check_config_static : Check ansible_user variable] ***********************

TASK [check_config_static : Ensure timezone variable is set] *******************

TASK [check_config_static : Close old SSH control master processes] ************
ok: [localhost]

TASK [check_config_static : Check ansible version] *****************************

TASK [check_config_static : Get if jmespath info[1]] ***************************
changed: [localhost]

TASK [check_config_static : Get if jinja2 exist[1]] ****************************
changed: [localhost]

TASK [check_config_static : Preflight check - Fail when jmespath or jinja2 doesn't exist] ***

TASK [check_config_static : Get jmespath info[2]] ******************************
changed: [localhost]

TASK [check_config_static : Get jmespath version] ******************************
ok: [localhost]

TASK [check_config_static : Get jinja2 info[2]] ********************************
changed: [localhost]

TASK [check_config_static : Get jinja2 version] ********************************
ok: [localhost]

TASK [check_config_static : Preflight check - Fail when the versions of jmespath and jinja2 doesn't meet the requirements] ***

PLAY [check system environment] ************************************************

TASK [check_system_dynamic : Disk space check - Fail task when disk is full] ***
ok: [tikv01]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv06]
ok: [tikv05]
ok: [tikv08]
ok: [tikv09]
ok: [tikv07]

TASK [check_system_dynamic : get facts] ****************************************
ok: [tikv03]
ok: [tikv01]
ok: [tikv04]
ok: [tikv02]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]

TASK [check_system_dynamic : Preflight check - Get hostnames of all nodes in cluster] ***
ok: [tikv01]

TASK [check_system_dynamic : Preflight check - Does every node in cluster have different hostname] ***

TASK [check_system_dynamic : Preflight check - Get NTP service status] *********

TASK [check_system_dynamic : Preflight check - NTP service] ********************

TASK [check_system_dynamic : Preflight check - Get umask] **********************
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv07]
ok: [tikv06]
ok: [tikv09]
ok: [tikv08]

TASK [check_system_dynamic : Preflight check - Does the system have a standard umask] ***

TASK [check_system_dynamic : Preflight check - Get maximum number of open file descriptors limit] ***
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]

TASK [check_system_dynamic : Preflight check - ulimit -n] **********************

TASK [check_system_dynamic : Preflight check - Check swap] *********************

PLAY [gather all facts, and check dest] ****************************************

TASK [check_config_dynamic : Set enable_binlog variable] ***********************

TASK [check_config_dynamic : Set deploy_dir if not set] ************************

TASK [check_config_dynamic : environment check (deploy dir)] *******************
ok: [pd3]
ok: [pd1]
ok: [pd4]
ok: [tikv01]
ok: [pd2]
ok: [pd5]
ok: [tikv03]
ok: [tikv04]
ok: [tikv02]
ok: [tikv05]
ok: [tikv09]
ok: [tikv06]
ok: [tikv08]
ok: [tidb1]
ok: [tikv07]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]

TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permission] ***

TASK [check_config_dynamic : environment check (supervise)] ********************

TASK [check_config_dynamic : config skip variables (default)] ******************
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]

TASK [check_config_dynamic : config skip variables] ****************************
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb3]
ok: [tidb2]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]

TASK [check_config_dynamic : config skip variables] ****************************

PLAY [Pre-check for rolling update] ********************************************

TASK [shell] *******************************************************************
changed: [tidb2]
changed: [tidb5]
changed: [tidb4]
changed: [tidb1]
changed: [tidb3]
changed: [tidb6]
changed: [tidb8]
changed: [tidb7]

TASK [Check whether can perform rolling update] ********************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv1

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [display pd addr] *********************************************************
ok: [tikv1] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv1] => {
    "tikv_addr": "tikv01:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv1

TASK [get store info from PD] **************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1] => (item=7)

TASK [display store id] ********************************************************
ok: [tikv1] => {
    "store_id": 7
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv1]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv1]

TASK [test1] *******************************************************************
changed: [tikv1]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv1] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv1]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv1]

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display old tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 11134"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv1] => (item=/data1/tikv_deploy/scripts)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)
ok: [tikv1] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv1] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv1] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv1] => (item=/data1/tikv_deploy/log)
ok: [tikv1] => (item=/data1/tikv_deploy/data)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv1

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv1]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv1]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv1] => (item={u'block_used': 17959378, u'uuid': u'6e380dc7-3be1-4757-b7fd-804a3f2988d1', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78131054, u'size_available': 320024797184, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24412263, u'device': u'/dev/nvme1n1', u'inode_used': 8089, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv1]

TASK [tikv : load default config] **********************************************
ok: [tikv1]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv1]

TASK [tikv : generate final config] ********************************************
ok: [tikv1]

TASK [tikv : debug] ************************************************************
ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv1]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1

TASK [tikv : deploy binary] ****************************************************
ok: [tikv1]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv1] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv1

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv1]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv1] => (item=start)
ok: [tikv1] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv1]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv1]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv1]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv1]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv1]

TASK [test3] *******************************************************************
changed: [tikv1]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv1]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display new tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 19905"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv2

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [display pd addr] *********************************************************
ok: [tikv2] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv2] => {
    "tikv_addr": "tikv02:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv2

TASK [get store info from PD] **************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2] => (item=1)

TASK [display store id] ********************************************************
ok: [tikv2] => {
    "store_id": 1
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv2]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv2]

TASK [test1] *******************************************************************
changed: [tikv2]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv2] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv2]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv2]

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display old tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 1586"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv2] => (item=/data1/tikv_deploy/scripts)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)
ok: [tikv2] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv2] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv2] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv2] => (item=/data1/tikv_deploy/log)
ok: [tikv2] => (item=/data1/tikv_deploy/data)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv2

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv2]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv2]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv2] => (item={u'block_used': 17588125, u'uuid': u'2141c006-4970-4003-b995-26687bb510e6', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78502307, u'size_available': 321545449472, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414245, u'device': u'/dev/nvme1n1', u'inode_used': 6107, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv2]

TASK [tikv : load default config] **********************************************
ok: [tikv2]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv2]

TASK [tikv : generate final config] ********************************************
ok: [tikv2]

TASK [tikv : debug] ************************************************************
ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv2]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv2

TASK [tikv : deploy binary] ****************************************************
ok: [tikv2]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv2] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv2

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv2]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv2] => (item=start)
ok: [tikv2] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv2]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv2]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv2]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv2]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv2]

TASK [test3] *******************************************************************
changed: [tikv2]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv2]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display new tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 7794"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv3

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [display pd addr] *********************************************************
ok: [tikv3] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv3] => {
    "tikv_addr": "tikv03:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv3

TASK [get store info from PD] **************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3] => (item=4)

TASK [display store id] ********************************************************
ok: [tikv3] => {
    "store_id": 4
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv3]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv3]

TASK [test1] *******************************************************************
changed: [tikv3]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv3] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv3]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv3]

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display old tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 1806"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv3] => (item=/data1/tikv_deploy/scripts)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)
ok: [tikv3] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv3] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv3] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv3] => (item=/data1/tikv_deploy/log)
ok: [tikv3] => (item=/data1/tikv_deploy/data)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv3

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv3]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv3]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv3] => (item={u'block_used': 17798271, u'uuid': u'83a54ad4-9ed8-4ebd-be4b-759f27b36f9d', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78292161, u'size_available': 320684691456, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414185, u'device': u'/dev/nvme1n1', u'inode_used': 6167, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv3]

TASK [tikv : load default config] **********************************************
ok: [tikv3]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv3]

TASK [tikv : generate final config] ********************************************
ok: [tikv3]

TASK [tikv : debug] ************************************************************
ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv3]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv3

TASK [tikv : deploy binary] ****************************************************
ok: [tikv3]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv3] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv3

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv3]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv3] => (item=start)
ok: [tikv3] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv3]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv3]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv3]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv3]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv3]

TASK [test3] *******************************************************************
changed: [tikv3]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv3]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display new tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 7965"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv4

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [display pd addr] *********************************************************
ok: [tikv4] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv4] => {
    "tikv_addr": "tikv04:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv4

TASK [get store info from PD] **************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4] => (item=6)

TASK [display store id] ********************************************************
ok: [tikv4] => {
    "store_id": 6
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv4]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv4]

TASK [test1] *******************************************************************
changed: [tikv4]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv4] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv4]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv4]

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display old tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 9441"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv4] => (item=/data1/tikv_deploy/scripts)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)
ok: [tikv4] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv4] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv4] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv4] => (item=/data1/tikv_deploy/log)
ok: [tikv4] => (item=/data1/tikv_deploy/data)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv4

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv4]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv4]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv4] => (item={u'block_used': 17559348, u'uuid': u'9d5d5a68-180e-4e12-a8d1-e3f78de24cf4', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78531084, u'size_available': 321663320064, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414235, u'device': u'/dev/nvme1n1', u'inode_used': 6117, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv4]

TASK [tikv : load default config] **********************************************
ok: [tikv4]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv4]

TASK [tikv : generate final config] ********************************************
ok: [tikv4]

TASK [tikv : debug] ************************************************************
ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv4]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv4

TASK [tikv : deploy binary] ****************************************************
ok: [tikv4]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv4] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv4

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv4]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv4] => (item=start)
ok: [tikv4] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv4]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv4]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv4]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv4]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv4]

TASK [test3] *******************************************************************
changed: [tikv4]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv4]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display new tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 15562"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv5

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [display pd addr] *********************************************************
ok: [tikv5] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv5] => {
    "tikv_addr": "tikv05:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv5

TASK [get store info from PD] **************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5] => (item=5)

TASK [display store id] ********************************************************
ok: [tikv5] => {
    "store_id": 5
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv5]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv5]

TASK [test1] *******************************************************************
changed: [tikv5]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv5] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv5]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv5]

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display old tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 30190"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv5] => (item=/data1/tikv_deploy/scripts)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)
ok: [tikv5] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv5] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv5] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv5] => (item=/data1/tikv_deploy/log)
ok: [tikv5] => (item=/data1/tikv_deploy/data)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv5

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv5]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv5]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv5] => (item={u'block_used': 17912359, u'uuid': u'6186f3ef-6434-4ada-ba3a-e1dffb1f4169', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78178073, u'size_available': 320217387008, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414148, u'device': u'/dev/nvme1n1', u'inode_used': 6204, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv5]

TASK [tikv : load default config] **********************************************
ok: [tikv5]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv5]

TASK [tikv : generate final config] ********************************************
ok: [tikv5]

TASK [tikv : debug] ************************************************************
ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv5]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv5

TASK [tikv : deploy binary] ****************************************************
ok: [tikv5]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv5] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv5

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv5]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv5] => (item=start)
ok: [tikv5] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv5]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv5]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv5]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv5]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv5]

TASK [test3] *******************************************************************
changed: [tikv5]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv5]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display new tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 3858"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv6

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [display pd addr] *********************************************************
ok: [tikv6] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv6] => {
    "tikv_addr": "tikv06:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv6

TASK [get store info from PD] **************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6] => (item=8)

TASK [display store id] ********************************************************
ok: [tikv6] => {
    "store_id": 8
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
FAILED - RETRYING: remove evict-leader-scheduler (3 retries left).
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv6]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv6]

TASK [test1] *******************************************************************
changed: [tikv6]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv6] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv6]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv6]

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display old tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 24767"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv6] => (item=/data1/tikv_deploy/scripts)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)
ok: [tikv6] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv6] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv6] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv6] => (item=/data1/tikv_deploy/log)
ok: [tikv6] => (item=/data1/tikv_deploy/data)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv6

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv6]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv6]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv6] => (item={u'block_used': 17733930, u'uuid': u'7234184e-6b77-44ff-bcfd-88d0e3b89503', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78356502, u'size_available': 320948232192, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414233, u'device': u'/dev/nvme1n1', u'inode_used': 6119, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv6]

TASK [tikv : load default config] **********************************************
ok: [tikv6]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv6]

TASK [tikv : generate final config] ********************************************
ok: [tikv6]

TASK [tikv : debug] ************************************************************
ok: [tikv6] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv6]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv6

TASK [tikv : deploy binary] ****************************************************
ok: [tikv6]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv6] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv6

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv6]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv6] => (item=start)
ok: [tikv6] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv6]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv6]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv6]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv6]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv6]

TASK [test3] *******************************************************************
changed: [tikv6]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv6]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display new tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 6733"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv7

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [display pd addr] *********************************************************
ok: [tikv7] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv7] => {
    "tikv_addr": "tikv07:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv7

TASK [get store info from PD] **************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7] => (item=48001)

TASK [display store id] ********************************************************
ok: [tikv7] => {
    "store_id": 48001
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv7]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv7]

TASK [test1] *******************************************************************
changed: [tikv7]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv7] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv7]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv7]

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display old tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 860"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv7] => (item=/data1/tikv_deploy/scripts)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)
ok: [tikv7] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv7] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv7] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv7] => (item=/data1/tikv_deploy/log)
ok: [tikv7] => (item=/data1/tikv_deploy/data)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv7

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv7]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv7]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv7] => (item={u'block_used': 18923050, u'uuid': u'3455a2c4-54d7-4e43-8469-aef6b82dcfcc', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77167382, u'size_available': 316077596672, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414204, u'device': u'/dev/nvme1n1', u'inode_used': 6148, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv7]

TASK [tikv : load default config] **********************************************
ok: [tikv7]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv7]

TASK [tikv : generate final config] ********************************************
ok: [tikv7]

TASK [tikv : debug] ************************************************************
ok: [tikv7] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv7]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv7

TASK [tikv : deploy binary] ****************************************************
ok: [tikv7]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv7] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv7

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv7]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv7] => (item=start)
ok: [tikv7] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv7]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv7]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv7]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv7]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv7]

TASK [test3] *******************************************************************
changed: [tikv7]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv7]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display new tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 14231"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv8

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [display pd addr] *********************************************************
ok: [tikv8] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv8] => {
    "tikv_addr": "tikv08:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv8

TASK [get store info from PD] **************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8] => (item=48003)

TASK [display store id] ********************************************************
ok: [tikv8] => {
    "store_id": 48003
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv8]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv8]

TASK [test1] *******************************************************************
changed: [tikv8]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv8] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv8]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv8]

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display old tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 1669"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv8] => (item=/data1/tikv_deploy/scripts)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)
ok: [tikv8] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv8] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv8] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv8] => (item=/data1/tikv_deploy/log)
ok: [tikv8] => (item=/data1/tikv_deploy/data)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv8

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv8]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv8]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv8] => (item={u'block_used': 18960417, u'uuid': u'202ec8e8-e079-4d78-b48c-2a7ddf13f31a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77130015, u'size_available': 315924541440, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414386, u'device': u'/dev/nvme1n1', u'inode_used': 5966, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv8]

TASK [tikv : load default config] **********************************************
ok: [tikv8]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv8]

TASK [tikv : generate final config] ********************************************
ok: [tikv8]

TASK [tikv : debug] ************************************************************
ok: [tikv8] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv8]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv8

TASK [tikv : deploy binary] ****************************************************
ok: [tikv8]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv8] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv8

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv8]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv8] => (item=start)
ok: [tikv8] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv8]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv8]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv8]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv8]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv8]

TASK [test3] *******************************************************************
changed: [tikv8]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv8]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display new tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 25440"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv9

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [display pd addr] *********************************************************
ok: [tikv9] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv9] => {
    "tikv_addr": "tikv09:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv9

TASK [get store info from PD] **************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9] => (item=48002)

TASK [display store id] ********************************************************
ok: [tikv9] => {
    "store_id": 48002
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv9]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv9]

TASK [test1] *******************************************************************
changed: [tikv9]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv9] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv9]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv9]

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display old tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 5817"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv9] => (item=/data1/tikv_deploy/scripts)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)
ok: [tikv9] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv9] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv9] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv9] => (item=/data1/tikv_deploy/log)
ok: [tikv9] => (item=/data1/tikv_deploy/data)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv9

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv9]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv9]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv9] => (item={u'block_used': 18256345, u'uuid': u'6d4b9a55-fc63-4eff-a750-1a99500e7a3a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77834087, u'size_available': 318808420352, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414188, u'device': u'/dev/nvme1n1', u'inode_used': 6164, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv9]

TASK [tikv : load default config] **********************************************
ok: [tikv9]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv9]

TASK [tikv : generate final config] ********************************************
ok: [tikv9]

TASK [tikv : debug] ************************************************************
ok: [tikv9] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv9]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv9

TASK [tikv : deploy binary] ****************************************************
ok: [tikv9]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv9] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv9

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv9]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv9] => (item=start)
ok: [tikv9] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv9]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv9]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv9]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv9]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv9]

TASK [test3] *******************************************************************
changed: [tikv9]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv9]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display new tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 19553"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update pump cluster] *********************************************
skipping: no hosts matched

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY RECAP *********************************************************************
localhost                  : ok=7    changed=4    unreachable=0    failed=0   
pd1                        : ok=3    changed=0    unreachable=0    failed=0   
pd2                        : ok=3    changed=0    unreachable=0    failed=0   
pd3                        : ok=3    changed=0    unreachable=0    failed=0   
pd4                        : ok=3    changed=0    unreachable=0    failed=0   
pd5                        : ok=3    changed=0    unreachable=0    failed=0   
tidb1                      : ok=4    changed=1    unreachable=0    failed=0   
tidb2                      : ok=4    changed=1    unreachable=0    failed=0   
tidb3                      : ok=4    changed=1    unreachable=0    failed=0   
tidb4                      : ok=4    changed=1    unreachable=0    failed=0   
tidb5                      : ok=4    changed=1    unreachable=0    failed=0   
tidb6                      : ok=4    changed=1    unreachable=0    failed=0   
tidb7                      : ok=4    changed=1    unreachable=0    failed=0   
tidb8                      : ok=4    changed=1    unreachable=0    failed=0   
tikv01                     : ok=8    changed=0    unreachable=0    failed=0   
tikv02                     : ok=7    changed=0    unreachable=0    failed=0   
tikv03                     : ok=7    changed=0    unreachable=0    failed=0   
tikv04                     : ok=7    changed=0    unreachable=0    failed=0   
tikv05                     : ok=7    changed=0    unreachable=0    failed=0   
tikv06                     : ok=7    changed=0    unreachable=0    failed=0   
tikv07                     : ok=7    changed=0    unreachable=0    failed=0   
tikv08                     : ok=7    changed=0    unreachable=0    failed=0   
tikv09                     : ok=7    changed=0    unreachable=0    failed=0   
tikv1                      : ok=53   changed=6    unreachable=0    failed=0   
tikv2                      : ok=53   changed=6    unreachable=0    failed=0   
tikv3                      : ok=53   changed=6    unreachable=0    failed=0   
tikv4                      : ok=53   changed=6    unreachable=0    failed=0   
tikv5                      : ok=53   changed=6    unreachable=0    failed=0   
tikv6                      : ok=53   changed=6    unreachable=0    failed=0   
tikv7                      : ok=53   changed=6    unreachable=0    failed=0   
tikv8                      : ok=53   changed=6    unreachable=0    failed=0   
tikv9                      : ok=53   changed=6    unreachable=0    failed=0   

Congrats! All goes well. :-)

PLAY [check config locally] ****************************************************

TASK [check_config_static : Ensure only one monitoring host exists] ************

TASK [check_config_static : Ensure monitored_servers exists] *******************

TASK [check_config_static : Ensure TiDB host exists] ***************************

TASK [check_config_static : Ensure PD host exists] *****************************

TASK [check_config_static : Ensure TiKV host exists] ***************************

TASK [check_config_static : Check ansible_user variable] ***********************

TASK [check_config_static : Ensure timezone variable is set] *******************

TASK [check_config_static : Close old SSH control master processes] ************
ok: [localhost]

TASK [check_config_static : Check ansible version] *****************************

TASK [check_config_static : Get if jmespath info[1]] ***************************
changed: [localhost]

TASK [check_config_static : Get if jinja2 exist[1]] ****************************
changed: [localhost]

TASK [check_config_static : Preflight check - Fail when jmespath or jinja2 doesn't exist] ***

TASK [check_config_static : Get jmespath info[2]] ******************************
changed: [localhost]

TASK [check_config_static : Get jmespath version] ******************************
ok: [localhost]

TASK [check_config_static : Get jinja2 info[2]] ********************************
changed: [localhost]

TASK [check_config_static : Get jinja2 version] ********************************
ok: [localhost]

TASK [check_config_static : Preflight check - Fail when the versions of jmespath and jinja2 doesn't meet the requirements] ***

PLAY [check system environment] ************************************************

TASK [check_system_dynamic : Disk space check - Fail task when disk is full] ***
ok: [tikv01]
ok: [tikv02]
ok: [tikv05]
ok: [tikv03]
ok: [tikv04]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]

TASK [check_system_dynamic : get facts] ****************************************
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv09]
ok: [tikv07]
ok: [tikv08]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Get hostnames of all nodes in cluster] ***
ok: [tikv01]

TASK [check_system_dynamic : Preflight check - Does every node in cluster have different hostname] ***

TASK [check_system_dynamic : Preflight check - Get NTP service status] *********

TASK [check_system_dynamic : Preflight check - NTP service] ********************

TASK [check_system_dynamic : Preflight check - Get umask] **********************
ok: [tikv01]
ok: [tikv03]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv07]
ok: [tikv06]
ok: [tikv09]
ok: [tikv08]

TASK [check_system_dynamic : Preflight check - Does the system have a standard umask] ***

TASK [check_system_dynamic : Preflight check - Get maximum number of open file descriptors limit] ***
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv07]
ok: [tikv06]
ok: [tikv09]
ok: [tikv08]

TASK [check_system_dynamic : Preflight check - ulimit -n] **********************

TASK [check_system_dynamic : Preflight check - Check swap] *********************

PLAY [gather all facts, and check dest] ****************************************

TASK [check_config_dynamic : Set enable_binlog variable] ***********************

TASK [check_config_dynamic : Set deploy_dir if not set] ************************

TASK [check_config_dynamic : environment check (deploy dir)] *******************
ok: [tidb2]
ok: [tikv01]
ok: [tidb4]
ok: [tidb1]
ok: [tidb3]
ok: [tidb6]
ok: [tidb8]
ok: [tidb5]
ok: [tidb7]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [tikv1]
ok: [pd4]
ok: [pd5]
ok: [tikv2]
ok: [tikv3]
ok: [tikv5]
ok: [tikv4]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv02]
ok: [tikv03]
ok: [tikv05]
ok: [tikv04]
ok: [tikv07]
ok: [tikv08]
ok: [tikv06]
ok: [tikv09]

TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permission] ***

TASK [check_config_dynamic : environment check (supervise)] ********************

TASK [check_config_dynamic : config skip variables (default)] ******************
ok: [tikv01]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb5]
ok: [tidb4]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]

TASK [check_config_dynamic : config skip variables] ****************************
ok: [tikv01]
ok: [tidb1]
ok: [tidb2]
ok: [tidb4]
ok: [tidb3]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd5]
ok: [pd4]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]

TASK [check_config_dynamic : config skip variables] ****************************

PLAY [Pre-check for rolling update] ********************************************

TASK [shell] *******************************************************************
changed: [tidb1]
changed: [tidb4]
changed: [tidb3]
changed: [tidb5]
changed: [tidb2]
changed: [tidb6]
changed: [tidb8]
changed: [tidb7]

TASK [Check whether can perform rolling update] ********************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv1

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [display pd addr] *********************************************************
ok: [tikv1] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv1] => {
    "tikv_addr": "tikv01:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv1

TASK [get store info from PD] **************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1] => (item=7)

TASK [display store id] ********************************************************
ok: [tikv1] => {
    "store_id": 7
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv1]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv1]

TASK [test1] *******************************************************************
changed: [tikv1]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv1] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv1]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv1]

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display old tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 19905"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv1] => (item=/data1/tikv_deploy/scripts)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)
ok: [tikv1] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv1] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv1] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv1] => (item=/data1/tikv_deploy/log)
ok: [tikv1] => (item=/data1/tikv_deploy/data)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv1

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv1]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv1]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv1] => (item={u'block_used': 18193950, u'uuid': u'6e380dc7-3be1-4757-b7fd-804a3f2988d1', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77896482, u'size_available': 319063990272, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24412104, u'device': u'/dev/nvme1n1', u'inode_used': 8248, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv1]

TASK [tikv : load default config] **********************************************
ok: [tikv1]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv1]

TASK [tikv : generate final config] ********************************************
ok: [tikv1]

TASK [tikv : debug] ************************************************************
ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv1]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1

TASK [tikv : deploy binary] ****************************************************
ok: [tikv1]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv1] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv1

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv1]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv1] => (item=start)
ok: [tikv1] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv1]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv1]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv1]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv1]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv1]

TASK [test3] *******************************************************************
changed: [tikv1]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv1]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display new tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 30338"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv2

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [display pd addr] *********************************************************
ok: [tikv2] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv2] => {
    "tikv_addr": "tikv02:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv2

TASK [get store info from PD] **************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2] => (item=1)

TASK [display store id] ********************************************************
ok: [tikv2] => {
    "store_id": 1
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv2]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv2]

TASK [test1] *******************************************************************
changed: [tikv2]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv2] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv2]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv2]

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display old tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 7794"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv2] => (item=/data1/tikv_deploy/scripts)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)
ok: [tikv2] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv2] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv2] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv2] => (item=/data1/tikv_deploy/log)
ok: [tikv2] => (item=/data1/tikv_deploy/data)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv2

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv2]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv2]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv2] => (item={u'block_used': 18403838, u'uuid': u'2141c006-4970-4003-b995-26687bb510e6', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77686594, u'size_available': 318204289024, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413952, u'device': u'/dev/nvme1n1', u'inode_used': 6400, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv2]

TASK [tikv : load default config] **********************************************
ok: [tikv2]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv2]

TASK [tikv : generate final config] ********************************************
ok: [tikv2]

TASK [tikv : debug] ************************************************************
ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv2]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv2

TASK [tikv : deploy binary] ****************************************************
ok: [tikv2]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv2] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv2

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv2]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv2] => (item=start)
ok: [tikv2] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv2]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv2]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv2]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv2]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv2]

TASK [test3] *******************************************************************
changed: [tikv2]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv2]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display new tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 14833"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv3

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [display pd addr] *********************************************************
ok: [tikv3] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv3] => {
    "tikv_addr": "tikv03:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv3

TASK [get store info from PD] **************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3] => (item=4)

TASK [display store id] ********************************************************
ok: [tikv3] => {
    "store_id": 4
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv3]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv3]

TASK [test1] *******************************************************************
changed: [tikv3]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv3] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv3]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv3]

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display old tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 7965"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv3] => (item=/data1/tikv_deploy/scripts)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)
ok: [tikv3] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv3] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv3] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv3] => (item=/data1/tikv_deploy/log)
ok: [tikv3] => (item=/data1/tikv_deploy/data)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv3

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv3]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv3]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv3] => (item={u'block_used': 18219985, u'uuid': u'83a54ad4-9ed8-4ebd-be4b-759f27b36f9d', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77870447, u'size_available': 318957350912, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413981, u'device': u'/dev/nvme1n1', u'inode_used': 6371, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv3]

TASK [tikv : load default config] **********************************************
ok: [tikv3]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv3]

TASK [tikv : generate final config] ********************************************
ok: [tikv3]

TASK [tikv : debug] ************************************************************
ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv3]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv3

TASK [tikv : deploy binary] ****************************************************
ok: [tikv3]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv3] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv3

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv3]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv3] => (item=start)
ok: [tikv3] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv3]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv3]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv3]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv3]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv3]

TASK [test3] *******************************************************************
changed: [tikv3]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv3]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display new tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 14929"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv4

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [display pd addr] *********************************************************
ok: [tikv4] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv4] => {
    "tikv_addr": "tikv04:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv4

TASK [get store info from PD] **************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4] => (item=6)

TASK [display store id] ********************************************************
ok: [tikv4] => {
    "store_id": 6
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv4]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv4]

TASK [test1] *******************************************************************
changed: [tikv4]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv4] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv4]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv4]

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display old tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 15562"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv4] => (item=/data1/tikv_deploy/scripts)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)
ok: [tikv4] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv4] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv4] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv4] => (item=/data1/tikv_deploy/log)
ok: [tikv4] => (item=/data1/tikv_deploy/data)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv4

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv4]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv4]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv4] => (item={u'block_used': 17858396, u'uuid': u'9d5d5a68-180e-4e12-a8d1-e3f78de24cf4', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78232036, u'size_available': 320438419456, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414066, u'device': u'/dev/nvme1n1', u'inode_used': 6286, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv4]

TASK [tikv : load default config] **********************************************
ok: [tikv4]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv4]

TASK [tikv : generate final config] ********************************************
ok: [tikv4]

TASK [tikv : debug] ************************************************************
ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv4]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv4

TASK [tikv : deploy binary] ****************************************************
ok: [tikv4]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv4] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv4

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv4]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv4] => (item=start)
ok: [tikv4] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv4]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv4]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv4]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv4]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv4]

TASK [test3] *******************************************************************
changed: [tikv4]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv4]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display new tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 22706"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv5

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [display pd addr] *********************************************************
ok: [tikv5] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv5] => {
    "tikv_addr": "tikv05:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv5

TASK [get store info from PD] **************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5] => (item=5)

TASK [display store id] ********************************************************
ok: [tikv5] => {
    "store_id": 5
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv5]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv5]

TASK [test1] *******************************************************************
changed: [tikv5]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv5] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv5]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv5]

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display old tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 3858"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv5] => (item=/data1/tikv_deploy/scripts)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)
ok: [tikv5] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv5] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv5] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv5] => (item=/data1/tikv_deploy/log)
ok: [tikv5] => (item=/data1/tikv_deploy/data)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv5

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv5]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv5]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv5] => (item={u'block_used': 17946164, u'uuid': u'6186f3ef-6434-4ada-ba3a-e1dffb1f4169', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78144268, u'size_available': 320078921728, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414078, u'device': u'/dev/nvme1n1', u'inode_used': 6274, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv5]

TASK [tikv : load default config] **********************************************
ok: [tikv5]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv5]

TASK [tikv : generate final config] ********************************************
ok: [tikv5]

TASK [tikv : debug] ************************************************************
ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv5]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv5

TASK [tikv : deploy binary] ****************************************************
ok: [tikv5]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv5] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv5

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv5]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv5] => (item=start)
ok: [tikv5] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv5]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv5]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv5]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv5]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv5]

TASK [test3] *******************************************************************
changed: [tikv5]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv5]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display new tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 10833"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv6

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [display pd addr] *********************************************************
ok: [tikv6] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv6] => {
    "tikv_addr": "tikv06:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv6

TASK [get store info from PD] **************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6] => (item=8)

TASK [display store id] ********************************************************
ok: [tikv6] => {
    "store_id": 8
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv6]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv6]

TASK [test1] *******************************************************************
changed: [tikv6]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv6] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv6]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv6]

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display old tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 6733"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv6] => (item=/data1/tikv_deploy/scripts)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)
ok: [tikv6] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv6] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv6] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv6] => (item=/data1/tikv_deploy/log)
ok: [tikv6] => (item=/data1/tikv_deploy/data)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv6

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv6]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv6]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv6] => (item={u'block_used': 18147606, u'uuid': u'7234184e-6b77-44ff-bcfd-88d0e3b89503', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77942826, u'size_available': 319253815296, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414053, u'device': u'/dev/nvme1n1', u'inode_used': 6299, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv6]

TASK [tikv : load default config] **********************************************
ok: [tikv6]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv6]

TASK [tikv : generate final config] ********************************************
ok: [tikv6]

TASK [tikv : debug] ************************************************************
ok: [tikv6] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv6]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv6

TASK [tikv : deploy binary] ****************************************************
ok: [tikv6]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv6] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv6

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv6]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv6] => (item=start)
ok: [tikv6] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv6]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv6]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv6]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv6]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv6]

TASK [test3] *******************************************************************
changed: [tikv6]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv6]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display new tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 13764"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv7

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [display pd addr] *********************************************************
ok: [tikv7] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv7] => {
    "tikv_addr": "tikv07:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv7

TASK [get store info from PD] **************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7] => (item=48001)

TASK [display store id] ********************************************************
ok: [tikv7] => {
    "store_id": 48001
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv7]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv7]

TASK [test1] *******************************************************************
changed: [tikv7]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv7] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv7]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv7]

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display old tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 14231"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv7] => (item=/data1/tikv_deploy/scripts)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)
ok: [tikv7] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv7] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv7] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv7] => (item=/data1/tikv_deploy/log)
ok: [tikv7] => (item=/data1/tikv_deploy/data)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv7

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv7]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv7]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv7] => (item={u'block_used': 19072851, u'uuid': u'3455a2c4-54d7-4e43-8469-aef6b82dcfcc', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77017581, u'size_available': 315464011776, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414126, u'device': u'/dev/nvme1n1', u'inode_used': 6226, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv7]

TASK [tikv : load default config] **********************************************
ok: [tikv7]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv7]

TASK [tikv : generate final config] ********************************************
ok: [tikv7]

TASK [tikv : debug] ************************************************************
ok: [tikv7] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv7]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv7

TASK [tikv : deploy binary] ****************************************************
ok: [tikv7]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv7] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv7

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv7]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv7] => (item=start)
ok: [tikv7] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv7]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv7]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv7]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv7]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv7]

TASK [test3] *******************************************************************
changed: [tikv7]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv7]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display new tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 21042"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv8

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [display pd addr] *********************************************************
ok: [tikv8] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv8] => {
    "tikv_addr": "tikv08:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv8

TASK [get store info from PD] **************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8] => (item=48003)

TASK [display store id] ********************************************************
ok: [tikv8] => {
    "store_id": 48003
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv8]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv8]

TASK [test1] *******************************************************************
changed: [tikv8]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv8] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv8]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv8]

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display old tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 25440"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv8] => (item=/data1/tikv_deploy/scripts)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)
ok: [tikv8] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv8] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv8] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv8] => (item=/data1/tikv_deploy/log)
ok: [tikv8] => (item=/data1/tikv_deploy/data)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv8

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv8]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv8]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv8] => (item={u'block_used': 19224053, u'uuid': u'202ec8e8-e079-4d78-b48c-2a7ddf13f31a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76866379, u'size_available': 314844688384, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414188, u'device': u'/dev/nvme1n1', u'inode_used': 6164, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv8]

TASK [tikv : load default config] **********************************************
ok: [tikv8]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv8]

TASK [tikv : generate final config] ********************************************
ok: [tikv8]

TASK [tikv : debug] ************************************************************
ok: [tikv8] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv8]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv8

TASK [tikv : deploy binary] ****************************************************
ok: [tikv8]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv8] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv8

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv8]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv8] => (item=start)
ok: [tikv8] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv8]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv8]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv8]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv8]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv8]

TASK [test3] *******************************************************************
changed: [tikv8]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv8]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display new tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 3378"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv9

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [display pd addr] *********************************************************
ok: [tikv9] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv9] => {
    "tikv_addr": "tikv09:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv9

TASK [get store info from PD] **************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9] => (item=48002)

TASK [display store id] ********************************************************
ok: [tikv9] => {
    "store_id": 48002
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv9]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv9]

TASK [test1] *******************************************************************
changed: [tikv9]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv9] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv9]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv9]

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display old tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 19553"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv9] => (item=/data1/tikv_deploy/scripts)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)
ok: [tikv9] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv9] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv9] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv9] => (item=/data1/tikv_deploy/log)
ok: [tikv9] => (item=/data1/tikv_deploy/data)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv9

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv9]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv9]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv9] => (item={u'block_used': 18274740, u'uuid': u'6d4b9a55-fc63-4eff-a750-1a99500e7a3a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77815692, u'size_available': 318733074432, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414035, u'device': u'/dev/nvme1n1', u'inode_used': 6317, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv9]

TASK [tikv : load default config] **********************************************
ok: [tikv9]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv9]

TASK [tikv : generate final config] ********************************************
ok: [tikv9]

TASK [tikv : debug] ************************************************************
ok: [tikv9] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv9]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv9

TASK [tikv : deploy binary] ****************************************************
ok: [tikv9]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv9] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv9

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv9]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv9] => (item=start)
ok: [tikv9] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv9]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv9]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv9]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv9]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv9]

TASK [test3] *******************************************************************
changed: [tikv9]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv9]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display new tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 26456"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update pump cluster] *********************************************
skipping: no hosts matched

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY RECAP *********************************************************************
localhost                  : ok=7    changed=4    unreachable=0    failed=0   
pd1                        : ok=3    changed=0    unreachable=0    failed=0   
pd2                        : ok=3    changed=0    unreachable=0    failed=0   
pd3                        : ok=3    changed=0    unreachable=0    failed=0   
pd4                        : ok=3    changed=0    unreachable=0    failed=0   
pd5                        : ok=3    changed=0    unreachable=0    failed=0   
tidb1                      : ok=4    changed=1    unreachable=0    failed=0   
tidb2                      : ok=4    changed=1    unreachable=0    failed=0   
tidb3                      : ok=4    changed=1    unreachable=0    failed=0   
tidb4                      : ok=4    changed=1    unreachable=0    failed=0   
tidb5                      : ok=4    changed=1    unreachable=0    failed=0   
tidb6                      : ok=4    changed=1    unreachable=0    failed=0   
tidb7                      : ok=4    changed=1    unreachable=0    failed=0   
tidb8                      : ok=4    changed=1    unreachable=0    failed=0   
tikv01                     : ok=8    changed=0    unreachable=0    failed=0   
tikv02                     : ok=7    changed=0    unreachable=0    failed=0   
tikv03                     : ok=7    changed=0    unreachable=0    failed=0   
tikv04                     : ok=7    changed=0    unreachable=0    failed=0   
tikv05                     : ok=7    changed=0    unreachable=0    failed=0   
tikv06                     : ok=7    changed=0    unreachable=0    failed=0   
tikv07                     : ok=7    changed=0    unreachable=0    failed=0   
tikv08                     : ok=7    changed=0    unreachable=0    failed=0   
tikv09                     : ok=7    changed=0    unreachable=0    failed=0   
tikv1                      : ok=53   changed=6    unreachable=0    failed=0   
tikv2                      : ok=53   changed=6    unreachable=0    failed=0   
tikv3                      : ok=53   changed=6    unreachable=0    failed=0   
tikv4                      : ok=53   changed=6    unreachable=0    failed=0   
tikv5                      : ok=53   changed=6    unreachable=0    failed=0   
tikv6                      : ok=53   changed=6    unreachable=0    failed=0   
tikv7                      : ok=53   changed=6    unreachable=0    failed=0   
tikv8                      : ok=53   changed=6    unreachable=0    failed=0   
tikv9                      : ok=53   changed=6    unreachable=0    failed=0   

Congrats! All goes well. :-)

PLAY [check config locally] ****************************************************

TASK [check_config_static : Ensure only one monitoring host exists] ************

TASK [check_config_static : Ensure monitored_servers exists] *******************

TASK [check_config_static : Ensure TiDB host exists] ***************************

TASK [check_config_static : Ensure PD host exists] *****************************

TASK [check_config_static : Ensure TiKV host exists] ***************************

TASK [check_config_static : Check ansible_user variable] ***********************

TASK [check_config_static : Ensure timezone variable is set] *******************

TASK [check_config_static : Close old SSH control master processes] ************
ok: [localhost]

TASK [check_config_static : Check ansible version] *****************************

TASK [check_config_static : Get if jmespath info[1]] ***************************
changed: [localhost]

TASK [check_config_static : Get if jinja2 exist[1]] ****************************
changed: [localhost]

TASK [check_config_static : Preflight check - Fail when jmespath or jinja2 doesn't exist] ***

TASK [check_config_static : Get jmespath info[2]] ******************************
changed: [localhost]

TASK [check_config_static : Get jmespath version] ******************************
ok: [localhost]

TASK [check_config_static : Get jinja2 info[2]] ********************************
changed: [localhost]

TASK [check_config_static : Get jinja2 version] ********************************
ok: [localhost]

TASK [check_config_static : Preflight check - Fail when the versions of jmespath and jinja2 doesn't meet the requirements] ***

PLAY [check system environment] ************************************************

TASK [check_system_dynamic : Disk space check - Fail task when disk is full] ***
ok: [tikv01]
ok: [tikv03]
ok: [tikv02]
ok: [tikv05]
ok: [tikv04]
ok: [tikv07]
ok: [tikv09]
ok: [tikv08]
ok: [tikv06]

TASK [check_system_dynamic : get facts] ****************************************
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Get hostnames of all nodes in cluster] ***
ok: [tikv01]

TASK [check_system_dynamic : Preflight check - Does every node in cluster have different hostname] ***

TASK [check_system_dynamic : Preflight check - Get NTP service status] *********

TASK [check_system_dynamic : Preflight check - NTP service] ********************

TASK [check_system_dynamic : Preflight check - Get umask] **********************
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv07]
ok: [tikv09]
ok: [tikv08]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Does the system have a standard umask] ***

TASK [check_system_dynamic : Preflight check - Get maximum number of open file descriptors limit] ***
ok: [tikv03]
ok: [tikv01]
ok: [tikv04]
ok: [tikv05]
ok: [tikv02]
ok: [tikv07]
ok: [tikv09]
ok: [tikv08]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - ulimit -n] **********************

TASK [check_system_dynamic : Preflight check - Check swap] *********************

PLAY [gather all facts, and check dest] ****************************************

TASK [check_config_dynamic : Set enable_binlog variable] ***********************

TASK [check_config_dynamic : Set deploy_dir if not set] ************************

TASK [check_config_dynamic : environment check (deploy dir)] *******************
ok: [pd2]
ok: [tikv01]
ok: [pd1]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv03]
ok: [tikv02]
ok: [tikv05]
ok: [tikv04]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tikv06]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb5]
ok: [tidb6]
ok: [tidb4]
ok: [tidb7]
ok: [tidb8]
ok: [tikv1]
ok: [tikv3]
ok: [tikv2]
ok: [tikv4]
ok: [tikv7]
ok: [tikv8]
ok: [tikv6]
ok: [tikv5]
ok: [tikv9]

TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permission] ***

TASK [check_config_dynamic : environment check (supervise)] ********************

TASK [check_config_dynamic : config skip variables (default)] ******************
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]

TASK [check_config_dynamic : config skip variables] ****************************
ok: [pd1]
ok: [tikv01]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb7]
ok: [tidb6]
ok: [tidb8]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]

TASK [check_config_dynamic : config skip variables] ****************************

PLAY [Pre-check for rolling update] ********************************************

TASK [shell] *******************************************************************
changed: [tidb2]
changed: [tidb1]
changed: [tidb3]
changed: [tidb5]
changed: [tidb4]
changed: [tidb6]
changed: [tidb7]
changed: [tidb8]

TASK [Check whether can perform rolling update] ********************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv1

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [display pd addr] *********************************************************
ok: [tikv1] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv1] => {
    "tikv_addr": "tikv01:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv1

TASK [get store info from PD] **************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1] => (item=7)

TASK [display store id] ********************************************************
ok: [tikv1] => {
    "store_id": 7
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv1

TASK [test0] *******************************************************************
changed: [tikv1]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv1]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv1]

TASK [test1] *******************************************************************
changed: [tikv1]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv1] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv1]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv1]

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display old tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 30338"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv1] => (item=/data1/tikv_deploy/scripts)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)
ok: [tikv1] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv1] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv1] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv1] => (item=/data1/tikv_deploy/log)
ok: [tikv1] => (item=/data1/tikv_deploy/data)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv1

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv1]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv1]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv1] => (item={u'block_used': 18965485, u'uuid': u'6e380dc7-3be1-4757-b7fd-804a3f2988d1', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77124947, u'size_available': 315903782912, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24411792, u'device': u'/dev/nvme1n1', u'inode_used': 8560, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv1]

TASK [tikv : load default config] **********************************************
ok: [tikv1]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv1]

TASK [tikv : generate final config] ********************************************
ok: [tikv1]

TASK [tikv : debug] ************************************************************
ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv1]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1

TASK [tikv : deploy binary] ****************************************************
ok: [tikv1]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv1] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv1

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv1]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv1] => (item=start)
ok: [tikv1] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv1]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv1]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv1]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv1]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv1]

TASK [test3] *******************************************************************
changed: [tikv1]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv1]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display new tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 8604"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv2

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [display pd addr] *********************************************************
ok: [tikv2] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv2] => {
    "tikv_addr": "tikv02:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv2

TASK [get store info from PD] **************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2] => (item=1)

TASK [display store id] ********************************************************
ok: [tikv2] => {
    "store_id": 1
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv2

TASK [test0] *******************************************************************
changed: [tikv2]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv2]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv2]

TASK [test1] *******************************************************************
changed: [tikv2]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv2] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv2]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv2]

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display old tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 14833"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv2] => (item=/data1/tikv_deploy/scripts)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)
ok: [tikv2] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv2] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv2] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv2] => (item=/data1/tikv_deploy/log)
ok: [tikv2] => (item=/data1/tikv_deploy/data)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv2

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv2]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv2]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv2] => (item={u'block_used': 18363285, u'uuid': u'2141c006-4970-4003-b995-26687bb510e6', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77727147, u'size_available': 318370394112, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413789, u'device': u'/dev/nvme1n1', u'inode_used': 6563, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv2]

TASK [tikv : load default config] **********************************************
ok: [tikv2]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv2]

TASK [tikv : generate final config] ********************************************
ok: [tikv2]

TASK [tikv : debug] ************************************************************
ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv2]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv2

TASK [tikv : deploy binary] ****************************************************
ok: [tikv2]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv2] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv2

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv2]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv2] => (item=start)
ok: [tikv2] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv2]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv2]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv2]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv2]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv2]

TASK [test3] *******************************************************************
changed: [tikv2]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv2]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display new tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 22450"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv3

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [display pd addr] *********************************************************
ok: [tikv3] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv3] => {
    "tikv_addr": "tikv03:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv3

TASK [get store info from PD] **************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3] => (item=4)

TASK [display store id] ********************************************************
ok: [tikv3] => {
    "store_id": 4
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv3

TASK [test0] *******************************************************************
changed: [tikv3]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv3]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv3]

TASK [test1] *******************************************************************
changed: [tikv3]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv3] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv3]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv3]

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display old tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 14929"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv3] => (item=/data1/tikv_deploy/scripts)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)
ok: [tikv3] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv3] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv3] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv3] => (item=/data1/tikv_deploy/log)
ok: [tikv3] => (item=/data1/tikv_deploy/data)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv3

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv3]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv3]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv3] => (item={u'block_used': 18391660, u'uuid': u'83a54ad4-9ed8-4ebd-be4b-759f27b36f9d', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77698772, u'size_available': 318254170112, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413823, u'device': u'/dev/nvme1n1', u'inode_used': 6529, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv3]

TASK [tikv : load default config] **********************************************
ok: [tikv3]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv3]

TASK [tikv : generate final config] ********************************************
ok: [tikv3]

TASK [tikv : debug] ************************************************************
ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv3]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv3

TASK [tikv : deploy binary] ****************************************************
ok: [tikv3]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv3] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv3

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv3]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv3] => (item=start)
ok: [tikv3] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv3]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv3]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv3]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv3]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv3]

TASK [test3] *******************************************************************
changed: [tikv3]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv3]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display new tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 22554"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv4

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [display pd addr] *********************************************************
ok: [tikv4] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv4] => {
    "tikv_addr": "tikv04:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv4

TASK [get store info from PD] **************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4] => (item=6)

TASK [display store id] ********************************************************
ok: [tikv4] => {
    "store_id": 6
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv4

TASK [test0] *******************************************************************
changed: [tikv4]

TASK [remove evict-leader-scheduler] *******************************************
 [WARNING]: sftp transfer mechanism failed on [tikv04]. Use ANSIBLE_DEBUG=1 to
see detailed information
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv4]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv4]

TASK [test1] *******************************************************************
changed: [tikv4]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv4] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv4]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv4]

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display old tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 22706"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv4] => (item=/data1/tikv_deploy/scripts)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)
ok: [tikv4] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv4] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv4] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv4] => (item=/data1/tikv_deploy/log)
ok: [tikv4] => (item=/data1/tikv_deploy/data)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv4

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv4]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv4]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv4] => (item={u'block_used': 18253555, u'uuid': u'9d5d5a68-180e-4e12-a8d1-e3f78de24cf4', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77836877, u'size_available': 318819848192, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413855, u'device': u'/dev/nvme1n1', u'inode_used': 6497, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv4]

TASK [tikv : load default config] **********************************************
ok: [tikv4]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv4]

TASK [tikv : generate final config] ********************************************
ok: [tikv4]

TASK [tikv : debug] ************************************************************
ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv4]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv4

TASK [tikv : deploy binary] ****************************************************
ok: [tikv4]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv4] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv4

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv4]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv4] => (item=start)
ok: [tikv4] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv4]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv4]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv4]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv4]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv4]

TASK [test3] *******************************************************************
changed: [tikv4]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv4]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display new tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 30301"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv5

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [display pd addr] *********************************************************
ok: [tikv5] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv5] => {
    "tikv_addr": "tikv05:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv5

TASK [get store info from PD] **************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5] => (item=5)

TASK [display store id] ********************************************************
ok: [tikv5] => {
    "store_id": 5
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv5

TASK [test0] *******************************************************************
changed: [tikv5]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv5]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv5]

TASK [test1] *******************************************************************
changed: [tikv5]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv5] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv5]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv5]

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display old tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 10833"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv5] => (item=/data1/tikv_deploy/scripts)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)
ok: [tikv5] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv5] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv5] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv5] => (item=/data1/tikv_deploy/log)
ok: [tikv5] => (item=/data1/tikv_deploy/data)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv5

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv5]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv5]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv5] => (item={u'block_used': 18431915, u'uuid': u'6186f3ef-6434-4ada-ba3a-e1dffb1f4169', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77658517, u'size_available': 318089285632, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413789, u'device': u'/dev/nvme1n1', u'inode_used': 6563, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv5]

TASK [tikv : load default config] **********************************************
ok: [tikv5]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv5]

TASK [tikv : generate final config] ********************************************
ok: [tikv5]

TASK [tikv : debug] ************************************************************
ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv5]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv5

TASK [tikv : deploy binary] ****************************************************
ok: [tikv5]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv5] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv5

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv5]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv5] => (item=start)
ok: [tikv5] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv5]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv5]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv5]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv5]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv5]

TASK [test3] *******************************************************************
changed: [tikv5]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv5]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display new tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 18570"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv6

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [display pd addr] *********************************************************
ok: [tikv6] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv6] => {
    "tikv_addr": "tikv06:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv6

TASK [get store info from PD] **************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6] => (item=8)

TASK [display store id] ********************************************************
ok: [tikv6] => {
    "store_id": 8
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv6

TASK [test0] *******************************************************************
changed: [tikv6]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv6]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv6]

TASK [test1] *******************************************************************
changed: [tikv6]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv6] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv6]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv6]

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display old tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 13764"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv6] => (item=/data1/tikv_deploy/scripts)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)
ok: [tikv6] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv6] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv6] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv6] => (item=/data1/tikv_deploy/log)
ok: [tikv6] => (item=/data1/tikv_deploy/data)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv6

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv6]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv6]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv6] => (item={u'block_used': 18837379, u'uuid': u'7234184e-6b77-44ff-bcfd-88d0e3b89503', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77253053, u'size_available': 316428505088, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413668, u'device': u'/dev/nvme1n1', u'inode_used': 6684, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv6]

TASK [tikv : load default config] **********************************************
ok: [tikv6]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv6]

TASK [tikv : generate final config] ********************************************
ok: [tikv6]

TASK [tikv : debug] ************************************************************
ok: [tikv6] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv6]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv6

TASK [tikv : deploy binary] ****************************************************
ok: [tikv6]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv6] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv6

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv6]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv6] => (item=start)
ok: [tikv6] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv6]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv6]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv6]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv6]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv6]

TASK [test3] *******************************************************************
changed: [tikv6]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv6]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display new tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 21677"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv7

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [display pd addr] *********************************************************
ok: [tikv7] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv7] => {
    "tikv_addr": "tikv07:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv7

TASK [get store info from PD] **************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7] => (item=48001)

TASK [display store id] ********************************************************
ok: [tikv7] => {
    "store_id": 48001
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv7

TASK [test0] *******************************************************************
changed: [tikv7]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv7]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv7]

TASK [test1] *******************************************************************
changed: [tikv7]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv7] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv7]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv7]

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display old tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 21042"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv7] => (item=/data1/tikv_deploy/scripts)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)
ok: [tikv7] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv7] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv7] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv7] => (item=/data1/tikv_deploy/log)
ok: [tikv7] => (item=/data1/tikv_deploy/data)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv7

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv7]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv7]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv7] => (item={u'block_used': 19360443, u'uuid': u'3455a2c4-54d7-4e43-8469-aef6b82dcfcc', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76729989, u'size_available': 314286034944, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413926, u'device': u'/dev/nvme1n1', u'inode_used': 6426, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv7]

TASK [tikv : load default config] **********************************************
ok: [tikv7]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv7]

TASK [tikv : generate final config] ********************************************
ok: [tikv7]

TASK [tikv : debug] ************************************************************
ok: [tikv7] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv7]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv7

TASK [tikv : deploy binary] ****************************************************
ok: [tikv7]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv7] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv7

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv7]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv7] => (item=start)
ok: [tikv7] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv7]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv7]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv7]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv7]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv7]

TASK [test3] *******************************************************************
changed: [tikv7]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv7]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display new tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 28859"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv8

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [display pd addr] *********************************************************
ok: [tikv8] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv8] => {
    "tikv_addr": "tikv08:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv8

TASK [get store info from PD] **************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8] => (item=48003)

TASK [display store id] ********************************************************
ok: [tikv8] => {
    "store_id": 48003
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv8

TASK [test0] *******************************************************************
changed: [tikv8]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv8]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv8]

TASK [test1] *******************************************************************
changed: [tikv8]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv8] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv8]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv8]

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display old tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 3378"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv8] => (item=/data1/tikv_deploy/scripts)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)
ok: [tikv8] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv8] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv8] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv8] => (item=/data1/tikv_deploy/log)
ok: [tikv8] => (item=/data1/tikv_deploy/data)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv8

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv8]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv8]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv8] => (item={u'block_used': 19467521, u'uuid': u'202ec8e8-e079-4d78-b48c-2a7ddf13f31a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76622911, u'size_available': 313847443456, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413909, u'device': u'/dev/nvme1n1', u'inode_used': 6443, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv8]

TASK [tikv : load default config] **********************************************
ok: [tikv8]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv8]

TASK [tikv : generate final config] ********************************************
ok: [tikv8]

TASK [tikv : debug] ************************************************************
ok: [tikv8] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv8]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv8

TASK [tikv : deploy binary] ****************************************************
ok: [tikv8]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv8] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv8

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv8]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv8] => (item=start)
ok: [tikv8] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv8]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv8]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv8]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv8]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv8]

TASK [test3] *******************************************************************
changed: [tikv8]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv8]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display new tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 15983"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv9

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [display pd addr] *********************************************************
ok: [tikv9] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv9] => {
    "tikv_addr": "tikv09:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv9

TASK [get store info from PD] **************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9] => (item=48002)

TASK [display store id] ********************************************************
ok: [tikv9] => {
    "store_id": 48002
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv9

TASK [test0] *******************************************************************
changed: [tikv9]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv9]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv9]

TASK [test1] *******************************************************************
changed: [tikv9]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv9] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv9]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv9]

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display old tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 26456"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv9] => (item=/data1/tikv_deploy/scripts)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)
ok: [tikv9] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv9] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv9] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv9] => (item=/data1/tikv_deploy/log)
ok: [tikv9] => (item=/data1/tikv_deploy/data)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv9

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv9]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv9]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv9] => (item={u'block_used': 18559595, u'uuid': u'6d4b9a55-fc63-4eff-a750-1a99500e7a3a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77530837, u'size_available': 317566308352, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413889, u'device': u'/dev/nvme1n1', u'inode_used': 6463, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv9]

TASK [tikv : load default config] **********************************************
ok: [tikv9]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv9]

TASK [tikv : generate final config] ********************************************
ok: [tikv9]

TASK [tikv : debug] ************************************************************
ok: [tikv9] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv9]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv9

TASK [tikv : deploy binary] ****************************************************
ok: [tikv9]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv9] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv9

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv9]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv9] => (item=start)
ok: [tikv9] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv9]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv9]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv9]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv9]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv9]

TASK [test3] *******************************************************************
changed: [tikv9]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv9]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display new tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 1946"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update pump cluster] *********************************************
skipping: no hosts matched

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY RECAP *********************************************************************
localhost                  : ok=7    changed=4    unreachable=0    failed=0   
pd1                        : ok=3    changed=0    unreachable=0    failed=0   
pd2                        : ok=3    changed=0    unreachable=0    failed=0   
pd3                        : ok=3    changed=0    unreachable=0    failed=0   
pd4                        : ok=3    changed=0    unreachable=0    failed=0   
pd5                        : ok=3    changed=0    unreachable=0    failed=0   
tidb1                      : ok=4    changed=1    unreachable=0    failed=0   
tidb2                      : ok=4    changed=1    unreachable=0    failed=0   
tidb3                      : ok=4    changed=1    unreachable=0    failed=0   
tidb4                      : ok=4    changed=1    unreachable=0    failed=0   
tidb5                      : ok=4    changed=1    unreachable=0    failed=0   
tidb6                      : ok=4    changed=1    unreachable=0    failed=0   
tidb7                      : ok=4    changed=1    unreachable=0    failed=0   
tidb8                      : ok=4    changed=1    unreachable=0    failed=0   
tikv01                     : ok=8    changed=0    unreachable=0    failed=0   
tikv02                     : ok=7    changed=0    unreachable=0    failed=0   
tikv03                     : ok=7    changed=0    unreachable=0    failed=0   
tikv04                     : ok=7    changed=0    unreachable=0    failed=0   
tikv05                     : ok=7    changed=0    unreachable=0    failed=0   
tikv06                     : ok=7    changed=0    unreachable=0    failed=0   
tikv07                     : ok=7    changed=0    unreachable=0    failed=0   
tikv08                     : ok=7    changed=0    unreachable=0    failed=0   
tikv09                     : ok=7    changed=0    unreachable=0    failed=0   
tikv1                      : ok=54   changed=7    unreachable=0    failed=0   
tikv2                      : ok=54   changed=7    unreachable=0    failed=0   
tikv3                      : ok=54   changed=7    unreachable=0    failed=0   
tikv4                      : ok=54   changed=7    unreachable=0    failed=0   
tikv5                      : ok=54   changed=7    unreachable=0    failed=0   
tikv6                      : ok=54   changed=7    unreachable=0    failed=0   
tikv7                      : ok=54   changed=7    unreachable=0    failed=0   
tikv8                      : ok=54   changed=7    unreachable=0    failed=0   
tikv9                      : ok=54   changed=7    unreachable=0    failed=0   

Congrats! All goes well. :-)

PLAY [check config locally] ****************************************************

TASK [check_config_static : Ensure only one monitoring host exists] ************

TASK [check_config_static : Ensure monitored_servers exists] *******************

TASK [check_config_static : Ensure TiDB host exists] ***************************

TASK [check_config_static : Ensure PD host exists] *****************************

TASK [check_config_static : Ensure TiKV host exists] ***************************

TASK [check_config_static : Check ansible_user variable] ***********************

TASK [check_config_static : Ensure timezone variable is set] *******************

TASK [check_config_static : Close old SSH control master processes] ************
ok: [localhost]

TASK [check_config_static : Check ansible version] *****************************

TASK [check_config_static : Get if jmespath info[1]] ***************************
changed: [localhost]

TASK [check_config_static : Get if jinja2 exist[1]] ****************************
changed: [localhost]

TASK [check_config_static : Preflight check - Fail when jmespath or jinja2 doesn't exist] ***

TASK [check_config_static : Get jmespath info[2]] ******************************
changed: [localhost]

TASK [check_config_static : Get jmespath version] ******************************
ok: [localhost]

TASK [check_config_static : Get jinja2 info[2]] ********************************
changed: [localhost]

TASK [check_config_static : Get jinja2 version] ********************************
ok: [localhost]

TASK [check_config_static : Preflight check - Fail when the versions of jmespath and jinja2 doesn't meet the requirements] ***

PLAY [check system environment] ************************************************

TASK [check_system_dynamic : Disk space check - Fail task when disk is full] ***
ok: [tikv01]
ok: [tikv02]
ok: [tikv05]
ok: [tikv04]
ok: [tikv03]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]

TASK [check_system_dynamic : get facts] ****************************************
ok: [tikv03]
ok: [tikv01]
ok: [tikv05]
ok: [tikv02]
ok: [tikv04]
ok: [tikv07]
ok: [tikv09]
ok: [tikv08]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Get hostnames of all nodes in cluster] ***
ok: [tikv01]

TASK [check_system_dynamic : Preflight check - Does every node in cluster have different hostname] ***

TASK [check_system_dynamic : Preflight check - Get NTP service status] *********

TASK [check_system_dynamic : Preflight check - NTP service] ********************

TASK [check_system_dynamic : Preflight check - Get umask] **********************
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv07]
ok: [tikv06]
ok: [tikv09]
ok: [tikv08]

TASK [check_system_dynamic : Preflight check - Does the system have a standard umask] ***

TASK [check_system_dynamic : Preflight check - Get maximum number of open file descriptors limit] ***
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv07]
ok: [tikv09]
ok: [tikv06]
ok: [tikv08]

TASK [check_system_dynamic : Preflight check - ulimit -n] **********************

TASK [check_system_dynamic : Preflight check - Check swap] *********************

PLAY [gather all facts, and check dest] ****************************************

TASK [check_config_dynamic : Set enable_binlog variable] ***********************

TASK [check_config_dynamic : Set deploy_dir if not set] ************************

TASK [check_config_dynamic : environment check (deploy dir)] *******************
ok: [tikv1]
ok: [tikv3]
ok: [tikv4]
ok: [tikv2]
ok: [tikv5]
ok: [tikv7]
ok: [tikv9]
ok: [tikv01]
ok: [tikv8]
ok: [tikv6]
ok: [pd2]
ok: [pd1]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv03]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb6]
ok: [tidb5]
ok: [tidb7]
ok: [tidb8]

TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permission] ***

TASK [check_config_dynamic : environment check (supervise)] ********************

TASK [check_config_dynamic : config skip variables (default)] ******************
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv01]
ok: [pd1]
ok: [pd3]
ok: [pd2]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]

TASK [check_config_dynamic : config skip variables] ****************************
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]

TASK [check_config_dynamic : config skip variables] ****************************

PLAY [Pre-check for rolling update] ********************************************

TASK [shell] *******************************************************************
changed: [tidb2]
changed: [tidb1]
changed: [tidb3]
changed: [tidb4]
changed: [tidb5]
changed: [tidb8]
changed: [tidb7]
changed: [tidb6]

TASK [Check whether can perform rolling update] ********************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv1

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [display pd addr] *********************************************************
ok: [tikv1] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv1] => {
    "tikv_addr": "tikv01:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv1

TASK [get store info from PD] **************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1] => (item=7)

TASK [display store id] ********************************************************
ok: [tikv1] => {
    "store_id": 7
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv1

TASK [test0] *******************************************************************
changed: [tikv1]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv1]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv1]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv1] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv1]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv1]

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display old tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 8604"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv1] => (item=/data1/tikv_deploy/scripts)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)
ok: [tikv1] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv1] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv1] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv1] => (item=/data1/tikv_deploy/log)
ok: [tikv1] => (item=/data1/tikv_deploy/data)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv1

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv1]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv1]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv1] => (item={u'block_used': 17547961, u'uuid': u'6e380dc7-3be1-4757-b7fd-804a3f2988d1', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78542471, u'size_available': 321709961216, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24412792, u'device': u'/dev/nvme1n1', u'inode_used': 7560, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv1]

TASK [tikv : load default config] **********************************************
ok: [tikv1]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv1]

TASK [tikv : generate final config] ********************************************
ok: [tikv1]

TASK [tikv : debug] ************************************************************
ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv1]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1

TASK [tikv : deploy binary] ****************************************************
ok: [tikv1]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv1] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv1

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv1]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv1] => (item=start)
ok: [tikv1] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv1]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv1]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv1]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv1]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv1]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display new tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 20734"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv2

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [display pd addr] *********************************************************
ok: [tikv2] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv2] => {
    "tikv_addr": "tikv02:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv2

TASK [get store info from PD] **************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2] => (item=1)

TASK [display store id] ********************************************************
ok: [tikv2] => {
    "store_id": 1
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv2

TASK [test0] *******************************************************************
changed: [tikv2]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv2]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv2]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv2] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv2]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv2]

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display old tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 22450"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv2] => (item=/data1/tikv_deploy/scripts)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)
ok: [tikv2] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv2] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv2] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv2] => (item=/data1/tikv_deploy/log)
ok: [tikv2] => (item=/data1/tikv_deploy/data)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv2

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv2]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv2]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv2] => (item={u'block_used': 17169171, u'uuid': u'2141c006-4970-4003-b995-26687bb510e6', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78921261, u'size_available': 323261485056, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414791, u'device': u'/dev/nvme1n1', u'inode_used': 5561, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv2]

TASK [tikv : load default config] **********************************************
ok: [tikv2]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv2]

TASK [tikv : generate final config] ********************************************
ok: [tikv2]

TASK [tikv : debug] ************************************************************
ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv2]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv2

TASK [tikv : deploy binary] ****************************************************
ok: [tikv2]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv2] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv2

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv2]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv2] => (item=start)
ok: [tikv2] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv2]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv2]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv2]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv2]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv2]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display new tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 11440"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv3

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [display pd addr] *********************************************************
ok: [tikv3] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv3] => {
    "tikv_addr": "tikv03:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv3

TASK [get store info from PD] **************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3] => (item=4)

TASK [display store id] ********************************************************
ok: [tikv3] => {
    "store_id": 4
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv3

TASK [test0] *******************************************************************
changed: [tikv3]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv3]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv3]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv3] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv3]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv3]

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display old tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 22554"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv3] => (item=/data1/tikv_deploy/scripts)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)
ok: [tikv3] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv3] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv3] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv3] => (item=/data1/tikv_deploy/log)
ok: [tikv3] => (item=/data1/tikv_deploy/data)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv3

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv3]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv3]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv3] => (item={u'block_used': 17292149, u'uuid': u'83a54ad4-9ed8-4ebd-be4b-759f27b36f9d', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78798283, u'size_available': 322757767168, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414702, u'device': u'/dev/nvme1n1', u'inode_used': 5650, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv3]

TASK [tikv : load default config] **********************************************
ok: [tikv3]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv3]

TASK [tikv : generate final config] ********************************************
ok: [tikv3]

TASK [tikv : debug] ************************************************************
ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv3]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv3

TASK [tikv : deploy binary] ****************************************************
ok: [tikv3]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv3] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv3

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv3]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv3] => (item=start)
ok: [tikv3] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv3]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv3]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv3]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv3]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv3]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display new tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 10816"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv4

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [display pd addr] *********************************************************
ok: [tikv4] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv4] => {
    "tikv_addr": "tikv04:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv4

TASK [get store info from PD] **************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4] => (item=6)

TASK [display store id] ********************************************************
ok: [tikv4] => {
    "store_id": 6
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv4

TASK [test0] *******************************************************************
changed: [tikv4]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv4]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv4]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv4] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv4]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv4]

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display old tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 30301"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv4] => (item=/data1/tikv_deploy/scripts)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)
ok: [tikv4] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv4] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv4] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv4] => (item=/data1/tikv_deploy/log)
ok: [tikv4] => (item=/data1/tikv_deploy/data)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv4

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv4]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv4]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv4] => (item={u'block_used': 17299612, u'uuid': u'9d5d5a68-180e-4e12-a8d1-e3f78de24cf4', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78790820, u'size_available': 322727198720, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414694, u'device': u'/dev/nvme1n1', u'inode_used': 5658, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv4]

TASK [tikv : load default config] **********************************************
ok: [tikv4]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv4]

TASK [tikv : generate final config] ********************************************
ok: [tikv4]

TASK [tikv : debug] ************************************************************
ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv4]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv4

TASK [tikv : deploy binary] ****************************************************
ok: [tikv4]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv4] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv4

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv4]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv4] => (item=start)
ok: [tikv4] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv4]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv4]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv4]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv4]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv4]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display new tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 18619"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv5

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [display pd addr] *********************************************************
ok: [tikv5] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv5] => {
    "tikv_addr": "tikv05:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv5

TASK [get store info from PD] **************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5] => (item=5)

TASK [display store id] ********************************************************
ok: [tikv5] => {
    "store_id": 5
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv5

TASK [test0] *******************************************************************
changed: [tikv5]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv5]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv5]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv5] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv5]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv5]

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display old tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 18570"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv5] => (item=/data1/tikv_deploy/scripts)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)
ok: [tikv5] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv5] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv5] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv5] => (item=/data1/tikv_deploy/log)
ok: [tikv5] => (item=/data1/tikv_deploy/data)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv5

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv5]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv5]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv5] => (item={u'block_used': 17357474, u'uuid': u'6186f3ef-6434-4ada-ba3a-e1dffb1f4169', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78732958, u'size_available': 322490195968, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414674, u'device': u'/dev/nvme1n1', u'inode_used': 5678, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv5]

TASK [tikv : load default config] **********************************************
ok: [tikv5]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv5]

TASK [tikv : generate final config] ********************************************
ok: [tikv5]

TASK [tikv : debug] ************************************************************
ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv5]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv5

TASK [tikv : deploy binary] ****************************************************
ok: [tikv5]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv5] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv5

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv5]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv5] => (item=start)
ok: [tikv5] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv5]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv5]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv5]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv5]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv5]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display new tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 6508"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv6

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [display pd addr] *********************************************************
ok: [tikv6] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv6] => {
    "tikv_addr": "tikv06:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv6

TASK [get store info from PD] **************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6] => (item=8)

TASK [display store id] ********************************************************
ok: [tikv6] => {
    "store_id": 8
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv6

TASK [test0] *******************************************************************
changed: [tikv6]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv6]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv6]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv6] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv6]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv6]

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display old tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 21677"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv6] => (item=/data1/tikv_deploy/scripts)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)
ok: [tikv6] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv6] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv6] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv6] => (item=/data1/tikv_deploy/log)
ok: [tikv6] => (item=/data1/tikv_deploy/data)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv6

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv6]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv6]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv6] => (item={u'block_used': 17629695, u'uuid': u'7234184e-6b77-44ff-bcfd-88d0e3b89503', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78460737, u'size_available': 321375178752, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414645, u'device': u'/dev/nvme1n1', u'inode_used': 5707, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv6]

TASK [tikv : load default config] **********************************************
ok: [tikv6]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv6]

TASK [tikv : generate final config] ********************************************
ok: [tikv6]

TASK [tikv : debug] ************************************************************
ok: [tikv6] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv6]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv6

TASK [tikv : deploy binary] ****************************************************
ok: [tikv6]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv6] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv6

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv6]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv6] => (item=start)
ok: [tikv6] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv6]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv6]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv6]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv6]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv6]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display new tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 10528"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv7

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [display pd addr] *********************************************************
ok: [tikv7] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv7] => {
    "tikv_addr": "tikv07:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv7

TASK [get store info from PD] **************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7] => (item=48001)

TASK [display store id] ********************************************************
ok: [tikv7] => {
    "store_id": 48001
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv7

TASK [test0] *******************************************************************
changed: [tikv7]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv7]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv7]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv7] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv7]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv7]

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display old tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 28859"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv7] => (item=/data1/tikv_deploy/scripts)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)
ok: [tikv7] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv7] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv7] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv7] => (item=/data1/tikv_deploy/log)
ok: [tikv7] => (item=/data1/tikv_deploy/data)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv7

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv7]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv7]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv7] => (item={u'block_used': 18072217, u'uuid': u'3455a2c4-54d7-4e43-8469-aef6b82dcfcc', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78018215, u'size_available': 319562608640, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414731, u'device': u'/dev/nvme1n1', u'inode_used': 5621, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv7]

TASK [tikv : load default config] **********************************************
ok: [tikv7]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv7]

TASK [tikv : generate final config] ********************************************
ok: [tikv7]

TASK [tikv : debug] ************************************************************
ok: [tikv7] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv7]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv7

TASK [tikv : deploy binary] ****************************************************
ok: [tikv7]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv7] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv7

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv7]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv7] => (item=start)
ok: [tikv7] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv7]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv7]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv7]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv7]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv7]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display new tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 16309"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv8

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [display pd addr] *********************************************************
ok: [tikv8] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv8] => {
    "tikv_addr": "tikv08:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv8

TASK [get store info from PD] **************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8] => (item=48003)

TASK [display store id] ********************************************************
ok: [tikv8] => {
    "store_id": 48003
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv8

TASK [test0] *******************************************************************
changed: [tikv8]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv8]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv8]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv8] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv8]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv8]

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display old tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 15983"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv8] => (item=/data1/tikv_deploy/scripts)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)
ok: [tikv8] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv8] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv8] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv8] => (item=/data1/tikv_deploy/log)
ok: [tikv8] => (item=/data1/tikv_deploy/data)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv8

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv8]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv8]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv8] => (item={u'block_used': 18794658, u'uuid': u'202ec8e8-e079-4d78-b48c-2a7ddf13f31a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77295774, u'size_available': 316603490304, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414683, u'device': u'/dev/nvme1n1', u'inode_used': 5669, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv8]

TASK [tikv : load default config] **********************************************
ok: [tikv8]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv8]

TASK [tikv : generate final config] ********************************************
ok: [tikv8]

TASK [tikv : debug] ************************************************************
ok: [tikv8] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv8]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv8

TASK [tikv : deploy binary] ****************************************************
ok: [tikv8]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv8] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv8

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv8]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv8] => (item=start)
ok: [tikv8] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv8]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv8]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv8]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv8]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv8]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display new tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 32523"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv9

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [display pd addr] *********************************************************
ok: [tikv9] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv9] => {
    "tikv_addr": "tikv09:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv9

TASK [get store info from PD] **************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9] => (item=48002)

TASK [display store id] ********************************************************
ok: [tikv9] => {
    "store_id": 48002
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv9

TASK [test0] *******************************************************************
changed: [tikv9]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv9]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv9]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv9] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv9]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv9]

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display old tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 1946"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv9] => (item=/data1/tikv_deploy/scripts)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)
ok: [tikv9] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv9] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv9] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv9] => (item=/data1/tikv_deploy/log)
ok: [tikv9] => (item=/data1/tikv_deploy/data)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv9

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv9]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv9]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv9] => (item={u'block_used': 18002344, u'uuid': u'6d4b9a55-fc63-4eff-a750-1a99500e7a3a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 78088088, u'size_available': 319848808448, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414566, u'device': u'/dev/nvme1n1', u'inode_used': 5786, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv9]

TASK [tikv : load default config] **********************************************
ok: [tikv9]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv9]

TASK [tikv : generate final config] ********************************************
ok: [tikv9]

TASK [tikv : debug] ************************************************************
ok: [tikv9] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv9]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv9

TASK [tikv : deploy binary] ****************************************************
ok: [tikv9]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv9] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv9

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv9]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv9] => (item=start)
ok: [tikv9] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv9]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv9]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv9]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv9]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv9]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display new tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 21608"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update pump cluster] *********************************************
skipping: no hosts matched

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY RECAP *********************************************************************
localhost                  : ok=7    changed=4    unreachable=0    failed=0   
pd1                        : ok=3    changed=0    unreachable=0    failed=0   
pd2                        : ok=3    changed=0    unreachable=0    failed=0   
pd3                        : ok=3    changed=0    unreachable=0    failed=0   
pd4                        : ok=3    changed=0    unreachable=0    failed=0   
pd5                        : ok=3    changed=0    unreachable=0    failed=0   
tidb1                      : ok=4    changed=1    unreachable=0    failed=0   
tidb2                      : ok=4    changed=1    unreachable=0    failed=0   
tidb3                      : ok=4    changed=1    unreachable=0    failed=0   
tidb4                      : ok=4    changed=1    unreachable=0    failed=0   
tidb5                      : ok=4    changed=1    unreachable=0    failed=0   
tidb6                      : ok=4    changed=1    unreachable=0    failed=0   
tidb7                      : ok=4    changed=1    unreachable=0    failed=0   
tidb8                      : ok=4    changed=1    unreachable=0    failed=0   
tikv01                     : ok=8    changed=0    unreachable=0    failed=0   
tikv02                     : ok=7    changed=0    unreachable=0    failed=0   
tikv03                     : ok=7    changed=0    unreachable=0    failed=0   
tikv04                     : ok=7    changed=0    unreachable=0    failed=0   
tikv05                     : ok=7    changed=0    unreachable=0    failed=0   
tikv06                     : ok=7    changed=0    unreachable=0    failed=0   
tikv07                     : ok=7    changed=0    unreachable=0    failed=0   
tikv08                     : ok=7    changed=0    unreachable=0    failed=0   
tikv09                     : ok=7    changed=0    unreachable=0    failed=0   
tikv1                      : ok=51   changed=4    unreachable=0    failed=0   
tikv2                      : ok=51   changed=4    unreachable=0    failed=0   
tikv3                      : ok=51   changed=4    unreachable=0    failed=0   
tikv4                      : ok=51   changed=4    unreachable=0    failed=0   
tikv5                      : ok=51   changed=4    unreachable=0    failed=0   
tikv6                      : ok=51   changed=4    unreachable=0    failed=0   
tikv7                      : ok=51   changed=4    unreachable=0    failed=0   
tikv8                      : ok=51   changed=4    unreachable=0    failed=0   
tikv9                      : ok=51   changed=4    unreachable=0    failed=0   

Congrats! All goes well. :-)

PLAY [check config locally] ****************************************************

TASK [check_config_static : Ensure only one monitoring host exists] ************

TASK [check_config_static : Ensure monitored_servers exists] *******************

TASK [check_config_static : Ensure TiDB host exists] ***************************

TASK [check_config_static : Ensure PD host exists] *****************************

TASK [check_config_static : Ensure TiKV host exists] ***************************

TASK [check_config_static : Check ansible_user variable] ***********************

TASK [check_config_static : Ensure timezone variable is set] *******************

TASK [check_config_static : Close old SSH control master processes] ************
ok: [localhost]

TASK [check_config_static : Check ansible version] *****************************

TASK [check_config_static : Get if jmespath info[1]] ***************************
changed: [localhost]

TASK [check_config_static : Get if jinja2 exist[1]] ****************************
changed: [localhost]

TASK [check_config_static : Preflight check - Fail when jmespath or jinja2 doesn't exist] ***

TASK [check_config_static : Get jmespath info[2]] ******************************
changed: [localhost]

TASK [check_config_static : Get jmespath version] ******************************
ok: [localhost]

TASK [check_config_static : Get jinja2 info[2]] ********************************
changed: [localhost]

TASK [check_config_static : Get jinja2 version] ********************************
ok: [localhost]

TASK [check_config_static : Preflight check - Fail when the versions of jmespath and jinja2 doesn't meet the requirements] ***

PLAY [check system environment] ************************************************

TASK [check_system_dynamic : Disk space check - Fail task when disk is full] ***
ok: [tikv01]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv09]
ok: [tikv08]
ok: [tikv07]
ok: [tikv06]

TASK [check_system_dynamic : get facts] ****************************************
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv08]
ok: [tikv09]
ok: [tikv07]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Get hostnames of all nodes in cluster] ***
ok: [tikv01]

TASK [check_system_dynamic : Preflight check - Does every node in cluster have different hostname] ***

TASK [check_system_dynamic : Preflight check - Get NTP service status] *********

TASK [check_system_dynamic : Preflight check - NTP service] ********************

TASK [check_system_dynamic : Preflight check - Get umask] **********************
ok: [tikv02]
ok: [tikv03]
ok: [tikv01]
ok: [tikv04]
ok: [tikv05]
ok: [tikv08]
ok: [tikv09]
ok: [tikv07]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Does the system have a standard umask] ***

TASK [check_system_dynamic : Preflight check - Get maximum number of open file descriptors limit] ***
ok: [tikv03]
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv05]
ok: [tikv08]
ok: [tikv07]
ok: [tikv09]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - ulimit -n] **********************

TASK [check_system_dynamic : Preflight check - Check swap] *********************

PLAY [gather all facts, and check dest] ****************************************

TASK [check_config_dynamic : Set enable_binlog variable] ***********************

TASK [check_config_dynamic : Set deploy_dir if not set] ************************

TASK [check_config_dynamic : environment check (deploy dir)] *******************
ok: [pd2]
ok: [pd1]
ok: [tikv01]
ok: [pd3]
ok: [pd4]
ok: [tikv03]
ok: [tikv02]
ok: [tikv04]
ok: [pd5]
ok: [tikv05]
ok: [tikv07]
ok: [tikv08]
ok: [tidb1]
ok: [tikv09]
ok: [tikv06]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb6]
ok: [tidb5]
ok: [tidb7]
ok: [tikv2]
ok: [tikv1]
ok: [tidb8]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv7]
ok: [tikv8]
ok: [tikv6]
ok: [tikv9]

TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permission] ***

TASK [check_config_dynamic : environment check (supervise)] ********************

TASK [check_config_dynamic : config skip variables (default)] ******************
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]

TASK [check_config_dynamic : config skip variables] ****************************
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb6]
ok: [tidb5]
ok: [tidb7]
ok: [tidb8]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]

TASK [check_config_dynamic : config skip variables] ****************************

PLAY [Pre-check for rolling update] ********************************************

TASK [shell] *******************************************************************
changed: [tidb2]
changed: [tidb1]
changed: [tidb3]
changed: [tidb4]
changed: [tidb5]
changed: [tidb7]
changed: [tidb6]
changed: [tidb8]

TASK [Check whether can perform rolling update] ********************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv1

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [display pd addr] *********************************************************
ok: [tikv1] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv1] => {
    "tikv_addr": "tikv01:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv1

TASK [get store info from PD] **************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1] => (item=7)

TASK [display store id] ********************************************************
ok: [tikv1] => {
    "store_id": 7
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv1

TASK [test0] *******************************************************************
changed: [tikv1]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv1]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv1]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv1] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv1]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv1]

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display old tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 20734"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv1] => (item=/data1/tikv_deploy/scripts)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)
ok: [tikv1] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv1] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv1] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv1] => (item=/data1/tikv_deploy/log)
ok: [tikv1] => (item=/data1/tikv_deploy/data)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv1

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv1]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv1]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv1] => (item={u'block_used': 19003687, u'uuid': u'6e380dc7-3be1-4757-b7fd-804a3f2988d1', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77086745, u'size_available': 315747307520, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24412123, u'device': u'/dev/nvme1n1', u'inode_used': 8229, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv1]

TASK [tikv : load default config] **********************************************
ok: [tikv1]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv1]

TASK [tikv : generate final config] ********************************************
ok: [tikv1]

TASK [tikv : debug] ************************************************************
ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv1]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1

TASK [tikv : deploy binary] ****************************************************
ok: [tikv1]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv1] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv1

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv1]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv1] => (item=start)
ok: [tikv1] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv1]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv1]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv1]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv1]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv1]

TASK [test3] *******************************************************************
changed: [tikv1]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv1]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display new tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 30912"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv2

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [display pd addr] *********************************************************
ok: [tikv2] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv2] => {
    "tikv_addr": "tikv02:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv2

TASK [get store info from PD] **************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2] => (item=1)

TASK [display store id] ********************************************************
ok: [tikv2] => {
    "store_id": 1
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv2

TASK [test0] *******************************************************************
changed: [tikv2]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv2]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv2]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv2] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv2]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv2]

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display old tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 11440"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv2] => (item=/data1/tikv_deploy/scripts)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)
ok: [tikv2] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv2] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv2] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv2] => (item=/data1/tikv_deploy/log)
ok: [tikv2] => (item=/data1/tikv_deploy/data)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv2

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv2]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv2]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv2] => (item={u'block_used': 18344433, u'uuid': u'2141c006-4970-4003-b995-26687bb510e6', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77745999, u'size_available': 318447611904, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414115, u'device': u'/dev/nvme1n1', u'inode_used': 6237, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv2]

TASK [tikv : load default config] **********************************************
ok: [tikv2]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv2]

TASK [tikv : generate final config] ********************************************
ok: [tikv2]

TASK [tikv : debug] ************************************************************
ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv2]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv2

TASK [tikv : deploy binary] ****************************************************
ok: [tikv2]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv2] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv2

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv2]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv2] => (item=start)
ok: [tikv2] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv2]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv2]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv2]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv2]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv2]

TASK [test3] *******************************************************************
changed: [tikv2]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv2]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display new tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 18478"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv3

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [display pd addr] *********************************************************
ok: [tikv3] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv3] => {
    "tikv_addr": "tikv03:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv3

TASK [get store info from PD] **************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3] => (item=4)

TASK [display store id] ********************************************************
ok: [tikv3] => {
    "store_id": 4
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv3

TASK [test0] *******************************************************************
changed: [tikv3]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv3]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv3]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv3] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv3]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv3]

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display old tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 10816"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv3] => (item=/data1/tikv_deploy/scripts)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)
ok: [tikv3] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv3] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv3] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv3] => (item=/data1/tikv_deploy/log)
ok: [tikv3] => (item=/data1/tikv_deploy/data)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv3

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv3]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv3]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv3] => (item={u'block_used': 18480401, u'uuid': u'83a54ad4-9ed8-4ebd-be4b-759f27b36f9d', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77610031, u'size_available': 317890686976, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24414031, u'device': u'/dev/nvme1n1', u'inode_used': 6321, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv3]

TASK [tikv : load default config] **********************************************
ok: [tikv3]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv3]

TASK [tikv : generate final config] ********************************************
ok: [tikv3]

TASK [tikv : debug] ************************************************************
ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv3]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv3

TASK [tikv : deploy binary] ****************************************************
ok: [tikv3]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv3] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv3

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv3]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv3] => (item=start)
ok: [tikv3] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv3]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv3]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv3]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv3]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv3]

TASK [test3] *******************************************************************
changed: [tikv3]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv3]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display new tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 17849"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv4

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [display pd addr] *********************************************************
ok: [tikv4] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv4] => {
    "tikv_addr": "tikv04:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv4

TASK [get store info from PD] **************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4] => (item=6)

TASK [display store id] ********************************************************
ok: [tikv4] => {
    "store_id": 6
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv4

TASK [test0] *******************************************************************
changed: [tikv4]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv4]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv4]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv4] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv4]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv4]

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display old tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 18619"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv4] => (item=/data1/tikv_deploy/scripts)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)
ok: [tikv4] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv4] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv4] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv4] => (item=/data1/tikv_deploy/log)
ok: [tikv4] => (item=/data1/tikv_deploy/data)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv4

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv4]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv4]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv4] => (item={u'block_used': 18364588, u'uuid': u'9d5d5a68-180e-4e12-a8d1-e3f78de24cf4', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77725844, u'size_available': 318365057024, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413994, u'device': u'/dev/nvme1n1', u'inode_used': 6358, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv4]

TASK [tikv : load default config] **********************************************
ok: [tikv4]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv4]

TASK [tikv : generate final config] ********************************************
ok: [tikv4]

TASK [tikv : debug] ************************************************************
ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv4]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv4

TASK [tikv : deploy binary] ****************************************************
ok: [tikv4]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv4] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv4

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv4]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv4] => (item=start)
ok: [tikv4] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv4]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv4]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv4]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv4]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv4]

TASK [test3] *******************************************************************
changed: [tikv4]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv4]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display new tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 25720"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv5

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [display pd addr] *********************************************************
ok: [tikv5] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv5] => {
    "tikv_addr": "tikv05:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv5

TASK [get store info from PD] **************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5] => (item=5)

TASK [display store id] ********************************************************
ok: [tikv5] => {
    "store_id": 5
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv5

TASK [test0] *******************************************************************
changed: [tikv5]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv5]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv5]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv5] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv5]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv5]

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display old tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 6508"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv5] => (item=/data1/tikv_deploy/scripts)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)
ok: [tikv5] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv5] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv5] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv5] => (item=/data1/tikv_deploy/log)
ok: [tikv5] => (item=/data1/tikv_deploy/data)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv5

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv5]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv5]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv5] => (item={u'block_used': 18590816, u'uuid': u'6186f3ef-6434-4ada-ba3a-e1dffb1f4169', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77499616, u'size_available': 317438427136, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413965, u'device': u'/dev/nvme1n1', u'inode_used': 6387, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv5]

TASK [tikv : load default config] **********************************************
ok: [tikv5]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv5]

TASK [tikv : generate final config] ********************************************
ok: [tikv5]

TASK [tikv : debug] ************************************************************
ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv5]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv5

TASK [tikv : deploy binary] ****************************************************
ok: [tikv5]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv5] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv5

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv5]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv5] => (item=start)
ok: [tikv5] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv5]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv5]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv5]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv5]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv5]

TASK [test3] *******************************************************************
changed: [tikv5]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv5]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display new tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 13787"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv6

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [display pd addr] *********************************************************
ok: [tikv6] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv6] => {
    "tikv_addr": "tikv06:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv6

TASK [get store info from PD] **************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6] => (item=8)

TASK [display store id] ********************************************************
ok: [tikv6] => {
    "store_id": 8
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv6

TASK [test0] *******************************************************************
changed: [tikv6]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv6]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv6]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv6] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv6]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv6]

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display old tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 10528"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv6] => (item=/data1/tikv_deploy/scripts)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)
ok: [tikv6] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv6] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv6] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv6] => (item=/data1/tikv_deploy/log)
ok: [tikv6] => (item=/data1/tikv_deploy/data)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv6

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv6]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv6]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv6] => (item={u'block_used': 18692164, u'uuid': u'7234184e-6b77-44ff-bcfd-88d0e3b89503', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77398268, u'size_available': 317023305728, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413932, u'device': u'/dev/nvme1n1', u'inode_used': 6420, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv6]

TASK [tikv : load default config] **********************************************
ok: [tikv6]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv6]

TASK [tikv : generate final config] ********************************************
ok: [tikv6]

TASK [tikv : debug] ************************************************************
ok: [tikv6] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv6]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv6

TASK [tikv : deploy binary] ****************************************************
ok: [tikv6]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv6] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv6

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv6]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv6] => (item=start)
ok: [tikv6] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv6]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv6]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv6]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv6]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv6]

TASK [test3] *******************************************************************
changed: [tikv6]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv6]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display new tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 18098"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv7

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [display pd addr] *********************************************************
ok: [tikv7] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv7] => {
    "tikv_addr": "tikv07:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv7

TASK [get store info from PD] **************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7] => (item=48001)

TASK [display store id] ********************************************************
ok: [tikv7] => {
    "store_id": 48001
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv7

TASK [test0] *******************************************************************
changed: [tikv7]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv7]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv7]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv7] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv7]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv7]

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display old tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 16309"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv7] => (item=/data1/tikv_deploy/scripts)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)
ok: [tikv7] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv7] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv7] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv7] => (item=/data1/tikv_deploy/log)
ok: [tikv7] => (item=/data1/tikv_deploy/data)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv7

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv7]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv7]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv7] => (item={u'block_used': 19251693, u'uuid': u'3455a2c4-54d7-4e43-8469-aef6b82dcfcc', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76838739, u'size_available': 314731474944, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413974, u'device': u'/dev/nvme1n1', u'inode_used': 6378, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv7]

TASK [tikv : load default config] **********************************************
ok: [tikv7]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv7]

TASK [tikv : generate final config] ********************************************
ok: [tikv7]

TASK [tikv : debug] ************************************************************
ok: [tikv7] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv7]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv7

TASK [tikv : deploy binary] ****************************************************
ok: [tikv7]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv7] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv7

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv7]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv7] => (item=start)
ok: [tikv7] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv7]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv7]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv7]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv7]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv7]

TASK [test3] *******************************************************************
changed: [tikv7]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv7]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display new tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 23848"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv8

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [display pd addr] *********************************************************
ok: [tikv8] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv8] => {
    "tikv_addr": "tikv08:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv8

TASK [get store info from PD] **************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8] => (item=48003)

TASK [display store id] ********************************************************
ok: [tikv8] => {
    "store_id": 48003
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv8

TASK [test0] *******************************************************************
changed: [tikv8]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv8]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv8]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv8] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv8]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv8]

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display old tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 32523"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv8] => (item=/data1/tikv_deploy/scripts)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)
ok: [tikv8] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv8] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv8] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv8] => (item=/data1/tikv_deploy/log)
ok: [tikv8] => (item=/data1/tikv_deploy/data)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv8

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv8]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv8]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv8] => (item={u'block_used': 19850529, u'uuid': u'202ec8e8-e079-4d78-b48c-2a7ddf13f31a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76239903, u'size_available': 312278642688, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413981, u'device': u'/dev/nvme1n1', u'inode_used': 6371, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv8]

TASK [tikv : load default config] **********************************************
ok: [tikv8]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv8]

TASK [tikv : generate final config] ********************************************
ok: [tikv8]

TASK [tikv : debug] ************************************************************
ok: [tikv8] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv8]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv8

TASK [tikv : deploy binary] ****************************************************
ok: [tikv8]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv8] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv8

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv8]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv8] => (item=start)
ok: [tikv8] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv8]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv8]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv8]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv8]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv8]

TASK [test3] *******************************************************************
changed: [tikv8]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv8]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display new tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 12437"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv9

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [display pd addr] *********************************************************
ok: [tikv9] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv9] => {
    "tikv_addr": "tikv09:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv9

TASK [get store info from PD] **************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9] => (item=48002)

TASK [display store id] ********************************************************
ok: [tikv9] => {
    "store_id": 48002
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv9

TASK [test0] *******************************************************************
changed: [tikv9]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv9]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv9]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv9] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv9]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv9]

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display old tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 21608"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv9] => (item=/data1/tikv_deploy/scripts)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)
ok: [tikv9] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv9] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv9] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv9] => (item=/data1/tikv_deploy/log)
ok: [tikv9] => (item=/data1/tikv_deploy/data)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv9

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv9]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv9]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv9] => (item={u'block_used': 18882494, u'uuid': u'6d4b9a55-fc63-4eff-a750-1a99500e7a3a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 77207938, u'size_available': 316243714048, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413823, u'device': u'/dev/nvme1n1', u'inode_used': 6529, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv9]

TASK [tikv : load default config] **********************************************
ok: [tikv9]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv9]

TASK [tikv : generate final config] ********************************************
ok: [tikv9]

TASK [tikv : debug] ************************************************************
ok: [tikv9] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv9]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv9

TASK [tikv : deploy binary] ****************************************************
ok: [tikv9]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv9] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv9

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv9]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv9] => (item=start)
ok: [tikv9] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv9]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv9]

TASK [start TiKV by supervise] *************************************************

TASK [test2] *******************************************************************
changed: [tikv9]

TASK [start TiKV by systemd] ***************************************************
changed: [tikv9]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv9]

TASK [test3] *******************************************************************
changed: [tikv9]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv9]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display new tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 29679"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update pump cluster] *********************************************
skipping: no hosts matched

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY RECAP *********************************************************************
localhost                  : ok=7    changed=4    unreachable=0    failed=0   
pd1                        : ok=3    changed=0    unreachable=0    failed=0   
pd2                        : ok=3    changed=0    unreachable=0    failed=0   
pd3                        : ok=3    changed=0    unreachable=0    failed=0   
pd4                        : ok=3    changed=0    unreachable=0    failed=0   
pd5                        : ok=3    changed=0    unreachable=0    failed=0   
tidb1                      : ok=4    changed=1    unreachable=0    failed=0   
tidb2                      : ok=4    changed=1    unreachable=0    failed=0   
tidb3                      : ok=4    changed=1    unreachable=0    failed=0   
tidb4                      : ok=4    changed=1    unreachable=0    failed=0   
tidb5                      : ok=4    changed=1    unreachable=0    failed=0   
tidb6                      : ok=4    changed=1    unreachable=0    failed=0   
tidb7                      : ok=4    changed=1    unreachable=0    failed=0   
tidb8                      : ok=4    changed=1    unreachable=0    failed=0   
tikv01                     : ok=8    changed=0    unreachable=0    failed=0   
tikv02                     : ok=7    changed=0    unreachable=0    failed=0   
tikv03                     : ok=7    changed=0    unreachable=0    failed=0   
tikv04                     : ok=7    changed=0    unreachable=0    failed=0   
tikv05                     : ok=7    changed=0    unreachable=0    failed=0   
tikv06                     : ok=7    changed=0    unreachable=0    failed=0   
tikv07                     : ok=7    changed=0    unreachable=0    failed=0   
tikv08                     : ok=7    changed=0    unreachable=0    failed=0   
tikv09                     : ok=7    changed=0    unreachable=0    failed=0   
tikv1                      : ok=53   changed=6    unreachable=0    failed=0   
tikv2                      : ok=53   changed=6    unreachable=0    failed=0   
tikv3                      : ok=53   changed=6    unreachable=0    failed=0   
tikv4                      : ok=53   changed=6    unreachable=0    failed=0   
tikv5                      : ok=53   changed=6    unreachable=0    failed=0   
tikv6                      : ok=53   changed=6    unreachable=0    failed=0   
tikv7                      : ok=53   changed=6    unreachable=0    failed=0   
tikv8                      : ok=53   changed=6    unreachable=0    failed=0   
tikv9                      : ok=53   changed=6    unreachable=0    failed=0   

Congrats! All goes well. :-)

PLAY [check config locally] ****************************************************

TASK [check_config_static : Ensure only one monitoring host exists] ************

TASK [check_config_static : Ensure monitored_servers exists] *******************

TASK [check_config_static : Ensure TiDB host exists] ***************************

TASK [check_config_static : Ensure PD host exists] *****************************

TASK [check_config_static : Ensure TiKV host exists] ***************************

TASK [check_config_static : Check ansible_user variable] ***********************

TASK [check_config_static : Ensure timezone variable is set] *******************

TASK [check_config_static : Close old SSH control master processes] ************
ok: [localhost]

TASK [check_config_static : Check ansible version] *****************************

TASK [check_config_static : Get if jmespath info[1]] ***************************
changed: [localhost]

TASK [check_config_static : Get if jinja2 exist[1]] ****************************
changed: [localhost]

TASK [check_config_static : Preflight check - Fail when jmespath or jinja2 doesn't exist] ***

TASK [check_config_static : Get jmespath info[2]] ******************************
changed: [localhost]

TASK [check_config_static : Get jmespath version] ******************************
ok: [localhost]

TASK [check_config_static : Get jinja2 info[2]] ********************************
changed: [localhost]

TASK [check_config_static : Get jinja2 version] ********************************
ok: [localhost]

TASK [check_config_static : Preflight check - Fail when the versions of jmespath and jinja2 doesn't meet the requirements] ***

PLAY [check system environment] ************************************************

TASK [check_system_dynamic : Disk space check - Fail task when disk is full] ***
ok: [tikv01]
ok: [tikv02]
ok: [tikv04]
ok: [tikv03]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]

TASK [check_system_dynamic : get facts] ****************************************
ok: [tikv02]
ok: [tikv01]
ok: [tikv04]
ok: [tikv03]
ok: [tikv05]
ok: [tikv08]
ok: [tikv07]
ok: [tikv09]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Get hostnames of all nodes in cluster] ***
ok: [tikv01]

TASK [check_system_dynamic : Preflight check - Does every node in cluster have different hostname] ***

TASK [check_system_dynamic : Preflight check - Get NTP service status] *********

TASK [check_system_dynamic : Preflight check - NTP service] ********************

TASK [check_system_dynamic : Preflight check - Get umask] **********************
ok: [tikv02]
ok: [tikv03]
ok: [tikv01]
ok: [tikv04]
ok: [tikv05]
ok: [tikv08]
ok: [tikv07]
ok: [tikv09]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - Does the system have a standard umask] ***

TASK [check_system_dynamic : Preflight check - Get maximum number of open file descriptors limit] ***
ok: [tikv01]
ok: [tikv03]
ok: [tikv04]
ok: [tikv02]
ok: [tikv05]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tikv06]

TASK [check_system_dynamic : Preflight check - ulimit -n] **********************

TASK [check_system_dynamic : Preflight check - Check swap] *********************

PLAY [gather all facts, and check dest] ****************************************

TASK [check_config_dynamic : Set enable_binlog variable] ***********************

TASK [check_config_dynamic : Set deploy_dir if not set] ************************

TASK [check_config_dynamic : environment check (deploy dir)] *******************
ok: [tikv01]
ok: [pd2]
ok: [pd1]
ok: [pd3]
ok: [pd4]
ok: [tikv1]
ok: [tikv3]
ok: [tikv2]
ok: [tikv4]
ok: [pd5]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv02]
ok: [tikv03]
ok: [tikv05]
ok: [tikv04]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb6]
ok: [tidb7]
ok: [tidb5]
ok: [tidb8]

TASK [check_config_dynamic : Preflight check - Does deploy dir have appropriate permission] ***

TASK [check_config_dynamic : environment check (supervise)] ********************

TASK [check_config_dynamic : config skip variables (default)] ******************
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb6]
ok: [tidb7]
ok: [tidb8]

TASK [check_config_dynamic : config skip variables] ****************************
ok: [tikv01]
ok: [pd1]
ok: [pd2]
ok: [pd3]
ok: [pd4]
ok: [pd5]
ok: [tikv1]
ok: [tikv2]
ok: [tikv3]
ok: [tikv4]
ok: [tikv5]
ok: [tikv6]
ok: [tikv7]
ok: [tikv8]
ok: [tikv9]
ok: [tikv02]
ok: [tikv03]
ok: [tikv04]
ok: [tikv05]
ok: [tikv06]
ok: [tikv07]
ok: [tikv08]
ok: [tikv09]
ok: [tidb1]
ok: [tidb2]
ok: [tidb3]
ok: [tidb4]
ok: [tidb5]
ok: [tidb7]
ok: [tidb6]
ok: [tidb8]

TASK [check_config_dynamic : config skip variables] ****************************

PLAY [Pre-check for rolling update] ********************************************

TASK [shell] *******************************************************************
changed: [tidb2]
changed: [tidb1]
changed: [tidb4]
changed: [tidb3]
changed: [tidb5]
changed: [tidb6]
changed: [tidb7]
changed: [tidb8]

TASK [Check whether can perform rolling update] ********************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update PD cluster] ***********************************************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv1

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1]

TASK [display pd addr] *********************************************************
ok: [tikv1] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv1] => {
    "tikv_addr": "tikv01:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv1

TASK [get store info from PD] **************************************************
ok: [tikv1]

TASK [set_fact] ****************************************************************
ok: [tikv1] => (item=7)

TASK [display store id] ********************************************************
ok: [tikv1] => {
    "store_id": 7
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv1

TASK [test0] *******************************************************************
changed: [tikv1]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv1]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv1]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv1] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv1]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv1]

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display old tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 30912"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv1] => (item=/data1/tikv_deploy/scripts)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)
ok: [tikv1] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv1] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv1] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv1] => (item=/data1/tikv_deploy/log)
ok: [tikv1] => (item=/data1/tikv_deploy/data)
ok: [tikv1] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv1

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv1]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv1]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv1] => (item={u'block_used': 19790629, u'uuid': u'6e380dc7-3be1-4757-b7fd-804a3f2988d1', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76299803, u'size_available': 312523993088, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24411535, u'device': u'/dev/nvme1n1', u'inode_used': 8817, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv1]

TASK [tikv : load default config] **********************************************
ok: [tikv1]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv1]

TASK [tikv : generate final config] ********************************************
ok: [tikv1]

TASK [tikv : debug] ************************************************************
ok: [tikv1] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv1]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv1

TASK [tikv : deploy binary] ****************************************************
ok: [tikv1]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv1] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv1

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv1]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv1] => (item=start)
ok: [tikv1] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv1]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv1]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv1]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv1]

TASK [test3] *******************************************************************
changed: [tikv1]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv1]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv1]

TASK [display new tikv pid] ****************************************************
ok: [tikv1] => {
    "msg": "tikv binary or docker pid: 9110"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv1

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv1]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv2

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2]

TASK [display pd addr] *********************************************************
ok: [tikv2] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv2] => {
    "tikv_addr": "tikv02:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv2

TASK [get store info from PD] **************************************************
ok: [tikv2]

TASK [set_fact] ****************************************************************
ok: [tikv2] => (item=1)

TASK [display store id] ********************************************************
ok: [tikv2] => {
    "store_id": 1
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv2

TASK [test0] *******************************************************************
changed: [tikv2]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv2]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv2]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv2] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv2]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv2]

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display old tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 18478"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv2] => (item=/data1/tikv_deploy/scripts)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)
ok: [tikv2] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv2] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv2] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv2] => (item=/data1/tikv_deploy/log)
ok: [tikv2] => (item=/data1/tikv_deploy/data)
ok: [tikv2] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv2

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv2]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv2]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv2] => (item={u'block_used': 19108592, u'uuid': u'2141c006-4970-4003-b995-26687bb510e6', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76981840, u'size_available': 315317616640, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413488, u'device': u'/dev/nvme1n1', u'inode_used': 6864, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv2]

TASK [tikv : load default config] **********************************************
ok: [tikv2]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv2]

TASK [tikv : generate final config] ********************************************
ok: [tikv2]

TASK [tikv : debug] ************************************************************
ok: [tikv2] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv2]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv2

TASK [tikv : deploy binary] ****************************************************
ok: [tikv2]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv2] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv2

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv2]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv2] => (item=start)
ok: [tikv2] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv2]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv2]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv2]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv2]

TASK [test3] *******************************************************************
changed: [tikv2]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv2]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv2]

TASK [display new tikv pid] ****************************************************
ok: [tikv2] => {
    "msg": "tikv binary or docker pid: 25649"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv2

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv2]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv3

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3]

TASK [display pd addr] *********************************************************
ok: [tikv3] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv3] => {
    "tikv_addr": "tikv03:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv3

TASK [get store info from PD] **************************************************
ok: [tikv3]

TASK [set_fact] ****************************************************************
ok: [tikv3] => (item=4)

TASK [display store id] ********************************************************
ok: [tikv3] => {
    "store_id": 4
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv3

TASK [test0] *******************************************************************
changed: [tikv3]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv3]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv3]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv3] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv3]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv3]

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display old tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 17849"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv3] => (item=/data1/tikv_deploy/scripts)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)
ok: [tikv3] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv3] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv3] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv3] => (item=/data1/tikv_deploy/log)
ok: [tikv3] => (item=/data1/tikv_deploy/data)
ok: [tikv3] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv3

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv3]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv3]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv3] => (item={u'block_used': 19298784, u'uuid': u'83a54ad4-9ed8-4ebd-be4b-759f27b36f9d', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76791648, u'size_available': 314538590208, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413457, u'device': u'/dev/nvme1n1', u'inode_used': 6895, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv3]

TASK [tikv : load default config] **********************************************
ok: [tikv3]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv3]

TASK [tikv : generate final config] ********************************************
ok: [tikv3]

TASK [tikv : debug] ************************************************************
ok: [tikv3] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv3]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv3

TASK [tikv : deploy binary] ****************************************************
ok: [tikv3]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv3] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv3

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv3]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv3] => (item=start)
ok: [tikv3] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv3]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv3]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv3]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv3]

TASK [test3] *******************************************************************
changed: [tikv3]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv3]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv3]

TASK [display new tikv pid] ****************************************************
ok: [tikv3] => {
    "msg": "tikv binary or docker pid: 24985"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv3

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv3]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv4

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4]

TASK [display pd addr] *********************************************************
ok: [tikv4] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv4] => {
    "tikv_addr": "tikv04:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv4

TASK [get store info from PD] **************************************************
ok: [tikv4]

TASK [set_fact] ****************************************************************
ok: [tikv4] => (item=6)

TASK [display store id] ********************************************************
ok: [tikv4] => {
    "store_id": 6
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv4

TASK [test0] *******************************************************************
changed: [tikv4]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv4]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv4]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv4] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv4]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv4]

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display old tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 25720"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv4] => (item=/data1/tikv_deploy/scripts)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)
ok: [tikv4] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv4] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv4] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv4] => (item=/data1/tikv_deploy/log)
ok: [tikv4] => (item=/data1/tikv_deploy/data)
ok: [tikv4] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv4

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv4]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv4]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv4] => (item={u'block_used': 19097463, u'uuid': u'9d5d5a68-180e-4e12-a8d1-e3f78de24cf4', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76992969, u'size_available': 315363201024, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413494, u'device': u'/dev/nvme1n1', u'inode_used': 6858, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv4]

TASK [tikv : load default config] **********************************************
ok: [tikv4]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv4]

TASK [tikv : generate final config] ********************************************
ok: [tikv4]

TASK [tikv : debug] ************************************************************
ok: [tikv4] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv4]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv4

TASK [tikv : deploy binary] ****************************************************
ok: [tikv4]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv4] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv4

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv4]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv4] => (item=start)
ok: [tikv4] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv4]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv4]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv4]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv4]

TASK [test3] *******************************************************************
changed: [tikv4]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv4]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv4]

TASK [display new tikv pid] ****************************************************
ok: [tikv4] => {
    "msg": "tikv binary or docker pid: 343"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv4

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv4]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv5

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5]

TASK [display pd addr] *********************************************************
ok: [tikv5] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv5] => {
    "tikv_addr": "tikv05:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv5

TASK [get store info from PD] **************************************************
ok: [tikv5]

TASK [set_fact] ****************************************************************
ok: [tikv5] => (item=5)

TASK [display store id] ********************************************************
ok: [tikv5] => {
    "store_id": 5
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv5

TASK [test0] *******************************************************************
changed: [tikv5]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv5]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv5]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv5] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv5]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv5]

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display old tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 13787"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv5] => (item=/data1/tikv_deploy/scripts)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)
ok: [tikv5] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv5] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv5] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv5] => (item=/data1/tikv_deploy/log)
ok: [tikv5] => (item=/data1/tikv_deploy/data)
ok: [tikv5] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv5

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv5]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv5]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv5] => (item={u'block_used': 19125106, u'uuid': u'6186f3ef-6434-4ada-ba3a-e1dffb1f4169', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76965326, u'size_available': 315249975296, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413541, u'device': u'/dev/nvme1n1', u'inode_used': 6811, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv5]

TASK [tikv : load default config] **********************************************
ok: [tikv5]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv5]

TASK [tikv : generate final config] ********************************************
ok: [tikv5]

TASK [tikv : debug] ************************************************************
ok: [tikv5] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv5]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv5

TASK [tikv : deploy binary] ****************************************************
ok: [tikv5]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv5] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv5

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv5]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv5] => (item=start)
ok: [tikv5] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv5]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv5]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv5]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv5]

TASK [test3] *******************************************************************
changed: [tikv5]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv5]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv5]

TASK [display new tikv pid] ****************************************************
ok: [tikv5] => {
    "msg": "tikv binary or docker pid: 20918"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv5

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv5]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv6

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6]

TASK [display pd addr] *********************************************************
ok: [tikv6] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv6] => {
    "tikv_addr": "tikv06:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv6

TASK [get store info from PD] **************************************************
ok: [tikv6]

TASK [set_fact] ****************************************************************
ok: [tikv6] => (item=8)

TASK [display store id] ********************************************************
ok: [tikv6] => {
    "store_id": 8
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv6

TASK [test0] *******************************************************************
changed: [tikv6]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv6]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv6]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv6] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv6]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv6]

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display old tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 18098"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv6] => (item=/data1/tikv_deploy/scripts)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)
ok: [tikv6] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv6] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv6] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv6] => (item=/data1/tikv_deploy/log)
ok: [tikv6] => (item=/data1/tikv_deploy/data)
ok: [tikv6] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv6

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv6]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv6]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv6] => (item={u'block_used': 19338038, u'uuid': u'7234184e-6b77-44ff-bcfd-88d0e3b89503', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76752394, u'size_available': 314377805824, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413459, u'device': u'/dev/nvme1n1', u'inode_used': 6893, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv6]

TASK [tikv : load default config] **********************************************
ok: [tikv6]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv6]

TASK [tikv : generate final config] ********************************************
ok: [tikv6]

TASK [tikv : debug] ************************************************************
ok: [tikv6] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv6]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv6

TASK [tikv : deploy binary] ****************************************************
ok: [tikv6]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv6] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv6

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv6]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv6] => (item=start)
ok: [tikv6] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv6]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv6]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv6]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv6]

TASK [test3] *******************************************************************
changed: [tikv6]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv6]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv6]

TASK [display new tikv pid] ****************************************************
ok: [tikv6] => {
    "msg": "tikv binary or docker pid: 25334"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv6

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv6]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv7

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7]

TASK [display pd addr] *********************************************************
ok: [tikv7] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv7] => {
    "tikv_addr": "tikv07:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv7

TASK [get store info from PD] **************************************************
ok: [tikv7]

TASK [set_fact] ****************************************************************
ok: [tikv7] => (item=48001)

TASK [display store id] ********************************************************
ok: [tikv7] => {
    "store_id": 48001
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv7

TASK [test0] *******************************************************************
changed: [tikv7]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv7]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv7]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv7] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv7]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv7]

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display old tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 23848"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv7] => (item=/data1/tikv_deploy/scripts)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)
ok: [tikv7] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv7] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv7] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv7] => (item=/data1/tikv_deploy/log)
ok: [tikv7] => (item=/data1/tikv_deploy/data)
ok: [tikv7] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv7

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv7]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv7]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv7] => (item={u'block_used': 19838966, u'uuid': u'3455a2c4-54d7-4e43-8469-aef6b82dcfcc', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76251466, u'size_available': 312326004736, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413618, u'device': u'/dev/nvme1n1', u'inode_used': 6734, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv7]

TASK [tikv : load default config] **********************************************
ok: [tikv7]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv7]

TASK [tikv : generate final config] ********************************************
ok: [tikv7]

TASK [tikv : debug] ************************************************************
ok: [tikv7] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv7]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv7

TASK [tikv : deploy binary] ****************************************************
ok: [tikv7]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv7] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv7

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv7]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv7] => (item=start)
ok: [tikv7] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv7]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv7]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv7]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv7]

TASK [test3] *******************************************************************
changed: [tikv7]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv7]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv7]

TASK [display new tikv pid] ****************************************************
ok: [tikv7] => {
    "msg": "tikv binary or docker pid: 30587"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv7

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv7]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv8

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8]

TASK [display pd addr] *********************************************************
ok: [tikv8] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv8] => {
    "tikv_addr": "tikv08:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv8

TASK [get store info from PD] **************************************************
ok: [tikv8]

TASK [set_fact] ****************************************************************
ok: [tikv8] => (item=48003)

TASK [display store id] ********************************************************
ok: [tikv8] => {
    "store_id": 48003
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv8

TASK [test0] *******************************************************************
changed: [tikv8]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv8]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv8]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv8] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv8]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv8]

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display old tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 12437"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv8] => (item=/data1/tikv_deploy/scripts)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)
ok: [tikv8] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv8] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv8] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv8] => (item=/data1/tikv_deploy/log)
ok: [tikv8] => (item=/data1/tikv_deploy/data)
ok: [tikv8] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv8

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv8]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv8]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv8] => (item={u'block_used': 20157153, u'uuid': u'202ec8e8-e079-4d78-b48c-2a7ddf13f31a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 75933279, u'size_available': 311022710784, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413622, u'device': u'/dev/nvme1n1', u'inode_used': 6730, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv8]

TASK [tikv : load default config] **********************************************
ok: [tikv8]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv8]

TASK [tikv : generate final config] ********************************************
ok: [tikv8]

TASK [tikv : debug] ************************************************************
ok: [tikv8] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv8]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv8

TASK [tikv : deploy binary] ****************************************************
ok: [tikv8]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv8] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv8

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv8]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv8] => (item=start)
ok: [tikv8] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv8]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv8]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv8]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv8]

TASK [test3] *******************************************************************
changed: [tikv8]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv8]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv8]

TASK [display new tikv pid] ****************************************************
ok: [tikv8] => {
    "msg": "tikv binary or docker pid: 22678"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv8

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv8]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update TiKV cluster] *********************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_pd_tikv_addr.yml for tikv9

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9]

TASK [display pd addr] *********************************************************
ok: [tikv9] => {
    "pd_addr": "tikv02:2379"
}

TASK [display tikv addr] *******************************************************
ok: [tikv9] => {
    "tikv_addr": "tikv09:20160"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/get_store_id.yml for tikv9

TASK [get store info from PD] **************************************************
ok: [tikv9]

TASK [set_fact] ****************************************************************
ok: [tikv9] => (item=48002)

TASK [display store id] ********************************************************
ok: [tikv9] => {
    "store_id": 48002
}

TASK [check store_id is defined] ***********************************************

TASK [include_tasks] ***********************************************************

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/add_evict_leader_scheduler.yml for tikv9

TASK [test0] *******************************************************************
changed: [tikv9]

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

TASK [add evict-leader-scheduler] **********************************************
ok: [tikv9]

TASK [add evict-leader-scheduler when enable_tls|default(false)] ***************

TASK [check tikv's leader count] ***********************************************
FAILED - RETRYING: check tikv's leader count (18 retries left).
ok: [tikv9]

TASK [check tikv's leader count when enable_tls|default(false)] ****************

TASK [display leader_count] ****************************************************
ok: [tikv9] => {
    "msg": "leader_count: 0"
}

TASK [display leader_count when enable_tls|default(false)] *********************

TASK [stop TiKV by supervise] **************************************************

TASK [stop TiKV by systemd] ****************************************************
changed: [tikv9]

TASK [wait until the TiKV port is down] ****************************************
ok: [tikv9]

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display old tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 29679"
}

TASK [common_dir : create deploy directories] **********************************
ok: [tikv9] => (item=/data1/tikv_deploy/scripts)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)
ok: [tikv9] => (item=/data1/tikv_deploy/backup)

TASK [common_dir : create status directory] ************************************
ok: [tikv9] => (item=/data1/tikv_deploy/status)

TASK [common_dir : create deploy binary directory] *****************************
ok: [tikv9] => (item=/data1/tikv_deploy/bin)

TASK [common_dir : create docker image directory] ******************************

TASK [tikv : create deploy directories] ****************************************
ok: [tikv9] => (item=/data1/tikv_deploy/log)
ok: [tikv9] => (item=/data1/tikv_deploy/data)
ok: [tikv9] => (item=/data1/tikv_deploy/conf)

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/check_filesystem.yml for tikv9

TASK [tikv : Get ansible_mounts fact] ******************************************
ok: [tikv9]

TASK [tikv : Determine which mountpoint that tikv data dir exists on] **********
ok: [tikv9]

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Check bug if filesystem is xfs] *****************

TASK [tikv : Clean check file for xfs filesystem] ******************************

TASK [tikv : set_fact] *********************************************************

TASK [tikv : Preflight check - Does tikv data dir meet ext4 file system requirement] ***

TASK [tikv : Preflight check - Set fssystem_check_result fact] *****************
ok: [tikv9] => (item={u'block_used': 19404951, u'uuid': u'6d4b9a55-fc63-4eff-a750-1a99500e7a3a', u'size_total': 393586409472, u'block_total': 96090432, u'mount': u'/data1', u'block_available': 76685481, u'size_available': 314103730176, u'fstype': u'ext4', u'inode_total': 24420352, u'inode_available': 24413560, u'device': u'/dev/nvme1n1', u'inode_used': 6792, u'block_size': 4096, u'options': u'rw,seclabel,relatime,nodelalloc,data=ordered'})

TASK [tikv : Preflight check - Does tikv data dir meet ext4 or xfs file system requirement] ***

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : include_tasks] ****************************************************

TASK [tikv : load customized config: tidb-ansible/conf/tikv.yml] ***************
ok: [tikv9]

TASK [tikv : load default config] **********************************************
ok: [tikv9]

TASK [tikv : generate dynamic config] ******************************************
ok: [tikv9]

TASK [tikv : generate final config] ********************************************
ok: [tikv9]

TASK [tikv : debug] ************************************************************
ok: [tikv9] => {
    "tikv_conf": {
        "coprocessor": {
            "region-max-keys": 1440000, 
            "region-max-size": "144MB", 
            "region-split-keys": 960000, 
            "region-split-size": "96MB"
        }, 
        "global": {}, 
        "import": {}, 
        "metric": {}, 
        "pd": {}, 
        "pessimistic-txn": {
            "enabled": false
        }, 
        "raftdb": {
            "defaultcf": {}
        }, 
        "raftstore": {
            "apply-pool-size": 3, 
            "messages-per-tick": 127, 
            "raftdb-path": "", 
            "store-pool-size": 3, 
            "sync-log": true
        }, 
        "readpool": {
            "coprocessor": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 12
            }, 
            "storage": {
                "high-concurrency": 1, 
                "low-concurrency": 1, 
                "normal-concurrency": 8
            }
        }, 
        "rocksdb": {
            "defaultcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ], 
                "titan": {}
            }, 
            "enable-statistics": true, 
            "lockcf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }, 
            "max-background-jobs": 8, 
            "max-sub-compactions": 3, 
            "titan": {}, 
            "wal-dir": "", 
            "writecf": {
                "compression-per-level": [
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd", 
                    "zstd"
                ]
            }
        }, 
        "security": {
            "ca-path": "", 
            "cert-path": "", 
            "key-path": ""
        }, 
        "server": {
            "grpc-concurrency": 3, 
            "grpc-raft-conn-num": 1, 
            "heavy-load-threshold": 100, 
            "labels": {}
        }, 
        "storage": {
            "block-cache": {
                "capacity": "20GB", 
                "shared": true
            }, 
            "scheduler-worker-pool-size": 2
        }
    }
}

TASK [tikv : create config file] ***********************************************
ok: [tikv9]

TASK [tikv : backup conf file] *************************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/binary_deployment.yml for tikv9

TASK [tikv : deploy binary] ****************************************************
ok: [tikv9]

TASK [tikv : backup binary file] ***********************************************

TASK [tikv : create run script] ************************************************
ok: [tikv9] => (item=run)

TASK [tikv : backup script file] ***********************************************

TASK [tikv : include_tasks] ****************************************************
included: /home/centos/tidb-ansible/roles/tikv/tasks/systemd_deployment.yml for tikv9

TASK [deploy systemd] **********************************************************

TASK [systemd : create systemd service configuration] **************************
ok: [tikv9]

TASK [systemd : create startup script - common start/stop] *********************
ok: [tikv9] => (item=start)
ok: [tikv9] => (item=stop)

TASK [systemd : reload systemd] ************************************************
changed: [tikv9]

TASK [tikv : prepare firewalld white list] *************************************
ok: [tikv9]

TASK [start TiKV by supervise] *************************************************

TASK [start TiKV by systemd] ***************************************************
changed: [tikv9]

TASK [wait until the TiKV port is up] ******************************************
ok: [tikv9]

TASK [test3] *******************************************************************
changed: [tikv9]

TASK [wait until the TiKV status page is available] ****************************
ok: [tikv9]

TASK [wait until the TiKV status page is available when enable_tls] ************

TASK [command] *****************************************************************
ok: [tikv9]

TASK [display new tikv pid] ****************************************************
ok: [tikv9] => {
    "msg": "tikv binary or docker pid: 4126"
}

TASK [include_tasks] ***********************************************************
included: /home/centos/tidb-ansible/common_tasks/remove_evict_leader_scheduler.yml for tikv9

TASK [remove evict-leader-scheduler] *******************************************
ok: [tikv9]

TASK [remove evict-leader-scheduler when enable_tls|default(false)] ************

PLAY [rolling update pump cluster] *********************************************
skipping: no hosts matched

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY [rolling update TiDB cluster] *********************************************

PLAY RECAP *********************************************************************
localhost                  : ok=7    changed=4    unreachable=0    failed=0   
pd1                        : ok=3    changed=0    unreachable=0    failed=0   
pd2                        : ok=3    changed=0    unreachable=0    failed=0   
pd3                        : ok=3    changed=0    unreachable=0    failed=0   
pd4                        : ok=3    changed=0    unreachable=0    failed=0   
pd5                        : ok=3    changed=0    unreachable=0    failed=0   
tidb1                      : ok=4    changed=1    unreachable=0    failed=0   
tidb2                      : ok=4    changed=1    unreachable=0    failed=0   
tidb3                      : ok=4    changed=1    unreachable=0    failed=0   
tidb4                      : ok=4    changed=1    unreachable=0    failed=0   
tidb5                      : ok=4    changed=1    unreachable=0    failed=0   
tidb6                      : ok=4    changed=1    unreachable=0    failed=0   
tidb7                      : ok=4    changed=1    unreachable=0    failed=0   
tidb8                      : ok=4    changed=1    unreachable=0    failed=0   
tikv01                     : ok=8    changed=0    unreachable=0    failed=0   
tikv02                     : ok=7    changed=0    unreachable=0    failed=0   
tikv03                     : ok=7    changed=0    unreachable=0    failed=0   
tikv04                     : ok=7    changed=0    unreachable=0    failed=0   
tikv05                     : ok=7    changed=0    unreachable=0    failed=0   
tikv06                     : ok=7    changed=0    unreachable=0    failed=0   
tikv07                     : ok=7    changed=0    unreachable=0    failed=0   
tikv08                     : ok=7    changed=0    unreachable=0    failed=0   
tikv09                     : ok=7    changed=0    unreachable=0    failed=0   
tikv1                      : ok=52   changed=5    unreachable=0    failed=0   
tikv2                      : ok=52   changed=5    unreachable=0    failed=0   
tikv3                      : ok=52   changed=5    unreachable=0    failed=0   
tikv4                      : ok=52   changed=5    unreachable=0    failed=0   
tikv5                      : ok=52   changed=5    unreachable=0    failed=0   
tikv6                      : ok=52   changed=5    unreachable=0    failed=0   
tikv7                      : ok=52   changed=5    unreachable=0    failed=0   
tikv8                      : ok=52   changed=5    unreachable=0    failed=0   
tikv9                      : ok=52   changed=5    unreachable=0    failed=0   

Congrats! All goes well. :-)
